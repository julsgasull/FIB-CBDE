<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CBDE</title><style>
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, YuMincho, "Yu Mincho", "Hiragino Mincho ProN", "Hiragino Mincho Pro", "Songti TC", "Songti SC", "SimSun", "Nanum Myeongjo", NanumMyeongjo, Batang, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }

.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }

.highlight-default {
}
.highlight-gray {
	color: rgb(155,154,151);
}
.highlight-brown {
	color: rgb(100,71,58);
}
.highlight-orange {
	color: rgb(217,115,13);
}
.highlight-yellow {
	color: rgb(223,171,1);
}
.highlight-teal {
	color: rgb(15,123,108);
}
.highlight-blue {
	color: rgb(11,110,153);
}
.highlight-purple {
	color: rgb(105,64,165);
}
.highlight-pink {
	color: rgb(173,26,114);
}
.highlight-red {
	color: rgb(224,62,62);
}
.highlight-gray_background {
	background: rgb(235,236,237);
}
.highlight-brown_background {
	background: rgb(233,229,227);
}
.highlight-orange_background {
	background: rgb(250,235,221);
}
.highlight-yellow_background {
	background: rgb(251,243,219);
}
.highlight-teal_background {
	background: rgb(221,237,234);
}
.highlight-blue_background {
	background: rgb(221,235,241);
}
.highlight-purple_background {
	background: rgb(234,228,242);
}
.highlight-pink_background {
	background: rgb(244,223,235);
}
.highlight-red_background {
	background: rgb(251,228,228);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(55, 53, 47, 0.6);
	fill: rgba(55, 53, 47, 0.6);
}
.block-color-brown {
	color: rgb(100,71,58);
	fill: rgb(100,71,58);
}
.block-color-orange {
	color: rgb(217,115,13);
	fill: rgb(217,115,13);
}
.block-color-yellow {
	color: rgb(223,171,1);
	fill: rgb(223,171,1);
}
.block-color-teal {
	color: rgb(15,123,108);
	fill: rgb(15,123,108);
}
.block-color-blue {
	color: rgb(11,110,153);
	fill: rgb(11,110,153);
}
.block-color-purple {
	color: rgb(105,64,165);
	fill: rgb(105,64,165);
}
.block-color-pink {
	color: rgb(173,26,114);
	fill: rgb(173,26,114);
}
.block-color-red {
	color: rgb(224,62,62);
	fill: rgb(224,62,62);
}
.block-color-gray_background {
	background: rgb(235,236,237);
}
.block-color-brown_background {
	background: rgb(233,229,227);
}
.block-color-orange_background {
	background: rgb(250,235,221);
}
.block-color-yellow_background {
	background: rgb(251,243,219);
}
.block-color-teal_background {
	background: rgb(221,237,234);
}
.block-color-blue_background {
	background: rgb(221,235,241);
}
.block-color-purple_background {
	background: rgb(234,228,242);
}
.block-color-pink_background {
	background: rgb(244,223,235);
}
.block-color-red_background {
	background: rgb(251,228,228);
}
.select-value-color-default { background-color: rgba(206,205,202,0.5); }
.select-value-color-gray { background-color: rgba(155,154,151, 0.4); }
.select-value-color-brown { background-color: rgba(140,46,0,0.2); }
.select-value-color-orange { background-color: rgba(245,93,0,0.2); }
.select-value-color-yellow { background-color: rgba(233,168,0,0.2); }
.select-value-color-green { background-color: rgba(0,135,107,0.2); }
.select-value-color-blue { background-color: rgba(0,120,223,0.2); }
.select-value-color-purple { background-color: rgba(103,36,222,0.2); }
.select-value-color-pink { background-color: rgba(221,0,129,0.2); }
.select-value-color-red { background-color: rgba(255,0,26,0.2); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="61c9c471-a9fb-4d89-95b8-015686bf707c" class="page sans"><header><h1 class="page-title">CBDE</h1></header><div class="page-body"><nav id="f084279c-f634-40d5-b62e-5a30c36a5d74" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ed82e525-10ee-4c38-935f-2521926b1b67">Tema 1 - Principles of Distributed Databases</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#7babdd1f-cecc-46a2-8453-59ebe9db3503">RDBMS: One Size Does Fit All</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#1f184f31-2b12-4cec-bd7e-ad31ca2eb9b4">RDBMS Approach</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#20daf60d-ad7a-4071-a41e-80fc800b4698">Distributed databases</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#41bc2974-3778-4488-8022-e6fed1e7bea3">Distributed Architectures</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#69ed363d-6ccd-44d1-a003-9d6fc28be19f">Comparison of DDBs</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a1c8ef52-165c-4cb0-a447-a0b7c48bb280">Extended ANSI-SPARC Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#7a9d198f-9509-4646-8cf3-f4efa0993027">Centralized DBMS Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#fc31b3b7-91f1-43ea-90b7-3a7420bf399a">Distributed DBMS Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f66fe53a-6e52-49f5-99d3-a63fa4f737fa">NOSQL</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#aa830517-8bba-4899-b951-696dfc8b6459">Different applications</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#518bb48c-d8be-41c1-a521-3602bdee18d6">The Problem is Not SQL</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#aa1e4364-a6bd-46fc-b1ac-a69ab3faa2ca">RDBMS Bottlenecks</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#193440e7-d045-45c9-83e7-ba4d28640d81">NewSQL: A New Architecture for OLTP</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#bf7d0ecf-1d30-4065-943b-ba0abbce2d67">Tema 2 - Distributed Databases</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#d245e921-f29d-448e-8ad0-c75f42f100a5">Objectives</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#a265b352-5600-42e8-b62b-1c69bd1a89af">Activities</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#83e91e92-9da6-4161-8900-862e090b2536">Deliverables</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#ad0b188c-ac95-4e63-b5b9-d4f98148ada9">Material: Algorithms for Fragmenting Relations</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#913c1aa8-1e89-46c0-9dea-0f967dce34dc">4.1. Data Fragmentation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#0ad11cc2-0450-4944-970a-bd4879cb9a7b">Horitzontal</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#8a8b091c-33cf-4923-b17a-84e2aea967ca">Vertical</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#c50682ff-07e6-4469-8dbf-9290addba9a0">Fragmentaci√≥ h√≠brida</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#64ca0be5-84ce-4295-b344-15967a3d0b0a">4.1.1. Horizontal Fragmentation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#475111e9-e603-49a1-a931-d484c6d78c53">4.1.2. Derived Horizontal Fragmentation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#304b94f0-cd17-4b1a-bc18-bca25c66a650">4.1.3. Vertical Fragmentation</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#ead1599b-1945-4682-b020-c3b66d2eef39">Tema 3 - Design of Distributed Databases</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#75c4afa1-0729-4be4-aad4-652ff3549404">Challenges</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f6310ad8-fc01-4417-bdec-edc5ff02f0bf">DDBs Feats Vs. NOSQL Goals</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1ba230c8-2348-4c3f-9371-9175f47544e3">NOSQL Goals</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#ad6e7dfa-98c4-4b49-b80d-6dbec0df176c">Challenges in Data Distribution</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#34ca1ae4-f303-4f27-9c01-07ab11241073">Challenge I: DDB Design</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#fb514e9c-018b-4095-a1ff-2f308d4f2566">Allocation (and replication)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#0cb612e0-1753-48cf-826d-56ab5fe75660">Decide Data Allocation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f6fc1384-bd27-4faa-86bd-8acb6bb54e73">Manage Data Replication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#e70bb3cb-8e34-4536-a494-a1484889b3c2">Catalog</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#2a205f0a-9368-4468-afbf-dfef928151dd">Challenge II: Global Catalog</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#5caac764-a2fb-4dfb-9c84-7b05b5bccb6f">Scalability</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#39f7e62a-a14d-44f0-bc01-d4d7c144827f">The Universal Scalability Law (I)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#3b06061e-a23e-4502-9fe0-0325be49e29c">The USL at Work</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f31b3ae8-3601-4d14-902b-cb5d6efb2109">Measuring Scalability</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#9837ba62-b9f0-4095-98cf-fffa2ef4d496">Tema 4 - Distributed Query Processing</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6499eeb0-07ac-4102-a301-fe4e73d16545">Instructions on the Distributed Query Processing Activity</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#48cb850c-53ae-4cbb-9a9c-9a14ae178c15"><strong>OBJECTIVES</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#215f6b28-ae12-42bf-8351-6a120745a1df"><strong>ACTIVITIES</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#982fb74f-dc40-4b63-afbc-aec4f6efbf42"><strong>DELIVERABLES</strong></a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#b03b5743-b5f2-4458-b511-2a125f6aec87">Material: Distributed Query Processing</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#4fe640c1-ba98-4846-8c73-99d63b3c8179">Basics of Query Optimization</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#575c80fd-4c84-4e85-8bc6-9cb9f31584f9">Centralized Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#717cd84e-e64d-4d63-a471-40b5d2cb21d6">‚Üí Semantic Optimization</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#d2d467b1-8a0b-4104-ac06-498c95f7abe2">‚Üí Syntactic Optimization√ß</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#5856e2e9-dab4-4e04-8ffb-e22579463dee">Tema 5 - Concurrency and Recovery</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#eaae822f-111e-4391-a39e-ffce89add1b5">Reminder: Challenges in Data Distribution</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#0466f6a3-9086-4372-bf0a-f4a1b7ade986">Basics on concurrency</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#2bb01579-1388-49a0-bcae-14ff31f7fb18">ACID properties</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#676fb169-ff51-4bec-928f-8ef624cd6d06">Trade-Off: Performance Vs. Consistency</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#202ab83f-8033-49fb-b9a4-29aabd75132b">Challenge IV: Distributed Tx management</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#ddacc0e9-b6e6-4229-b1a5-d8e5d951c7df">Time-stamping</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#373ba309-efcf-4f6c-ba0b-573fce994f59">Structures for Time-Stamping</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#695c11d4-c8db-48b2-b9f9-10c9972a330e">Time-Stamping Algorithms</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#f0cf3c2b-55a5-495b-b518-54c3817ee9c9">Enforcing Recoverability</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#bdea2412-f254-4cf9-ace4-fd7a67ab3c8d">Dynamic Time-Stamping</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#59e75253-f0af-42a2-8137-2fac6c1b9d54">Concurrency control in distributed databases</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#67f652cd-488e-45b6-86ad-1cb78aba3de0">Concurrency Control in DDBs</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#595ef0ec-7a99-4021-b95c-693140b6e8e6">Motivation: Global Serializability</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#c577d692-d784-445a-995d-ed5043320f1f">Problems in Distributed Transactions</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#9d659f99-345a-4696-8b75-184fb437fd15">Distributed Time-Stamping</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#0106e960-cfbd-4dbc-80b0-fa9235414c7c">Basics on recovery</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#892bfeb4-48e7-4acf-aa1b-128a3588ff9f">Motivation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#900aac89-7bbc-45b3-b1f7-dc5942f6ad14">DBMS Components</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1c72f49e-e097-451d-91c1-fcb38eb0ceac">The Log: Rules</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#4c77e898-8ba4-4239-938c-74a057ab2b64">Distributed recovery</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#6eaa439b-f1dd-41d7-8609-8cc85af5a29c">Distributed Recovery</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#3cd6c812-2350-4806-97e8-11efcf45c245">CAP Theorem</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#44d94dc2-6095-45ee-874e-94a8b6da9ab4">On the Need of a New Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#114ea283-35ad-47e1-aaf9-e155ff0bdb88">Strong Consistency</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#3ee7f8c7-99e0-495d-bd28-081437c2d7d0">CAP Theorem Revisited</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1b372aa0-add8-4725-b467-3970e72c6082">AP Theorem: Examples (~DIY!)</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#a1a12b57-0dbc-46cf-91e7-1d6a8ca9dcc3">Tema 6 - Column-Oriented Databases</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#87e370b4-ccc1-472a-978d-c0702f768d41">Column-Oriented Databases</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#e5ab9d0a-354f-4a24-9959-4ce406871285">Data Model: Compression</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a2b854ba-b0c1-40bf-b8ce-41c0cd3e3fb9">Data Model: Lightweight Compression</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#484f6af6-44d7-4735-886a-3234738c15c8">Data Model: Reconstructing Records</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#aad0c9ca-ea10-4e3c-a476-8b2fbef71ae4">Data Model: Create Vertical Partitioning</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#b99beaca-4b1a-49a6-965a-6c62c1319801">Example</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a88ced4f-8223-4fcd-bbb6-2cb722547793">Attribute Affinity Matrix</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#e50a71f5-3716-43f6-85fc-4593d7faab40">Data Processing: Late Materialization</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#51be534c-c0cb-409b-89c2-154eea8a3ab2">Data Processing: Block Iteration</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#35b36335-acfd-4b06-aa83-21bf28790b9d">Tema 7 - Key-Value Store</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#6f14441f-bd9f-49ef-aa4e-675c12987d91">Hadoop, bigtable and mapreduce</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#4103ae7a-7e5f-427f-a157-f3c8a8461ab6">Key-Values: A Piece of History</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#06d2eb34-2132-4ed0-8118-a71ddadad12b">Google Ecosystem</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#c15f493b-5a94-49d5-9681-ae2ed9014d01">The file system: hadoop</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#320b3ad2-a820-40e9-9489-029674b9655d">Hadoop File System (HDFS)</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#67824a30-0db3-42df-9543-ddc07ce8218b">HDFS in a Nutshell</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#c336211b-1e0a-4ffe-af95-6a91de9c8e0b">HDFS File Formats</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#f8a0e79f-591a-40c2-821e-4af0468f32a4">The database: hbase</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#3368ba28-a742-497c-9b50-c7c67ca84479">HBase</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#b418fabd-4b7c-48db-a9a7-f0e6a8cf26cc">Schema Elements</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#b576c0c9-f7a8-403f-8806-aa9be3b969f7">Just Another Point of View</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#a3c5095c-23bc-467a-ad8c-f61ad5531186">HBase Shell</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#fe2380a4-cfa8-4f82-8011-0ba2704183fe">Physical Implementation</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#e6752b9e-ebe2-4a4f-84a6-7de5f0e25dfd">Functional Components</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#20a0b22a-4f12-4d2a-8232-b788942d1212">HBase: A Distributed Index Cluster</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#2d150046-9b23-433a-b762-d98cbb868d7a">HBase Design Decisions</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#1b802772-b48b-4099-bb8a-7ab5a492c409">HBase in a Nutshell</a></div><div class="table_of_contents-item table_of_contents-indent-2"><a class="table_of_contents-link" href="#13e2e8d0-6f58-4400-8de1-41c820355ef4">HBase Architecture</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#55b0a9e5-32f7-4517-8095-37680b65fe99">Tema 8 - MapReduce</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#6a7032ea-ae84-415c-8067-25eccf142b91">Tema 9 - Document-Stores</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#93d3b341-60fb-40b0-96af-d42696af4f76">Tema 10 - Graph Databases</a></div></nav><h1 id="ed82e525-10ee-4c38-935f-2521926b1b67" class="">Tema 1 - Principles of Distributed Databases</h1><h2 id="7babdd1f-cecc-46a2-8453-59ebe9db3503" class="">RDBMS: One Size Does Fit All</h2><ul id="1305b425-768f-4606-a28a-7d43e0a8e901" class="bulleted-list"><li><strong>Mainly write-only Systems (e.g., OLTP)</strong><ul id="5b3c4dcb-c928-4b1d-89fa-abe54b3bb39f" class="bulleted-list"><li><strong>Data storage</strong><ul id="76d0d70b-cb74-49ee-b106-901d6e8ceb03" class="bulleted-list"><li>Normalization</li></ul></li></ul><ul id="fc97ca9e-d283-44d4-af4c-7d98962cd899" class="bulleted-list"><li><strong>Queries</strong><ul id="516de53e-5c33-4401-a633-ad46d5359493" class="bulleted-list"><li>Indexes: B+, Hash</li></ul><ul id="a77c2ec6-e44d-4675-996b-a2bd691ef17e" class="bulleted-list"><li>Joins: BNL, RNL, Hash-Join, Merge Join</li></ul></li></ul></li></ul><ul id="ba7bd65a-03f3-4a4c-ae68-a02a32661f6d" class="bulleted-list"><li><strong>Read-only Systems (e.g., DW)</strong><ul id="50d86845-c470-40da-993c-304bbbba61a4" class="bulleted-list"><li><strong>Data Storage</strong><ul id="ec47de88-5381-414a-8e08-52128855ef24" class="bulleted-list"><li>Denormalized data</li></ul></li></ul><ul id="b50872dc-bc93-4230-9429-2eb61a15faf8" class="bulleted-list"><li><strong>Queries</strong><ul id="8c0f9190-dbee-48ba-9d8a-de776100480a" class="bulleted-list"><li>Indexes: Bitmaps</li></ul><ul id="a1579600-4e54-47f8-bf4b-18756e484e92" class="bulleted-list"><li>Joins: Star-join</li></ul><ul id="d1a2aaf5-106b-4bdd-81f4-3c9e488e2da6" class="bulleted-list"><li>Materialized Views</li></ul></li></ul></li></ul><p id="37b8798c-500c-48f5-9417-885e57c0d665" class="">
</p><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="bb2b3f89-3b6a-47b2-9327-15cfcdbcc1d6"><div style="font-size:1.5em"><span class="icon">üòµ</span></div><div style="width:100%">But... what if we need to deal with massive reads and writes at the same time?</div></figure><h2 id="1f184f31-2b12-4cec-bd7e-ad31ca2eb9b4" class="">RDBMS Approach</h2><div id="51b1dbc0-591b-4b1f-96b1-15d20edb9c2a" class="column-list"><div id="803f7a85-e4a1-4fdc-81d0-a05f851b7da8" style="width:50%" class="column"><p id="250b2412-36c3-49a9-815e-97f86f2f5fe8" class="">Too many reads? ‚Üí data replication</p></div><div id="db08fe4d-006c-4cc4-8203-cd70b84f3aad" style="width:50%" class="column"><p id="46de2d2f-e137-49b3-b716-7695b84351fd" class="">Too many writes? ‚Üí data fragmentation</p></div></div><ul id="b1fc5c83-5fd8-4e15-b6f6-7fac44bf03c4" class="bulleted-list"><li><strong>Distributed RDBMS (DRDBMS) are not flexible enough</strong><ul id="4f6bff20-6f5f-41f5-ad11-a5d4017b45c3" class="bulleted-list"><li><strong>CID properties must be preserved when synchronizing nodes</strong></li></ul><ul id="a9795a2b-5e23-4fd9-b0ab-204fd0886c50" class="bulleted-list"><li><strong>Too much logging writes</strong></li></ul><ul id="4a8f4187-1045-4a0e-95f3-e5bab2e66731" class="bulleted-list"><li><strong>They do not scale well</strong></li></ul></li></ul><p id="aa986f0d-10ad-4260-a793-ae3f86377211" class="">
</p><h2 id="20daf60d-ad7a-4071-a41e-80fc800b4698" class="">Distributed databases</h2><p id="9045a090-a574-4768-a524-e96dde5be7c6" class="">A distributed database (DDB) is a database where data management is distributed over several nodes in a network.</p><ul id="5c630c38-a84f-4d0e-a079-19b092c6e24c" class="bulleted-list"><li>Each node is a database itself</li></ul><ul id="422a17f7-a988-427a-a062-953a473c2aba" class="bulleted-list"><li>Potential heterogeneity</li></ul><ul id="ff62b279-e39b-42bf-a1a2-e80dbdd459b4" class="bulleted-list"><li>Nodes communicate through the network</li></ul><figure id="c43fc401-2f23-408f-8b55-ac3a53e796b5" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.42.59.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.42.59.png"/></a></figure><h3 id="41bc2974-3778-4488-8022-e6fed1e7bea3" class="">Distributed Architectures</h3><ul id="3e3e00f9-e3fd-44ba-8298-9d5cf136deb1" class="bulleted-list"><li><strong>Main objective: hide implementation (i.e., physical) details to the users</strong><ul id="e8132551-9060-45ce-afe2-6336d08a1c8e" class="bulleted-list"><li><strong>Data independency at the logical and physical level must be guaranteed</strong><ul id="9bd72fbc-3cca-45e3-af06-739fe1362e40" class="bulleted-list"><li>Inherited from centralized DBs (ANSI SPARC)</li></ul></li></ul><ul id="becdeb6e-4316-409a-ab6e-683ee702da9d" class="bulleted-list"><li><strong>Network transparency</strong><ul id="422206b2-96fe-4d9f-a77d-45ffcdcb5ab7" class="bulleted-list"><li>Data access must be independent regardless where data is stored</li></ul><ul id="9824c271-9ccd-446b-9d63-ac17db478dd1" class="bulleted-list"><li>Each data object must have a unique name</li></ul></li></ul><ul id="a19feb2f-afac-4e4f-9c69-78226a4dde27" class="bulleted-list"><li><strong>Replication transparency</strong><ul id="567778a3-a268-4171-a802-1392a5b6e460" class="bulleted-list"><li>The user must not be aware of the existing replicas</li></ul></li></ul><ul id="b1a5c9fa-9bdc-44b3-bbd7-d12b6a22d83b" class="bulleted-list"><li><strong>Fragmentation transparency</strong><ul id="7410bbc3-9ae7-4ed1-80ec-acac7fa8c550" class="bulleted-list"><li>The user must not be aware of partitioning</li></ul></li></ul></li></ul><figure id="673b9d80-7d83-4768-94cd-a3177769f436" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.44.18.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.44.18.png"/></a></figure><h3 id="69ed363d-6ccd-44d1-a003-9d6fc28be19f" class="">Comparison of DDBs</h3><figure id="ecd2b4f9-2987-47fa-801e-025a2728a3fe" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.44.48.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.44.48.png"/></a></figure><h3 id="a1c8ef52-165c-4cb0-a447-a0b7c48bb280" class="">Extended ANSI-SPARC Architecture</h3><figure id="de121eae-467b-41c8-96f8-3cbb870b0522" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.45.18.png"><img style="width:624px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.45.18.png"/></a></figure><div id="8a66a7a9-28b0-4b3f-befa-006c95e2358c" class="column-list"><div id="cf2236d4-506d-4289-a08d-4ba23609228f" style="width:37.5%" class="column"><p id="1fe5331e-eb77-4aa2-8da1-bc4d5fb20fee" class="">
</p></div><div id="b5d2a64a-f693-4a6e-ad29-b7c3ba011ae2" style="width:62.5%" class="column"><ul id="f76d8bfd-c01d-45b2-a978-bf9c02854759" class="bulleted-list"><li>Global catalog</li></ul><ul id="5a86b20d-9485-4c43-a891-7046bed3cd4d" class="bulleted-list"><li>Mappings between ESs‚ÄìGCS and GCS‚ÄìLCSs</li></ul><ul id="66ed7f32-0bd6-4234-a092-201aa3937850" class="bulleted-list"><li>Each node has a local catalog</li></ul><ul id="3b92b6ef-5317-43dd-af72-a3e8d23d176f" class="bulleted-list"><li>Mappings between LCSi ‚Äì ISi</li></ul></div></div><h3 id="7a9d198f-9509-4646-8cf3-f4efa0993027" class="">Centralized DBMS Architecture</h3><figure id="75d46ec1-b624-4ec0-ad65-ca65864c8d7e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.47.20.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.47.20.png"/></a></figure><h3 id="fc31b3b7-91f1-43ea-90b7-3a7420bf399a" class="">Distributed DBMS Architecture</h3><figure id="b60fda24-0a98-469b-aba8-ea1abf8e2e98" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.47.41.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_13.47.41.png"/></a></figure><h2 id="f66fe53a-6e52-49f5-99d3-a63fa4f737fa" class="">NOSQL</h2><h3 id="aa830517-8bba-4899-b951-696dfc8b6459" class="">Different applications</h3><p id="bc1b2a22-ae11-4b27-90e1-24dfdcd48e63" class=""><strong>Not Only SQL (different problems entail different solutions)</strong></p><ul id="8cc11c4f-4b9e-46d4-8b38-8beab6d0e19f" class="bulleted-list"><li>OLTP<ul id="12c376c2-27b0-4a04-9b59-6d0fef7308a6" class="bulleted-list"><li>Object-Relational<ul id="34ee1479-ffe2-4164-bfea-55c7170605d6" class="bulleted-list"><li>Distributed databases</li></ul><ul id="04653b0b-bfdd-4494-9491-62ce72cab9e0" class="bulleted-list"><li>Parallel databases</li></ul></li></ul></li></ul><ul id="68bfa586-6941-4ad4-bbaa-edb144cf0078" class="bulleted-list"><li>Scientific databases and other Big Data repositories<ul id="113c8464-054c-4a32-adfa-93d7e7740528" class="bulleted-list"><li>Key-value stores</li></ul></li></ul><ul id="d6f82d09-1eab-4285-bbcc-f48b04183772" class="bulleted-list"><li>Data Warehousing &amp; OLAP<ul id="9fcec2bf-c7cf-42a9-a63e-44b1530fe1f0" class="bulleted-list"><li>MOLAP</li></ul><ul id="b507d65e-e193-4308-9fe7-cd3ec7817dee" class="bulleted-list"><li>Column stores</li></ul><ul id="1ca8fc7d-82fc-42db-b370-930dc296174f" class="bulleted-list"><li>Multidimensional features</li></ul></li></ul><ul id="f3f91b9a-8eac-46b2-a7b2-50621be09938" class="bulleted-list"><li>Text / documents<ul id="a7562b67-9bb7-4211-aa80-17015f2367fd" class="bulleted-list"><li>Document databases<ul id="ece90fad-8b4b-4386-ade9-ac5e3b26d95b" class="bulleted-list"><li>XML/JSON databases</li></ul></li></ul></li></ul><ul id="edcac059-69b8-4b20-b475-96451789aa47" class="bulleted-list"><li>Stream processing<ul id="4500b2f6-f671-487b-9d27-2db2481e4590" class="bulleted-list"><li>Stream processor</li></ul></li></ul><ul id="c0746246-7f7b-453b-b930-006418b82685" class="bulleted-list"><li>Semantic Web and Open Data<ul id="d4f0617a-99da-47fa-9e8b-83eba5f67ad9" class="bulleted-list"><li>Graph databases</li></ul></li></ul><h3 id="518bb48c-d8be-41c1-a521-3602bdee18d6" class="">The Problem is Not SQL</h3><ul id="f62282c0-eeef-48bb-83a9-01465f3210c6" class="bulleted-list"><li><strong>Relational systems are too generic...</strong><ul id="3b711ce1-1bb5-46a5-9513-bab27b9269b1" class="bulleted-list"><li>OLTP: stored procedures and simple queries</li></ul><ul id="b78a311c-80c1-4ee2-84b7-af4b44fe66f6" class="bulleted-list"><li>OLAP: ad-hoc complex queries</li></ul><ul id="ae5741ae-bd41-465a-b0c0-a0cf778ae68d" class="bulleted-list"><li>Documents: large objects</li></ul><ul id="30e59cb5-7d8f-4e2c-9581-c6b3f3e0329a" class="bulleted-list"><li>Streams: time windows with volatile data</li></ul><ul id="6cacf1fc-dfd9-4f2d-a137-3b7ddd4442a7" class="bulleted-list"><li>Scientific: uncertainty and heterogeneity</li></ul></li></ul><ul id="4b789667-9d7c-425a-8767-da15f7a45301" class="bulleted-list"><li><strong>... But the overhead of RDBMS has nothing to do with SQL</strong></li></ul><ul id="8556e2db-25ea-48da-869c-e2e9854a474f" class="bulleted-list"><li><strong>Low-level, record-at-a-time interface is not the solution</strong></li></ul><h3 id="aa1e4364-a6bd-46fc-b1ac-a69ab3faa2ca" class="">RDBMS Bottlenecks</h3><ul id="3b380a7e-4463-47f3-acae-2950547c3829" class="bulleted-list"><li><strong>Buffers management (cache disk pages)</strong></li></ul><ul id="0dbaefcb-1f01-4f3a-a535-eecceae9ec6c" class="bulleted-list"><li>L<strong>ogging (WALP)</strong><ul id="944603f4-e979-492d-ad0b-5012d97c32e3" class="bulleted-list"><li>Persistent redo log</li></ul><ul id="f30bfdf3-7e07-4193-a9e4-2179de939945" class="bulleted-list"><li>Undo log</li></ul></li></ul><ul id="80fefadb-cf2a-4ca7-8923-57135706b428" class="bulleted-list"><li>Concurrency control (locking)</li></ul><ul id="67f22f8b-80c4-425b-8a61-88dd6ed29a58" class="bulleted-list"><li>Latching for multi-threading</li></ul><ul id="6f8b3cfa-c953-41dd-b723-9b9b0abf1a2a" class="bulleted-list"><li>CLI interfaces (JDBC, ODBC, etc.)</li></ul><ul id="b401d5e2-542f-48d3-9b34-f8e556bd1d91" class="bulleted-list"><li><strong>Variable length records management</strong><ul id="122344ac-3e20-4a3b-85f3-e63c9662e09d" class="bulleted-list"><li>Locate records in a page</li></ul><ul id="bd133878-b555-45f7-b65d-e457d6c8afb2" class="bulleted-list"><li>Locate fields in a record</li></ul></li></ul><ul id="7247a40f-c480-41d8-ad92-a4739c5145e5" class="bulleted-list"><li><strong>Two-phase commit protocol in distributed transactions</strong></li></ul><h3 id="193440e7-d045-45c9-83e7-ba4d28640d81" class="">NewSQL: A New Architecture for OLTP</h3><p id="56c7fc01-463e-47e9-acd3-58a22cb038dc" class=""><strong>But even for distributed, massive OLTP systems RDBMS can be outperformed!</strong></p><ul id="45d68e1e-c9bd-4988-8b83-992bc0c5f87d" class="bulleted-list"><li>Main memory DB<ul id="776cdbe4-119e-47f9-9ef8-a3ca62842529" class="bulleted-list"><li>A DB less than 1Tb fits in memory<ul id="c5f4516c-26c8-4d10-a1eb-0855f1715c09" class="bulleted-list"><li>20 nodes x 32Gb (or more) costs less than 50,000US$</li></ul></li></ul><ul id="848954b1-aeb0-465a-95fe-3531f30e401c" class="bulleted-list"><li>Undo log is in-memory and discarded on commit</li></ul></li></ul><ul id="ab214c41-4cbd-4a9c-92df-b0c383b0b514" class="bulleted-list"><li>One thread systems<ul id="58fd68d2-b4ef-4ac9-9682-242fb3ca48fa" class="bulleted-list"><li>Perform in coming SQL commands to completion, without interruption<ul id="fed34930-9c73-4fa8-8642-bbd578378b65" class="bulleted-list"><li>One transaction takes less than 1ms</li></ul></li></ul><ul id="ffae8d21-150a-47d8-88c5-7d8394d2e25c" class="bulleted-list"><li>No isolation needed</li></ul></li></ul><ul id="6feb4383-5687-4d34-afe8-d3731bb0dc94" class="bulleted-list"><li>Grid computing<ul id="3b2047d7-f97f-429e-b49b-441787e4ed2e" class="bulleted-list"><li>Enjoy horizontal partition in gand parallelism<ul id="3bc1f689-ca83-4fdd-ad0c-073c59150b35" class="bulleted-list"><li>Add new nodes to the grid without going down</li></ul></li></ul></li></ul><ul id="cf7332c4-f5fb-436f-aa30-f6e41ceae51c" class="bulleted-list"><li>High availability<ul id="fce32a3c-b4cd-4328-9231-72f13c0b736a" class="bulleted-list"><li>Cannot wait for the recovery process<ul id="f0b31579-cfb8-4b88-81d9-6859f2b5bd10" class="bulleted-list"><li>Multiple machines in a PeerToPeer configuration</li></ul></li></ul></li></ul><ul id="17786943-9dfb-49b2-8f10-b1d3c1cc97e9" class="bulleted-list"><li>Reduce costs<ul id="966d9a4c-c6a4-4ca8-be09-7ddff05a1b5e" class="bulleted-list"><li>Human costs are higher than Hw and Sw<ul id="766ae643-b913-43bb-87dc-841415479dce" class="bulleted-list"><li>An expert DBA is expensive and rare</li></ul></li></ul><ul id="f3ec68c0-e861-4525-a676-f1e449e09460" class="bulleted-list"><li>Alternative is brute force<ul id="b7e35188-5c7a-4dd9-8323-02eb0c15f6cc" class="bulleted-list"><li>Automatic horizontal partition in gand replication<ul id="2991ff90-bbfd-46c1-987c-3e016b0d12a0" class="bulleted-list"><li>Execute queries at any replica and updates to all of them</li></ul></li></ul></li></ul></li></ul><ul id="dec74e68-c2b8-42e4-bd2a-eaddd933e9e9" class="bulleted-list"><li>Optimize queries at compile time</li></ul><p id="7f321d56-4898-405c-986a-3cb08b47a5d4" class="">
</p><hr id="ff3cc6ff-3c18-4a79-89d1-097ca26fde85"/><h1 id="bf7d0ecf-1d30-4065-943b-ba0abbce2d67" class="">Tema 2 - Distributed Databases</h1><p id="981cd4aa-b9e8-49f2-b02b-dc71adc63854" class="">Instructions: horizontal and vertical fragmentation</p><h3 id="d245e921-f29d-448e-8ad0-c75f42f100a5" class="">Objectives</h3><p id="b1ac1094-fa80-4977-92d9-e1ccc3cd2460" class="">Learn about data fragmentation, its purposes and the three main kinds of fragmentation. Namely:</p><ul id="d56682d5-3382-40a1-8cb0-54e905f5e59e" class="bulleted-list"><li>Horizontal,</li></ul><ul id="b685b6bf-0b24-4cdb-9942-5e59dce2d770" class="bulleted-list"><li>Vertical,</li></ul><ul id="b3847814-f2e6-4ee4-a1b0-8a263305b5d4" class="bulleted-list"><li>Derived.</li></ul><h2 id="a265b352-5600-42e8-b62b-1c69bd1a89af" class="">Activities</h2><p id="c57fee78-0f02-4499-bac4-445da281fd8b" class="">During the week, read and understand the following parts of the ‚ÄúAlgorithms for Fragmenting Relations and the Oracle 11g Syntax‚Äù document (attached to this activity):</p><ul id="8fcee0f6-92ce-44ec-859b-95e234e14053" class="bulleted-list"><li>What data fragmentation is in pages 32 to 35 (Section 4.1)</li></ul><ul id="62b4cac2-3ad9-4876-b3b7-c069351ccf06" class="bulleted-list"><li>The horizontal fragmentation strategy presented in pages 36 to 38 (Section 4.1.1)</li></ul><ul id="6c3f34d0-0866-4b30-939d-710b91642cfb" class="bulleted-list"><li>The derived fragmentation strategy presented in page 39 (Section 4.1.2)</li></ul><ul id="db7af4a0-eeef-4176-95ec-1d0934e96439" class="bulleted-list"><li>The vertical fragmentation strategy in pages 41 and 42 (Section 4.1.3)</li></ul><h2 id="83e91e92-9da6-4161-8900-862e090b2536" class="">Deliverables</h2><ul id="73acc947-ddf6-4a98-91db-8e69624f1068" class="bulleted-list"><li>In the ‚ÄúDesign of Distributed Databases‚Äù lecture you will solve a short exercise during the first 10 mins. of the lecture. This exercise will have weight 1 and will be assessed for the course final mark.</li></ul><ul id="fea7c17d-5686-4383-9cc7-f2fa0174d56f" class="bulleted-list"><li>Prior to this exercise, you will be allowed to ask for questions or doubts.</li></ul><h3 id="ad0b188c-ac95-4e63-b5b9-d4f98148ada9" class="">Material: Algorithms for Fragmenting Relations</h3><p id="0348dcad-61b2-4843-857d-df26668cf195" class="">En aquesta secci√≥ ens centrem en el disseny de bases de dades distribu√Ødes des de zero (√©s a dir, un disseny de top-down). Per tant, tenint en compte una base de dades i la seva c√†rrega de treball, analitzem com assignar dades a diferents llocs de manera que optimitzem un determinat conjunt de par√†metres (normalment, minimitzant el consum de recursos per al processament de consultes). Per fer-ho, s‚Äôhan d‚Äôabordar dues q√ºestions principals: com fragmentar les dades i on assignar-les. Les dues q√ºestions estan fortament interrelacionades.</p><h3 id="913c1aa8-1e89-46c0-9dea-0f967dce34dc" class="">4.1. Data Fragmentation</h3><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="7d4f358f-b089-4552-b1ec-38dd0bb11599"><div style="font-size:1.5em"><span class="icon">üó£</span></div><div style="width:100%"><strong>Fragmentation Vs. Replication

</strong>√âs important distingir clarament entre la <mark class="highlight-red">fragmentaci√≥</mark> de relacions i la <mark class="highlight-red">replicaci√≥</mark> de fragments. Tot i que el primer pas es refereix al problema de trobar la unitat de treball adequada per al sistema distribu√Øt, el segon es refereix al problema d‚Äôassignaci√≥ i s‚Äôabordar√† m√©s endavant.</div></figure><p id="0d157a31-a492-44d0-8e27-5b1b28e55ac1" class="">
</p><p id="76abdc18-e8e1-489a-addc-10857d73c6f2" class="">La fragmentaci√≥ de dades tracta el problema de trencar les relacions en trossos m√©s petits i, per tant, de disminuir la unitat de treball del sistema distribu√Øt. Hi ha moltes raons per fragmentar-se, per√≤ la idea principal √©s que una relaci√≥ no √©s una bona unitat de processament.</p><p id="03b8a44d-47ce-4ee2-9294-6fe60c39b1fa" class="">Per exemple, considerem el cas d&#x27;un usuari que accedeix a una base de dades mitjan√ßant una vista definida com a selecci√≥ sobre una relaci√≥ R. Certament, aquest usuari mai no accedir√† a cap inst√†ncia de dades d&#x27;aquest subconjunt. En general, les aplicacions i els usuaris nom√©s accediran a un subconjunt de les relacions disponibles a la base de dades o, m√©s concretament, a un determinat subconjunt d&#x27;algunes relacions.</p><p id="ac2bbb47-36b8-4ff3-bd0c-94307b5a1ef4" class="">Sense tenir en compte la fragmentaci√≥ de les dades, tenim dues opcions: situar la relaci√≥ en un sol node (i, per tant, augmentar els accessos remots i produir un coll d&#x27;ampolla potencial) o b√© replicar-la a tots els nodes en qu√® pot ser necess√†ria la relaci√≥. </p><p id="cb1bab2e-bedf-4bfc-987b-5d9f10786b9c" class="">Tanmateix, es necessiten diferents subconjunts en diferents nodes i t√© total sentit, des del punt de vista del rendiment, col¬∑locar aquells fragments susceptibles d&#x27;utilitzar-se conjuntament. Recordeu, aix√≤ √©s el que es coneix com a <em>localitat de dades. </em>Com a resultat, la sobrec√†rrega de la comunicaci√≥ a trav√©s de la xarxa es minimitza i evitem la reproducci√≥ innecess√†ria.</p><p id="26168466-4d54-4c8a-bbd3-0180bd3efd97" class="">
</p><p id="2aea24a7-4bfb-4c21-b03c-41d38426f99b" class="block-color-purple_background">Running example<div class="indented"><p id="69ec918b-6797-4798-9036-41d11d1e0d2e" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>e</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>o</mi><mi>y</mi><mi>e</mi><mi>e</mi><mo stretchy="false">(</mo><mi>i</mi><mi>d</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo><mi>c</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>b</mi><mi>i</mi><mi>r</mi><mi>t</mi><mi>h</mi><mi>D</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mi>a</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">employee(id, name, certificate, birthDate, nationality)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">h</span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span></p><p id="2a838f9c-cfbf-40a8-9db0-cba1ae4ea804" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo><mi>c</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>y</mi><mo separator="true">,</mo><mi>b</mi><mi>u</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo separator="true">,</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>g</mi><mi>o</mi><mi>r</mi><mi>y</mi><mo separator="true">,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">project(pno, name, city, country, budget, category, productivityRatio, income)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span></p><p id="66c97b30-0b6c-422c-93b9-a6204bfc6041" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>a</mi><mi>l</mi><mi>a</mi><mi>r</mi><mi>y</mi><mo stretchy="false">(</mo><mi>c</mi><mi>e</mi><mi>r</mi><mi>t</mi><mi>i</mi><mi>f</mi><mi>i</mi><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo separator="true">,</mo><mi>a</mi><mi>m</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">salary(certificate, amount)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">i</span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span></p><p id="f9205e7e-8f08-4e5a-b9cc-ae99f1c5e199" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>g</mi><mi>n</mi><mi>e</mi><mi>d</mi><mo stretchy="false">(</mo><mi>e</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>o</mi><mi>y</mi><mi>e</mi><mi>e</mi><mi>I</mi><mi>d</mi><mo separator="true">,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>N</mi><mi>o</mi><mo separator="true">,</mo><mi>p</mi><mi>o</mi><mi>s</mi><mi>i</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo separator="true">,</mo><mi>d</mi><mi>u</mi><mi>r</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">assigned(employeeId, projectNo, position, duration)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">n</span><span class="mord mathdefault">e</span><span class="mord mathdefault">d</span><span class="mopen">(</span><span class="mord mathdefault">e</span><span class="mord mathdefault">m</span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault">e</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.07847em;">I</span><span class="mord mathdefault">d</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault">o</span><span class="mord mathdefault">s</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">d</span><span class="mord mathdefault">u</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span></p></div></p><p id="e85748a5-4cb2-4420-a049-9de2b5d734a6" class="">
</p><figure id="5d60cf51-243e-4a63-961a-d0e7cadff5f6" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_07.25.37.png"><img style="width:336px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_07.25.37.png"/></a></figure><p id="67b365bb-e588-461b-857c-31b3990fd066" class="">Considereu el nostre exemple en execuci√≥. Si volem aprofitar la localitat de les dades, ens interessar√† fragmentar les dades i col¬∑locar-les al node corresponent. Com s&#x27;ha comentat anteriorment, la nostra organitzaci√≥ d&#x27;exemple es distribueix geogr√†ficament i nom√©s ens interessa mantenir dades sobre <strong>projectes i empleats</strong> al node corresponent (ja sigui Hong Kong, Barcelona, Portland, Frankfurt o Glasgow, vegeu la figura 1). </p><p id="359d403a-0258-469a-842b-6f382c981a17" class="">Aix√≠, de tots els projectes, el node de Barcelona emmagatzemar√† els projectes realitzats en aquesta ciutat (o millor dit, coordinats des d‚Äôaquesta ciutat), aix√≠ com les assignacions i els empleats que treballen en aquests projectes. El mateix passar√† amb cadascun dels altres nodes. En aquest cas, la relaci√≥ del projecte s&#x27;hauria de fragmentar segons l&#x27;atribut de ciutat i segons el seu valor, situant la tupla en un node o un altre. </p><p id="26dc2981-06ce-475d-9a9d-01975531a90e" class="">Quant a les relacions amb els empleats i les assignades, tingueu en compte que la fragmentaci√≥ s&#x27;ha de realitzar d&#x27;una manera lleugerament diferent. Cada empleat i tupla assignada es col¬∑locaran amb la seva tupla de projecte corresponent (per tant, primer haur√≠em de fragmentar la relaci√≥ del projecte).</p><p id="6750cf5d-e8ee-48b3-b683-b37dc5adc240" class="">Tot i que beneficiar-se de la localitat de dades ha estat el motiu tradicional de la fragmentaci√≥, tamb√© ha aparegut un altre avantatge. </p><ul id="e646ed5f-1e8a-4fdc-bca0-835d4118d374" class="bulleted-list"><li>Descomposar una relaci√≥ en fragments permet executar simult√†niament diferents transaccions i tamb√© augmenta el rendiment del sistema. </li></ul><p id="2284c054-91c0-4497-8af4-ba166af6bb27" class="">√âs important destacar que quan es col¬∑loquen fragments en diferents nodes, tots dos aspectes faciliten el paral¬∑lelisme, que avui s‚Äôha convertit en l‚Äôenfocament principal per tractar bases de dades molt grans.</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="e8ad370e-784a-4f9c-9a67-b951b7702a72"><div style="font-size:1.5em"><span class="icon">üó£</span></div><div style="width:100%"><strong>Fragmentation Vs. Partitioning
</strong>
El particionament es refereix a una relaci√≥ que es divideix en petits trossos per√≤ que no es distribueix per una xarxa. Normalment, es fa per aprofitar el paral¬∑lelisme i √©s t√≠pic de sistemes paral¬∑lels, per√≤ tamb√© es pot utilitzar per implementar la privadesa.</div></figure><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="593304d3-5040-4342-bec1-06f444a3861a"><div style="font-size:1.5em"><span class="icon">üìí</span></div><div style="width:100%"><strong>Note
</strong>
La minimitzaci√≥ de les combinacions distribu√Ødes √©s un aspecte crucial per al processament de consultes distribu√Ødes.</div></figure><p id="851a8d1e-86d3-4c3f-8db9-1cb2d06de493" class="">
</p><p id="8700ee5d-9c93-4c01-af0a-e4af9e94df53" class="">Malgrat tot, la fragmentaci√≥ tamb√© comporta certes <strong>dificultats</strong>. </p><ul id="690a6375-ad74-4d6e-983b-ffe91f8c446b" class="bulleted-list"><li>D‚Äôuna banda, fragmentar una relaci√≥ pot comportar un rendiment inferior quan s‚Äôha de recuperar i manipular diversos fragments en el moment de la consulta. <ul id="e48c8fc3-54e7-4903-a735-bebf0877e504" class="bulleted-list"><li>Aquesta situaci√≥ pot passar quan hi ha requisits contradictoris que fan impossible la separaci√≥ de fragments m√∫tuament excloents. </li></ul></li></ul><ul id="b30d5d89-c7bb-492c-957a-57f7fa610fcf" class="bulleted-list"><li>D&#x27;altra banda, la comprovaci√≥ de la integritat pot resultar costosa si dos atributs amb una depend√®ncia es divideixen en fragments (fins i tot en alguns casos senzills, depenent d&#x27;on s&#x27;assignin els fragments). </li></ul><ul id="2ef63e68-e4b8-4371-8225-fb6852a1b824" class="bulleted-list"><li>Per exemple, <ul id="3c56cede-4b0b-4b9a-9145-ba2bee5ce4d7" class="bulleted-list"><li>suposem que en el nostre exemple actual, la seu de l&#x27;organitzaci√≥ es troba a Hong Kong. </li></ul><ul id="95f475a4-c470-45aa-9d3b-b92c5a04c665" class="bulleted-list"><li>Des d‚Äôaquesta ubicaci√≥, haurien de recuperar peri√≤dicament dades sobre tots els empleats. Segons la nostra discussi√≥ anterior, els empleats es distribueixen en tots els nodes segons el projecte en qu√® treballin actualment. </li></ul><ul id="a2f79703-16f7-4cb9-85e4-e389e2bb767c" class="bulleted-list"><li>Penseu en la seg√ºent consulta:<em> identifiqueu els empleats que han estat treballant en almenys tres ciutats diferents</em>. </li></ul><ul id="b9b46c70-f5ff-450b-bf4a-09ffa28393c3" class="bulleted-list"><li>Hem de recuperar tots els fragments dels <code>empleats</code>, <code>assignats</code> i del <code>projecte</code> en un node (suposem que les dades s‚Äôenvien al node que emet la consulta; √©s a dir, Hong Kong), despr√©s reconstruir les relacions originals i unir-les correctament per respondre a aquesta consulta. </li></ul><ul id="14f77da0-1334-4b77-9231-aec18b718c42" class="bulleted-list"><li>Per a aquest cas, la <strong>fragmentaci√≥ √©s clarament un inconvenient</strong>; afecta el temps de resposta de la consulta, ja que incorrem en costos de comunicaci√≥ entre nodes. </li></ul><ul id="d84c5f53-f4ab-46cc-8cee-10911f2a300f" class="bulleted-list"><li>Sembla que la <strong>comprovaci√≥ de la integritat</strong> tamb√© es pot complicar. </li></ul><ul id="64d1061d-9f45-45f2-9f5f-727460310c4f" class="bulleted-list"><li>Penseu en un empleat que ha viscut a Barcelona i Glasgow. Actualment, treballa al projecte <code>pB</code> a <code>Barcelona</code>, per√≤ estava inscrit al projecte <code>pG</code> quan treballava a <code>Glasgow</code>. </li></ul><ul id="314af05c-1b40-4ca6-989c-d2892d851511" class="bulleted-list"><li>Alguna cosa tan com√∫ com comprovar la relaci√≥ de clau estrangera entre l‚Äôassignat i l‚Äôempleat es fa m√©s dif√≠cil, perqu√® les dades sobre l‚Äôempleat e es troben ara a <code>Barcelona</code>, mentre que l‚Äôassignaci√≥ tuple e, <code>pG</code> es troba a <code>Glasgow</code>. </li></ul><ul id="6d3471d7-40ef-4d2a-a291-e3427fd40ec8" class="bulleted-list"><li>Una vegada m√©s, hem d&#x27;inc√≥rrer en despeses de comunicaci√≥ entre nodes per comprovar aquestes limitacions.</li></ul></li></ul><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="040c5431-92fe-4cf7-8d0f-33ad5e7ade48"><div style="font-size:1.5em"><span class="icon">üó£</span></div><div style="width:100%"><strong>FRAGMENTACI√ì</strong>

Tradicionalment, la<strong> fragmentaci√≥ de dades</strong> ha estat √∫til per reflectir:
- el fet que les aplicacions i els usuaris nom√©s podrien estar interessats a accedir a diferents subconjunts de tot l&#x27;esquema o fins i tot a diferents subconjunts de la mateixa relaci√≥. 
- m√©s recentment, tamb√© s&#x27;ha utilitzat per tractar grans bases de dades, ja que la fragmentaci√≥ augmenta el grau de simultane√Øtat i facilita el paral¬∑lelisme. 

Com a aspecte negatiu, tamb√© pot augmentar les combinacions distribu√Ødes i dificultar el control de dades sem√†ntiques.</div></figure><p id="de00b2ef-2c27-4535-9a02-f4928c565262" class="">Fragmentar una taula √©s tan senzill com trobar alternatives per descompondre-la en taules m√©s petites. √âs evident que tenim dos enfocaments principals: </p><ul id="e7f0e7b6-a3f5-4535-b7e4-8b67ee7bfb53" class="bulleted-list"><li>la fragmentaci√≥ horitzontal </li></ul><ul id="6ef05ad9-3edd-4fde-b2d6-c297e81b7aef" class="bulleted-list"><li>la fragmentaci√≥ vertical</li></ul><h3 id="0ad11cc2-0450-4944-970a-bd4879cb9a7b" class="">Horitzontal</h3><p id="d981ae09-01c2-4320-a31a-53936ff8e606" class="">En el primer cas, s&#x27;utilitza un <strong>predicat</strong> de selecci√≥ per crear fragments diferents i, d&#x27;acord amb un valor d&#x27;atribut, col¬∑locar cada tupla al fragment corresponent. </p><p id="511f7c8c-6d3e-4d15-8ad1-25e4edb10e21" class="">Per exemple, la fragmentaci√≥ del <code>projecte</code> proposada al nostre exemple corrent s&#x27;adapta a aquesta categoria. All√†, els predicats que s‚Äôutilitzarien serien <code>city = NAME_CITY</code> (on <code>NAME_CITY</code> √©s cadascun dels valors dels atributs de la <code>city</code>: Barcelona, Hong Kong, Portland, Glasgow o Frankfurt). </p><p id="ca6840fb-73c8-45ca-a7b7-5ad757460b31" class=""><strong>Cada predicat donar√† lloc a un fragment.</strong></p><h3 id="8a8b091c-33cf-4923-b17a-84e2aea967ca" class="">Vertical</h3><p id="39ae410d-0613-410f-beae-e5b7ff7ce28e" class="">Per contra, en cas de fragmentaci√≥ vertical, es duen a terme diferents <strong>projeccions de la relaci√≥</strong>, cadascuna formant un fragment diferent. </p><p id="be3d6dc0-840b-49a3-91ba-116376a3f601" class="">Per exemple, considerem una vegada m√©s la relaci√≥ del <code>projecte</code>. Suposem ara que volem emmagatzemar els atributs de <code>nom</code>, <code>ciutat</code> i <code>pa√≠s</code> a cada node, mentre que la resta de dades s‚Äôemmagatzemaran a la seu central de Hong Kong. </p><p id="3841748e-e5a3-4e0e-b85a-325bab45c19c" class="">En aquest cas, es podria dur a terme una fragmentaci√≥ vertical de la relaci√≥ de la manera seg√ºent:</p><p id="d7c9db6a-28fd-4e87-af7c-e8b464c6cb2e" class="">
</p><p id="abfae63a-acda-407b-8b93-1c283ec865c9" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àè</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo><mi>c</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">‚àèproject(pno,name,city,country)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">‚àè</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span> </p><p id="7dd935c3-53ba-430a-98f6-c488ace1aa2a" class="">and</p><p id="a3f8a113-9aae-4d96-b660-7b205360e79d" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àè</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>b</mi><mi>u</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo separator="true">,</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>g</mi><mi>o</mi><mi>r</mi><mi>y</mi><mo separator="true">,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">‚àèproject(pno,budget,category,productivityRatio,income).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">‚àè</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span><span>Ôªø</span></span></p><p id="931cea5d-c46d-416f-bbe9-c7582e4b3592" class="">
</p><p id="ef23a25b-8dba-4be8-9e07-bc350e7aad12" class="">La necessitat de col¬∑locar la clau prim√†ria a cada fragment vertical es justificar√† adequadament m√©s endavant. Tingueu en compte que diferents requisits poden conduir a diferents estrat√®gies de fragmentaci√≥ sobre la mateixa taula.</p><p id="c250f1ef-6c28-4de3-9bea-44c6673c7f22" class="">
</p><h3 id="c50682ff-07e6-4469-8dbf-9290addba9a0" class="">Fragmentaci√≥ h√≠brida</h3><p id="444c2f4a-bade-44e9-b3b0-0719e8278fde" class="">Com √©s habitual, una tercera alternativa combina ambdues opcions i es coneix com a fragmentaci√≥ h√≠brida. La fragmentaci√≥ h√≠brida no √©s res m√©s que l&#x27;estrat√®gia de <strong>fragmentaci√≥ horitzontal i vertical.</strong> En altres paraules, altres fragments fragmentaris produ√Øts per una estrat√®gia de fragmentaci√≥ pr√®via. </p><p id="45f8eb3c-af4a-4e87-b5a8-40cd9fa7ece8" class="">Per exemple, penseu en una combinaci√≥ dels dos requisits discutits anteriorment: volem distribuir geogr√†ficament dades sobre projectes, per√≤ nom√©s aquells atributs d&#x27;inter√®s a cada node (els altres s&#x27;emmagatzemaran a Hong Kong tal com s&#x27;ha comentat anteriorment).</p><p id="c5dbfe1e-f31b-489e-bd6f-995210592ab5" class="">Per tant, podr√≠em realitzar una fragmentaci√≥ vertical, √©s a dir, </p><ul id="da56a2df-3d5f-4931-ab5c-58da85acbb15" class="bulleted-list"><li>VF1 (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àè</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo separator="true">,</mo><mi>c</mi><mi>i</mi><mi>t</mi><mi>y</mi><mo separator="true">,</mo><mi>c</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi><mi>r</mi><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">‚àèproject(pno,name,city,country)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">‚àè</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">n</span><span class="mord mathdefault">a</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">u</span><span class="mord mathdefault">n</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span>) i </li></ul><ul id="7c4582f1-4289-4f0a-bf42-64e075c258f7" class="bulleted-list"><li>VF2 (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚àè</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>j</mi><mi>e</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo><mi>p</mi><mi>n</mi><mi>o</mi><mo separator="true">,</mo><mi>b</mi><mi>u</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>t</mi><mo separator="true">,</mo><mi>c</mi><mi>a</mi><mi>t</mi><mi>e</mi><mi>g</mi><mi>o</mi><mi>r</mi><mi>y</mi><mo separator="true">,</mo><mi>p</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>u</mi><mi>c</mi><mi>t</mi><mi>i</mi><mi>v</mi><mi>i</mi><mi>t</mi><mi>y</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>i</mi><mi>o</mi><mo separator="true">,</mo><mi>i</mi><mi>n</mi><mi>c</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo stretchy="false">)</mo><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">‚àèproject(pno,budget,category,productivityRatio,income).</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">‚àè</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mord mathdefault">e</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">p</span><span class="mord mathdefault">n</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mord mathdefault">u</span><span class="mord mathdefault">d</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">e</span><span class="mord mathdefault">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">c</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">d</span><span class="mord mathdefault">u</span><span class="mord mathdefault">c</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">i</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">i</span><span class="mord mathdefault">o</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mord mathdefault">n</span><span class="mord mathdefault">c</span><span class="mord mathdefault">o</span><span class="mord mathdefault">m</span><span class="mord mathdefault">e</span><span class="mclose">)</span><span class="mord">.</span></span></span></span></span><span>Ôªø</span></span>)</li></ul><p id="31eed06f-19c2-451d-aa51-70683a1c8b83" class="">VF2 es col¬∑locar√† al node de Hong Kong, mentre que VF1 es fragmentar√† m√©s aplicant la fragmentaci√≥ horitzontal comentada anteriorment (√©s a dir, <code>city = NOM_CITAT</code>). Com a resultat, es produiran cinc fragments, cadascun d&#x27;ells es col¬∑locar√† al node corresponent.</p><p id="112b18e0-6e4f-466e-9faf-61aa08022373" class="">
</p><p id="04894ff7-4604-4b49-8585-5e93f607f6de" class="">
</p><p id="84c3f411-b7bd-469b-a2a5-eb052830750f" class="">En aquest document, les subseccions seg√ºents se centren en la <strong>fragmentaci√≥ horitzontal i vertical </strong>i discuteixen dos aspectes principals: </p><ul id="1fea90aa-1e90-442c-8020-2df27325bff9" class="bulleted-list"><li>el <strong>grau de fragmentaci√≥ </strong>que podem assolir <ul id="e90a9f43-dd3a-427f-83bf-86965aaadd99" class="bulleted-list"><li>El primer aspecte considera fins a quin punt √©s desitjable la fragmentaci√≥ d&#x27;una relaci√≥ (√©s a dir, quants subconjunts volem produir);</li></ul></li></ul><ul id="f1170f54-9a91-4287-8648-6a034fbfcdcc" class="bulleted-list"><li>les<strong> regles de fragmentaci√≥ </strong>per a la correcci√≥. <ul id="befc7d8b-aa64-47b3-9b2e-c410ec9c166a" class="bulleted-list"><li>el segon aspecte busca assegurar la correcci√≥ sem√†ntica dels fragments. </li></ul><ul id="fc35bb1b-8699-437f-bf39-5041722cab99" class="bulleted-list"><li>Aix√≤ √∫ltim s‚Äôaconsegueix mitjan√ßant tres propietats:<ul id="ab6c4239-e572-44c0-a25a-5ab0f83c99f7" class="bulleted-list"><li>Completeness (integritat)<ul id="d0c44c41-c9cb-4b3b-800e-85c273670935" class="bulleted-list"><li>Donada la relaci√≥ <code>R</code> i un conjunt de fragments, qualsevol element de dades (ja sigui una tupla o un conjunt d‚Äôatributs) de <code>R</code> es pot trobar en almenys un fragment. </li></ul><ul id="2262b069-b6a6-4d79-9984-cf6054c4c48d" class="bulleted-list"><li>Per tant, les dades no es perden quan es fragmenten.</li></ul></li></ul><ul id="6759cc2c-18c7-472f-9cde-78cfed9301a8" class="bulleted-list"><li>Disjointness<ul id="bd972dd3-f3fa-4b2d-91b4-d4f82bd9d19b" class="bulleted-list"><li>Donada una relaci√≥ <code>R</code> i un conjunt de fragments, qualsevol element de dades col¬∑locat en un fragment no es pot trobar en cap dels altres fragments. </li></ul><ul id="5c23b353-8899-4c12-91bb-f61253845093" class="bulleted-list"><li>Recordeu que la replicaci√≥ de dades s&#x27;ha de considerar a posteriori, en l&#x27;etapa d&#x27;assignaci√≥, com una tasca independent de la fragmentaci√≥ de les dades.</li></ul></li></ul><ul id="091594b8-4385-43bc-bfb2-17adb57bed5b" class="bulleted-list"><li>Reconstruction<ul id="8137fe21-a837-483f-9f83-b9e1cea886b8" class="bulleted-list"><li>Donada una relaci√≥ <code>R</code> i un conjunt de fragments, la relaci√≥ original sempre es pot reconstruir a partir dels fragments mitjan√ßant operadors d‚Äô√†lgebra relacional.</li></ul></li></ul></li></ul></li></ul><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="1f079a3a-d2b6-426e-9104-ac7933706283"><div style="font-size:1.5em"><span class="icon">‚úÖ</span></div><div style="width:100%">Una fragmentaci√≥ √©s correcta si podem garantir la integritat, la reconstrucci√≥ i la disjuntura.</div></figure><p id="08fb4577-5006-40be-add3-2f8970fae05e" class="">La fragmentaci√≥ h√≠brida no es discuteix m√©s, perqu√® correspon a una combinaci√≥ imbricada de les dues estrat√®gies i, per tant, √©s correcta si totes les estrat√®gies de fragmentaci√≥ posteriors aplicades s√≥n correctes.</p><h3 id="64ca0be5-84ce-4295-b344-15967a3d0b0a" class="">4.1.1. Horizontal Fragmentation</h3><p id="9a7feaa0-9faf-43ec-8e73-c0e0ba1fb85d" class="">La fragmentaci√≥ horitzontal divideix una relaci√≥ al llarg de les seves tuples. La forma de definir cada fragment √©s mitjan√ßant predicats (√©s a dir, seleccions sobre qualsevol atribut de relaci√≥).
La taula seg√ºent il¬∑lustra una fragmentaci√≥ horitzontal per a la relaci√≥ del <code>projecte</code> en el nostre exemple. Aqu√≠, cada fragment cont√© un subconjunt de les tuples de la relaci√≥.</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="a968bd73-60c3-4ac4-bb5b-0e0cd2d14d50"><div style="font-size:1.5em"><span class="icon">üìù</span></div><div style="width:100%">La fragmentaci√≥ horitzontal tamb√© es coneix com a fragmentaci√≥ horitzontal prim√†ria.</div></figure><figure id="ec218b30-c30d-40a2-b1e0-82b4603c186e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_08.00.10.png"><img style="width:1704px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_08.00.10.png"/></a></figure><p id="38323e88-3134-44bf-bc46-3e52ed98853f" class="">Formalment, una relaci√≥ R es fragmenta horitzontalment en n fragments mitjan√ßant un predicat de fragmentaci√≥ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>œÉ</mi><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R_i= œÉF_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">œÉ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>i</mi><mo>‚â§</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1‚â§i‚â§n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span><span>Ôªø</span></span> on <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">F_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> √©s el predicat de fragmentaci√≥ que defineix el fragment <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>. </p><p id="a73af86f-b4f6-4bb2-a821-c6bcf92f155c" class="">Normalment, representem cada fragment pel predicat utilitzat per crear-lo. En el nostre exemple: </p><ul id="5d959bad-2191-49a7-8252-110f669f549f" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>F</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">HF_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>: city = Barcelona,</li></ul><ul id="05500d2f-da41-48e2-80b1-50b70be0f2ff" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>F</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">HF_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>: city = Hong Kong,</li></ul><ul id="dd1ff8be-6fe5-4a95-acf3-a1043fce9a22" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>F</mi><mn>3</mn></msub></mrow><annotation encoding="application/x-tex">HF_3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>: city = Portland, </li></ul><ul id="5bab586e-ffd3-462c-b322-0b7afb58cabe" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>F</mi><mn>4</mn></msub></mrow><annotation encoding="application/x-tex">HF_4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">4</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>: city = Frankfurt,</li></ul><ul id="8da722ba-daa3-4f60-a61c-997de3835aaa" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><msub><mi>F</mi><mn>5</mn></msub></mrow><annotation encoding="application/x-tex">HF_5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">5</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>: city = Glasgow.</li></ul><p id="32e7c0ee-d201-476e-aea1-53dbe82dbaef" class="">
</p><p id="3e521168-a137-455e-b8d1-69cfd20bd470" class="">El primer problema a tractar √©s quan un DBA hauria de fragmentar horitzontalment una relaci√≥ determinada.</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="bdb4a239-8fae-4093-a8d4-7f1885e13e34"><div style="font-size:1.5em"><span class="icon">üìù</span></div><div style="width:100%">La contenci√≥ es produeix quan se‚Äôns nega l‚Äôacc√©s a un recurs de base de dades a causa de conflictes amb altres usuaris, normalment relacionats amb t√®cniques de control de simultane√Øtat.</div></figure><p id="678f1a5d-efa1-464b-9276-9e4e84a4a9a8" class="">En general, un sistema distribu√Øt es beneficia de la fragmentaci√≥ horitzontal quan necessita reflectir dades distribu√Ødes geogr√†ficament (cada node accedeix principalment a dades relacionades amb ell mateix),</p><ul id="0c649a21-e3d4-453d-9576-6c6dd0b6b91d" class="bulleted-list"><li>per facilitar la recuperaci√≥ i el paral¬∑lelisme, </li></ul><ul id="053192bc-5263-46cd-a7bc-5f8a8e2f2cb2" class="bulleted-list"><li>per reduir la profunditat dels √≠ndexs (ja que cada fragment t√© el seu propi √≠ndex, el nombre d‚Äô√≠ndexs augmenta per√≤ la seva mida es redueix) </li></ul><ul id="2632a54d-f9ef-417d-bb79-d9c055f11b11" class="bulleted-list"><li>per reduir la contenci√≥.</li></ul><p id="19e7bf93-e5c7-4386-af84-babd7b6e7092" class="">En el nostre exemple, cada fragment √©s √≤bviament m√©s petit que tota la relaci√≥ (sempre que sabem que hi ha almenys una tupla a cada node).</p><p id="28b7b47e-e9c0-4492-821b-15f13c105110" class="">Aix√≠, un √≠ndex sobre la clau prim√†ria (<code>pno</code>) donaria lloc a cinc √≠ndexs diferents (un per fragment), de mida menor (ja que cada √≠ndex nom√©s contindr√† entrades per a les tuples d‚Äôaquest fragment). </p><p id="1b0d4f1e-aecc-47e6-a79e-e5687c0fbac9" class="">La contenci√≥ es redueix clarament, ja que diversos usuaris m√∫tuament excloents, que treballen en nodes diferents, poden accedir a diferents fragments simult√†niament i no es produiran conflictes. </p><p id="9f0a46c8-f1a6-4f2b-8cba-a4d30dedc104" class="">A m√©s, les consultes sobre tota la relaci√≥ es poden resoldre mitjan√ßant paral¬∑lelisme.</p><p id="2e92b710-6bfc-4886-bf86-be4bdaf878d7" class="">
</p><p id="bb8bf162-f32a-4f16-b412-fb46d9a3a448" class="">A continuaci√≥, hem de decidir fins a quin punt hem de fragmentar. </p><ul id="2c257d9a-d046-44e1-949f-8dab99439381" class="bulleted-list"><li>Tingueu en compte que la fragmentaci√≥ pot anar d&#x27;un extrem (<strong>cap</strong> fragmentaci√≥ en absolut) a l&#x27;altre (situant <strong>cada tupla en un node diferent</strong>). </li></ul><ul id="79cac1c4-7c7a-4ce1-a0f9-eefe5b820f77" class="bulleted-list"><li>A m√©s, hem de saber quins predicats (sobre quins atributs) s√≥n d‚Äôinter√®s a la nostra base de dades. <ul id="ba1d2fd5-076e-45ba-973f-4e8ffd2ed953" class="bulleted-list"><li>Per solucionar aquest problema, haur√≠em de comprovar quins predicats fan servir els usuaris (o aplicacions) que accedeixen a la base de dades. </li></ul><ul id="5d8d6080-69d3-46b6-be5d-adbcaf35dff2" class="bulleted-list"><li>Una regla general afirma que el 20% dels usuaris m√©s actius produeix el 80% del total dels accessos a la base de dades. </li></ul><ul id="1dcfc2f3-978e-46c0-80df-6b8514ac4e13" class="bulleted-list"><li>Per tant, ens haur√≠em de centrar en aquests usuaris per determinar quins predicats hem de tenir en compte a la nostra an√†lisi. </li></ul><ul id="6d958465-4be6-49cb-b65b-84b5d2c63a00" class="bulleted-list"><li>Per a cadascun d‚Äôaquests predicats, hem de realitzar els passos seg√ºents:<ol id="9c21115d-9bbe-4933-a386-036da6b0eb08" class="numbered-list" start="1"><li>Reunir totes les cl√†usules simples utilitzades en qualsevol predicat de consulta relacionat amb una relaci√≥ determinada. <p id="2df5fab7-04ae-4b2c-882d-7cb0524ae5a5" class="">A partir d‚Äôaqu√≠ suposem que un predicat √©s una expressi√≥ de la forma <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>t</mi><mi>t</mi><mi>r</mi><mtext> ò</mtext><mi>k</mi></mrow><annotation encoding="application/x-tex">attr  ò k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">t</span><span class="mord mathdefault">t</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord"> ò</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span></span><span>Ôªø</span></span> </p><p id="1e211dd3-2013-40e8-84d2-93d62d5817aa" class="">(on <code>attr</code> √©s un atribut de relaci√≥, √©s un dels seg√ºents operadors <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo mathvariant="normal">‚â†</mo><mo separator="true">,</mo><mo>‚â§</mo><mo separator="true">,</mo><mo>‚â•</mo><mo separator="true">,</mo><mo>&lt;</mo><mo separator="true">,</mo><mo>&gt;</mo><mo separator="true">,</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">‚â†, ‚â§, ‚â•, &lt;,&gt;, =</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel">ÓÄ†</span></span><span class="fix"></span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span></span><span class="base"><span class="strut" style="height:0.8304100000000001em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â•</span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.7335400000000001em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span></span><span class="base"><span class="strut" style="height:0.56131em;vertical-align:-0.19444em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span></span></span><span>Ôªø</span></span> i <code>k</code> √©s un valor en el domini d&#x27;<code>attr</code>).</p></li></ol><ol id="4f82a18b-e894-433e-9a04-40c57aa68f53" class="numbered-list" start="2"><li>Per a cada conjunt de cl√†usules simples sobre el mateix atribut, completeu (d&#x27;acord amb la sem√†ntica de l&#x27;operador de cl√†usules) afegint les cl√†usules <em>complement√†ries</em> que falten (√©s a dir, tots els valors de domini d&#x27;aquest atribut s&#x27;han de considerar com a m√≠nim en un predicat).</li></ol><ol id="4713191d-bcdd-41e4-b36c-f467a9816536" class="numbered-list" start="3"><li>Per a cada conjunt de cl√†usules simples generades al pas anterior, determineu els conjunts de cl√†usules <strong>rellevants</strong>. <p id="9393285e-43a5-40b5-84c9-ab221cf18f39" class="">Podem aplicar diferents criteris per trobar conjunts rellevants. <div class="indented"><p id="51736bce-061b-4ca2-8437-a5d20a12cbfe" class="">Un enfocament t√≠pic consideraria un conjunt rellevant si cada cl√†usula d‚Äôaquest conjunt produeix un fragment al qual un usuari o una aplicaci√≥ accedeix. Dit d‚Äôuna altra manera, si t√© sentit utilitzar les cl√†usules d‚Äôaquest conjunt per fragmentar la relaci√≥.</p></div></p></li></ol><ol id="c1c8a9b5-6d2d-4152-8dde-3ceb150e6ab4" class="numbered-list" start="4"><li>Per a totes les cl√†usules restants del pas anterior, tingueu en compte totes les combinacions entre cl√†usules sobre la mateixa relaci√≥ i poseu-les en forma normal conjuntiva.</li></ol><ol id="3e984249-4b6e-4eff-a1d2-5118f8efc065" class="numbered-list" start="5"><li>A partir dels resultats del pas anterior, esborreu aquells predicats complexos que sem√†nticament no tenen sentit. <p id="d2dc0435-d285-4aea-aa39-5ea9efb08a35" class="">Aqu√≠ es poden utilitzar regles basades en el raonament en l√≤gica de primer ordre per detectar predicats contradictoris.</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="fb87f011-3785-4702-bdd9-4e59fe237193"><div style="font-size:1.5em"><span class="icon">üìù</span></div><div style="width:100%"><strong>Nota 

</strong>Una f√≤rmula en forma conjuntiva normal √©s una conjunci√≥ de cl√†usules, en qu√® una cl√†usula √©s una disjunci√≥ de literals.</div></figure></li></ol><ol id="311d045c-bafc-435e-a37d-67b25ffcfee0" class="numbered-list" start="6"><li>Entre els predicats restants, seleccioneu els predicats de fragmentaci√≥. <p id="0df04565-ced5-4e53-a20c-811413953184" class="">Finalment, el dissenyador podria decidir afinar el resultat obtingut.</p></li></ol><p id="a1ca53f3-c01d-4837-99d5-3a2b1cf6c966" class="">
</p><h3 id="af22e020-348f-4bf5-a270-a75acf76c411" class="">Exemple</h3><p id="43529917-9e0c-4910-bfc3-e932a43a0cd4" class="">Per exemple, considerem de nou la relaci√≥ del projecte, que encara no s&#x27;ha fragmentat. I tingueu en compte les seg√ºents consultes realitzades pel 20% dels usuaris m√©s actius:</p><pre id="9f8b5ac0-7d24-44aa-bd89-f24afb6a3b90" class="code"><code>Q1: SELECT * FROM project WHERE city = ‚ÄòBarcelona‚Äô
Q2: SELECT * FROM project WHERE city = ‚ÄòGlasgow‚Äô AND budget &gt; 10000
Q3: SELECT * FROM project WHERE city = ‚ÄòFrankfurt‚Äô</code></pre><p id="5296f6fd-f8c3-4228-8fb5-5a4c813cab84" class="">Ara, apliquem l&#x27;algorisme anterior pas a pas:</p><h3 id="baf48b36-0c73-4afd-b51b-10f5dbf88e06" class="">‚Üí Pas 1 </h3><p id="a7567731-c2e0-451b-95cf-e9e86158046d" class="">Primer, reunim totes les cl√†usules emeses en qualsevol d&#x27;aquestes consultes. Aix√≠, obtenim: <code>city = &#x27;Barcelona‚Äô</code> , <code>city = &#x27;Glasgow&#x27;</code>, <code>city = &#x27;Frankfurt&#x27;</code> i <code>budget &gt; 10000</code>.</p><h3 id="98ebe91b-5f87-4d72-a9f5-735f0fd025a5" class="">‚Üí Pas 2</h3><p id="11b827e6-59bd-4e9f-b795-f086671e2829" class="">Hi ha dos atributs implicats en aquestes cl√†usules: <code>city</code> i <code>budget</code>. </p><p id="76535eef-53a2-450a-bbb7-d0d83fd54d05" class="">Sabem que els valors del domini de la <code>city</code> s√≥n {<code>Barcelona</code>, <code>Hong Kong</code>, <code>Frankfurt</code>, <code>Glasgow</code> i <code>Portland</code>}, i el valor de <code>budget</code> oscil¬∑la entre <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2000</mn></mrow><annotation encoding="application/x-tex">2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span><span>Ôªø</span></span> i <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>450000</mn></mrow><annotation encoding="application/x-tex">450000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span><span class="mord">5</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span></span><span>Ôªø</span></span>. </p><p id="ffc75ee7-6d22-4790-a31a-91214a95cd7e" class="">Segons la sem√†ntica de cada operador, complementem els predicats que falten de la seg√ºent manera:</p><ul id="010a7c5f-3bdb-4070-8216-3b45243f6072" class="bulleted-list"><li>Per a les igualtats, hem d‚Äôafegir un predicat per a cada valor del domini. <p id="ed692e1c-9a77-482f-b11a-d7424fa43f51" class="">Per tant, per a l‚Äôatribut <code>city</code>, hem d‚Äôafegir <code>city = ‚ÄòPortland</code>‚Äô i <code>city = ‚ÄòHong Kong‚Äô</code>.</p></li></ul><ul id="f7a9c450-c2cb-40de-9401-6bcad4a9cfa4" class="bulleted-list"><li>Per als intervals, hem de completar l&#x27;interval. <p id="aad19e86-2237-40ce-ac53-2d52739f2c65" class="">En el cas de l&#x27;atribut <code>budget</code>, hem d&#x27;afegir <code>budget &lt;= 10000</code>.</p></li></ul><h3 id="2b8dc588-7a71-4dd1-b6b4-6f04dc3ad316" class="">‚Üí Pas 3</h3><p id="88242d46-0485-42c1-b847-85ea78bfe91b" class="">Ara hem de saber si cada predicat √©s rellevant per a almenys un node. </p><p id="df284450-d65a-413d-bdc2-2ad89122e741" class="">La nostra organitzaci√≥ est√† distribu√Øda geogr√†ficament, de manera que tots els predicats sobre l&#x27;atribut de <code>city</code> s√≥n rellevants. </p><p id="3d25d85a-d7d1-4ecf-a04d-05251d813c41" class="">Quant a l&#x27;atribut pressupostari, sabem que el <code>budget &gt; 10000</code> √©s rellevant a <code>Glasgow</code>, per√≤ suposem que <code>budget &lt;= 10000</code> no resulta interessant per a cap dels altres nodes. </p><p id="3d26d7fe-6ab0-4175-a821-66409334a384" class="">Per tant, la majoria de nodes no es beneficiaran d&#x27;aquesta fragmentaci√≥ i, en conseq√º√®ncia, es descarten tots dos predicats sobre el <code>budget</code>.</p><h3 id="5f5fc5fb-5a27-42bb-890b-9f37f1da79e7" class="">‚Üí Pas 4</h3><p id="69499a48-fbcc-4a8c-8b07-e8c4a2edc99d" class="">Per a la resta de predicats, generem totes les combinacions. </p><p id="cacb0f68-8aa0-4aa6-8700-b125685f7ea2" class="">Tanmateix, nom√©s es mantenen predicats sobre l&#x27;atribut de <code>city</code> i no t√© sentit combinar-los, ja que s&#x27;exclouen m√∫tuament (tingueu en compte que √©s impossible que una tupla tingui dos valors diferents per al mateix atribut). </p><p id="7d4a5ce9-053e-49b0-bbbd-7fa94ff5235d" class="">Com a exemple de com combinar-los, suposem que alguns altres nodes estaven interessats en el predicat <code>budget &lt;= 10000</code> i, per tant, els predicats de <code>budget</code> estarien presents en aquest pas. <div class="indented"><p id="c30fcb72-0b6b-4ec4-b615-29f0c6c35b3a" class="">Per combinar-los, tingueu en compte que la mateixa combinaci√≥ no hauria de contenir dos predicats complementaris, de manera que nom√©s haur√≠eu de combinar predicats sobre atributs diferents (√©s a dir, <code>city</code> i <code>budget</code>). </p><p id="1900f107-90c2-40cc-adae-69ea03b29834" class="">Com a resultat, obtindr√≠em deu predicats: per a cada ciutat generarem dos predicats</p><ul id="6b72d20f-4ed6-4bd5-afed-381df63f18b7" class="bulleted-list"><li>un per a <code>budget &gt; 10000 </code></li></ul><ul id="467a4072-18fc-4a06-90ee-75269eab89d5" class="bulleted-list"><li>i un altre per a <code>budget ‚â§ 10000</code>. </li></ul><p id="e351d24e-2db7-4082-9255-83acb8a7b09b" class="">Per exemple, <code>city = ‚ÄòBarcelona‚Äô AND budget &gt; 10000</code>, <code>city = ‚ÄòBarcelona‚Äô AND budget &lt;= 10000</code>, i de manera similar per a la resta de ciutats.</p></div></p><h3 id="ebbf7acc-97cd-4bbe-8afa-f498a386f651" class="">‚Üí Pas 5</h3><p id="49b28ab0-62f3-471d-b0cb-b35b584a338a" class="">Dels predicats complexos generats anteriorment, descarteu-ne els que no tinguin sentit (des del punt de vista sem√†ntic). </p><p id="0ce3f9f3-088a-45b8-81ac-f9386a7d94a7" class="">Aix√≤ pot passar per contradiccions evidents (per exemple, <code>city=&#x27;Barcelona&#x27; AND country=&#x27;USA&#x27;</code>) o per regles internes de negoci. </p><p id="9c7fb86e-0fae-45f3-8cb9-2b15396cee5d" class="">Per a aquest √∫ltim, suposem que <code>Glasgow</code> nom√©s executa projectes financers (√©s a dir, tots els projectes de Glasgow compleixen la <code>category = &quot;financial&quot;</code>). Per tant, si <code>city=‚ÄòGlasgow‚Äô AND category = &quot;administration&quot;</code> s&#x27;havia generat, podr√≠em en aquest moment.</p><h3 id="216ec8c1-f77a-4d01-8ed5-885bcf0b9cea" class="">‚Üí Pas 6</h3><p id="b5627ae2-79cb-42c1-9454-13172580f001" class="">En aquest exemple conclour√≠em que una fragmentaci√≥ com la representada a la taula √©s la m√©s adequada.</p><p id="8d2f13bd-3472-46e8-92fe-91ce534218f3" class="">
</p></li></ul><p id="7eaadd10-d147-4d85-beb5-312e2552d69b" class="">Un cop identificats els predicats de fragmentaci√≥ (mitjan√ßant l‚Äôalgorisme anterior o una altra alternativa) hem de garantir la seva correcci√≥. Donat un conjunt de predicats de fragmentaci√≥, una fragmentaci√≥ horitzontal √©s correcta si compleix les tres propietats presentades a la secci√≥ anterior. Concretament:</p><ul id="e32923a8-1e78-4356-bf77-320c0ed3689a" class="bulleted-list"><li>Completeness:<ul id="5e2ec7ce-27c0-4ae7-8ef8-9d5ad5d45d0b" class="bulleted-list"><li>Els predicats de fragmentaci√≥ han de garantir que cada tupla estigui assignada a almenys un fragment. </li></ul><ul id="c9ee5c16-b82a-4454-b6a9-fe750ec95199" class="bulleted-list"><li>Mentre els predicats de fragmentaci√≥ siguin complets, tamb√© es garanteix que la fragmentaci√≥ final ser√† completa.</li></ul></li></ul><ul id="a2437117-b1ab-4043-8bf7-6eab94a9bb97" class="bulleted-list"><li>Disjointness:<ul id="9489e129-4cb3-48e9-acdd-cfe001ee8c7e" class="bulleted-list"><li>Els predicats de fragmentaci√≥ han de ser m√∫tuament excloents. </li></ul><ul id="0fd136f3-03c9-4aa5-95ca-c0cd9e6e8fe1" class="bulleted-list"><li>Dit d‚Äôuna altra manera, s‚Äôha de col¬∑locar una tupla en un fragment com a m√†xim.</li></ul><ul id="8714c07d-01ab-49e8-9389-a47f6e161713" class="bulleted-list"><li>Normalment, aix√≤ es coneix com a <em>minimality property for horizontal fragments</em>.</li></ul></li></ul><ul id="ad30efe8-c2f7-4a42-b820-004d96e510ca" class="bulleted-list"><li>Reconstruction: <ul id="0b0043cc-e2a5-47ec-83b2-ccf554dd62a5" class="bulleted-list"><li>La uni√≥ de tots els fragments ha de constituir la relaci√≥ original. </li></ul><ul id="6aa2b479-d561-4557-98a2-2e0d815d7cc4" class="bulleted-list"><li>Aix√≠, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><mo>‚à™</mo><msub><mi>R</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R=‚à™R_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord">‚à™</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>, on <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>i</mi><mo>‚â§</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1‚â§i‚â§n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span><span>Ôªø</span></span></li></ul></li></ul><p id="3fc5a6fe-b968-4245-bdc6-769b90825df1" class="">
</p><p id="412cc760-7d65-4ba2-a521-f712d7525342" class="">Per exemple, l&#x27;estrat√®gia de fragmentaci√≥ proposada a la taula compleix tot aix√≤: </p><ul id="ca2cb22f-4ed0-4474-8570-b109c416f686" class="bulleted-list"><li>els predicats de fragmentaci√≥ s√≥n complets (ja que hem considerat tots els valors de l&#x27;atribut de la ciutat), </li></ul><ul id="b60ac1c5-7db1-4380-a212-7d78ec322583" class="bulleted-list"><li>disjunts (en ser una igualtat, sabem que un atribut no pot tenir dos valors) </li></ul><ul id="6864123c-17cc-4a88-b095-f4e324f26b57" class="bulleted-list"><li>i es pot reconstruir mitjan√ßant l‚Äôoperador uni√≥.</li></ul></li></ul><h3 id="475111e9-e603-49a1-a931-d484c6d78c53" class="">4.1.2. Derived Horizontal Fragmentation</h3><p id="35147127-2cba-410d-9411-0da7a0121607" class="">La fragmentaci√≥ horitzontal comentada anteriorment (tamb√© coneguda com a fragmentaci√≥ horitzontal prim√†ria) nom√©s t√© en compte una relaci√≥ a la vegada.  Tanmateix, qualsevol relaci√≥ est√† relacionada amb altres relacions i sembla que podem utilitzar aquestes relacions intensivament quan consultem un esquema de base de dades.<div class="indented"><p id="41a52073-5e1c-4ea2-ae36-12b7286b72a2" class="">Per exemple, suposem que una relaci√≥ <code>R</code> est√† relacionada amb una relaci√≥ <code>S</code> mitjan√ßant una relaci√≥ de molts a un que no accepta valors <code>NULL</code> en l&#x27;extrem <code>S</code> (implementat com a clau estrangera - restricci√≥ de clau prim√†ria). </p><ul id="ef059f91-5095-4eb1-8571-cc0ff1c3b50b" class="bulleted-list"><li>Suposem ara que una transacci√≥ del sistema ben coneguda i freq√ºent, sempre que inseriu dades a <code>R</code>, consisteix a inserir primer la tupla corresponent a <code>S</code>. </li></ul><ul id="a498aaa1-4c48-47a2-9e3d-b50261d6c444" class="bulleted-list"><li>A m√©s, suposem ara que aquestes relacions solen consultar-se juntes mitjan√ßant la relaci√≥ clau principal - clau estrangera . </li></ul><ul id="ada316e3-5cba-42d2-9b65-524b3569d23a" class="bulleted-list"><li>At√®s que la fragmentaci√≥ horitzontal intenta maximitzar la localitat de les dades, sembla bastant clar que les dues relacions s√≥n candidates a situar-se al mateix node.</li></ul></div></p><p id="fcee0d55-1a47-41c6-9ce3-948620efda12" class="">Per aplicar aquesta estrat√®gia haur√≠em d‚Äôidentificar una <em>owner and a member relation</em>. Aquests noms de rol s√≥n simplement una q√ºesti√≥ de notaci√≥ (intenten ressaltar el fet que un <code>member</code> √©s una caracter√≠stica o una caracter√≠stica d‚Äôun objecte i, per tant, en dep√®n d‚Äôalguna manera), per√≤ s√≥n significatius perqu√® l&#x27;<code>owner</code> decideix com fragmentar el <code>member</code>.<div class="indented"><p id="72bc6c31-5357-496a-8838-167ab5e479e7" class="">Per exemple, ja hem comentat que seria interessant fragmentar les relacions <code>assigned</code> i les dels <code>employee</code> segons el <code>project</code>. </p><ul id="3acd1849-f980-4796-96e0-e7b71903781f" class="bulleted-list"><li>En aquest cas, el <code>project</code> ser√† el <code>owner</code> i <code>assigned</code> seria el <code>member</code>, i ens unir√≠em a ells mitjan√ßant la relaci√≥ <code>pno (clau prim√†ria) - projecteNo (clau estrangera)</code>.</li></ul><ul id="34083d64-6005-45f1-b2c3-e5a30286017d" class="bulleted-list"><li>De la mateixa manera, <code>assigned</code> seria el <code>owner</code> de <code>employee</code> quan el fragmentaria, unint-los mitjan√ßant la relaci√≥ <code>id (clau principal) - employee (clau estrangera)</code>.</li></ul></div></p><p id="000f711b-7e3c-4bd3-8e45-d385489a2a3b" class="">Com a regla general, la fragmentaci√≥ horitzontal derivada √©s d‚Äôinter√®s quan cal combinar els fragments de <code>owner</code> amb fragments de <code>member</code> mitjan√ßant claus d‚Äôuni√≥ coincidents, √©s a dir, quan la relaci√≥ de <code>member</code> dep√®n clarament de la relaci√≥ de <code>owner</code>, segons les consultes de la base de dades . </p><p id="601df8dc-fbb2-456f-b777-03a8888e838e" class="">Si √©s aix√≠, procedim de la seg√ºent manera. </p><ul id="b46a3fd5-982e-4322-94f0-efca555897dc" class="bulleted-list"><li>Suposem que la relaci√≥ <code>owner</code> ja est√† fragmentada en <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span><span>Ôªø</span></span> fragments (<style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>) i volem fragmentar la relaci√≥ membre <code>R</code> respecte a la relaci√≥ <code>owner</code>, mitjan√ßant una relaci√≥ <code>r</code>. </li></ul><ul id="4fcd4c9f-0c4a-4586-9a20-0b0f4d4b6434" class="bulleted-list"><li>La fragmentaci√≥ horitzontal derivada √©s definida: <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><mi>R</mi><mo>‚ãâ</mo><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">R_i = R‚ãâS_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.765em;vertical-align:-0.08167em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin amsrm">‚ãâ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>i</mi><mo>‚â§</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">1‚â§i‚â§n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.79549em;vertical-align:-0.13597em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span></span><span>Ôªø</span></span>. <ul id="55fb6834-dc18-4103-add5-bfcf275cbf11" class="bulleted-list"><li>Recordeu que ‚ãâ significa semi-join i, per tant, el resultat d‚Äôaquesta uni√≥ seran les tuples de <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span><span>Ôªø</span></span> per a les quals hi ha almenys una tupla en <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">S_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> amb clau d‚Äôuni√≥ coincident (considerem que els atributs d‚Äôuni√≥ s√≥n els atributs de <code>R</code> i <code>S</code> en <code>r</code>).</li></ul></li></ul><p id="9df8a122-4aa1-44d1-8e58-f5c79f6a80fa" class="">Tingueu en compte que les relacions <code>owner</code> i <code>member</code> poden estar relacionades mitjan√ßant dues o m√©s relacions. <div class="indented"><p id="ae64cb88-6462-441f-804d-eb244e09ccb3" class="">En aquest cas, haur√≠em d‚Äôaplicar els seg√ºents criteris per decidir entre les relacions disponibles:</p><ul id="def3f292-f987-488f-8368-a1baec0693d0" class="bulleted-list"><li>La fragmentaci√≥ m√©s utilitzada pels usuaris / aplicacions (√©s a dir, quin subconjunt √©s m√©s proper al que fan servir els usuaris i les aplicacions),</li></ul><ul id="42608ae8-23af-4754-b093-bf8f5b4440a6" class="bulleted-list"><li>La fragmentaci√≥ que maximitza l&#x27;execuci√≥ paral¬∑lela de les consultes.</li></ul><p id="8a59c010-a7fb-43f0-b95f-709e05a7622e" class="">Per exemple, en el primer cas podr√≠em considerar la freq√º√®ncia de les consultes, mentre que el processament de la consulta distribu√Øda i el paral¬∑lelisme es podrien considerar en el segon cas.</p></div></p><p id="5141a9f9-bcee-4970-8af0-eb7bf1224ae3" class="">Finalment, per tal de considerar una fragmentaci√≥ horitzontal derivada com a completa i disjunta, s&#x27;han de considerar dues restriccions addicionals respecte a les que es discuteixen per a la fragmentaci√≥ horitzontal:</p><ul id="2df68841-7f6c-454d-a282-05763c066bcf" class="bulleted-list"><li>Completeness.<ul id="f1a18bab-1472-468c-a19c-98f6cde48eed" class="bulleted-list"><li>la relaci√≥ que s‚Äôutilitza per a unir les dues relacions ha de fer complir la restricci√≥ d‚Äôintegritat referencial.</li></ul></li></ul><ul id="119af6e5-c602-426b-b686-4611b21d65d4" class="bulleted-list"><li>Disjointness: <ul id="4b135c56-9016-4b36-8c12-60943fabd7f7" class="bulleted-list"><li>l‚Äôatribut join ha de ser la clau de <code>owner</code>.</li></ul></li></ul><p id="a8cf33ba-f6d7-4ab2-97cf-cc97c58a706d" class="">
</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="2fae3e1b-352b-4424-aeec-46883b66dd29"><div style="font-size:1.5em"><span class="icon">üìù</span></div><div style="width:100%">Tant la fragmentaci√≥ horitzontal prim√†ria com les estrat√®gies de fragmentaci√≥ horitzontal derivades tenen com a objectiu maximitzar la localitat de les dades. 
No obstant aix√≤, el primer considera cada relaci√≥ per se, mentre que el segon tamb√© considera les relacions entre relacions.</div></figure><h3 id="304b94f0-cd17-4b1a-bc18-bca25c66a650" class="">4.1.3. Vertical Fragmentation</h3><figure id="9abbfb71-ea97-4fdf-ade7-ad68a4f1ed8a" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.17.07.png"><img style="width:1194px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.17.07.png"/></a></figure><p id="b36afb60-fd89-4d68-8b36-5a8ca52ce394" class="">La fragmentaci√≥ vertical particiona la taula en subconjunts m√©s petits projectant alguns atributs de la relaci√≥ en cada fragment. Penseu en la taula que il¬∑lustra una fragmentaci√≥ vertical per a la relaci√≥ del projecte en el nostre exemple en curs. </p><p id="f1ca2afe-0632-45fe-9652-44c2a97ef066" class="">Cada fragment cont√© un subconjunt dels atributs de relaci√≥, per√≤ observeu que tots contenen la clau principal. Aix√≤ es justificar√† m√©s endavant en aquesta secci√≥.</p><p id="f829f5c2-7edf-47e5-b3b6-399e8716433b" class="">Formalment, una relaci√≥ R es fragmenta verticalment en n fragments mitjan√ßant projeccions:<div class="indented"><p id="d7c8f8c8-28d2-4a46-9dfe-8c82ec461545" class=""><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mi>i</mi></msub><mo>=</mo><msub><mi>œÄ</mi><mi>R</mi></msub><mo stretchy="false">(</mo><mi>P</mi><mi>K</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>j</mi></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>A</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">R_i=œÄ_R(PK, A_j, ..., A_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">œÄ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.00773em;">R</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚â§</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">1 ‚â§ j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.78041em;vertical-align:-0.13597em;"></span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span></span><span>Ôªø</span></span>, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>‚â§</mo><mi>m</mi></mrow><annotation encoding="application/x-tex">k ‚â§ m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83041em;vertical-align:-0.13597em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">‚â§</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></span><span>Ôªø</span></span>. </p><p id="963c421d-7abc-4032-8ac8-87efbaea1463" class="">on:</p><ul id="0fd7846b-2877-43b8-a9b6-e1373a5e98bb" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span></span></span></span></span><span>Ôªø</span></span> √©s el nombre d‚Äôatributs de <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span><span>Ôªø</span></span> </li></ul><ul id="b0264017-bd50-4374-a693-8cb9a95df368" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">PK</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span></span><span>Ôªø</span></span> √©s la clau principal de <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi></mrow><annotation encoding="application/x-tex">R</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span></span></span></span></span><span>Ôªø</span></span></li></ul></div></p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="c5ee9cb5-6414-493c-b96f-af632e3c0053"><div style="font-size:1.5em"><span class="icon">üó£</span></div><div style="width:100%"><strong>Column-oriented databases
</strong>
La partici√≥ vertical es porta a l&#x27;extrem en sistemes de gesti√≥ de bases de dades orientats a columnes, que emmagatzemen dades per columna en lloc de per fila. Aquests sistemes han demostrat ser extremadament √∫tils per donar suport a sistemes de decisi√≥.</div></figure><p id="76d38864-4bef-45d8-8ead-d96fb54aff68" class="">
</p><p id="e5c9f6a1-979c-4c99-81a9-3bdeae526cde" class="">Com en l&#x27;estrat√®gia de fragmentaci√≥ horitzontal, el primer tema √©s determinar si una fragmentaci√≥ vertical s&#x27;adapta a les nostres necessitats. <div class="indented"><p id="d9a0ad7f-3cd1-4163-a119-77bee27480b6" class="">La fragmentaci√≥ vertical no s‚Äôha passat tradicionalment a la pr√†ctica, ja que sovint empitjorava les insercions i actualitzava els temps dels sistemes transaccionals (durant anys, la soluci√≥ a qualsevol problema d‚Äôemmagatzematge de dades). </p><p id="c311f967-2df3-47bc-acda-0461602700b5" class="">Tanmateix, amb l&#x27;arribada de sistemes basats en consultes, com ara sistemes de decisi√≥ (on l&#x27;usuari nom√©s pot consultar dades), aquest tipus de fragmentaci√≥ va sorgir com una alternativa poderosa per disminuir el nombre d&#x27;atributs que es llegeixen d&#x27;una taula. </p><p id="57479e9a-6479-47bb-9c4c-dc19e10022df" class="">Aix√≤ es pot veure clarament amb un escenari extrem. <div class="indented"><p id="9d40f723-088c-4478-97de-d8e8ccef32aa" class="">Penseu en una relaci√≥ <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi></mrow><annotation encoding="application/x-tex">Z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">Z</span></span></span></span></span><span>Ôªø</span></span> amb 2000 atributs. De mitjana, aquests atributs s&#x27;emmagatzemen en 4 bytes cadascun.</p><p id="cee432ff-b86c-4900-b09e-f6c3694ed72b" class="">Durant les nostres tasques d‚Äôan√†lisi, estem interessats en fer consultes de mitjana amb 10.000.000 de tuples, per√≤ nom√©s hi ha cinc atributs dels 2000 que intervenen en la consulta. </p><p id="38b05162-487f-4979-a986-844caa27737e" class="">Per a cada consulta, llegim aproximadament <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100.000</mn><mo>‚àó</mo><mn>2000</mn><mo>‚àó</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">100.000*2000*4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">.</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span></span><span>Ôªø</span></span> (1012 bytes), quan, en realitat, nom√©s necessitem llegir <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>100000</mn><mo>‚àó</mo><mn>5</mn><mo>‚àó</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">100000 * 5 * 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àó</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">4</span></span></span></span></span><span>Ôªø</span></span> (105 bytes).</p></div></p></div></p><p id="72597d73-c2e8-4461-b441-f8d718eb63dc" class="">
</p><p id="20b1fcee-d70b-4575-89a3-73ccab9b513e" class="">En general, </p><ul id="25a9a5b6-dabc-425c-bd34-5f3945f5e681" class="bulleted-list"><li>la fragmentaci√≥ vertical <strong>millora la proporci√≥ de dades √∫tils llegides</strong> (√©s a dir, nom√©s llegim atributs rellevants) i, </li></ul><ul id="80324e7a-4d86-41ba-bfbb-f9e1a5d8c0df" class="bulleted-list"><li>de manera similar a la fragmentaci√≥ horitzontal, tamb√© <strong>redueix la contenci√≥ i facilita la recuperaci√≥ i el paral¬∑lelisme</strong>. </li></ul><p id="55a0fd84-1453-4e19-ba50-437f4a362952" class="">Com a desavantatges, </p><ul id="8ca78584-c62e-4687-85e3-ec779f990806" class="bulleted-list"><li>tingueu en compte que <strong>augmenta el nombre d‚Äô√≠ndexs</strong> (tots de la mateixa mida),<strong> </strong></li></ul><ul id="c6d37154-c2fb-4bc4-9f7d-15b5c29ceeb0" class="bulleted-list"><li><strong>empitjora el temps d‚Äôactualitzaci√≥ / inserci√≥</strong> i, en principi, </li></ul><ul id="bcf9f3e3-8f80-4bd8-9a9a-b6554220f1ea" class="bulleted-list"><li><strong>augmenta l‚Äôespai utilitzat per les dades</strong> (ja que la clau principal es replica a cada fragment).</li></ul><p id="2b7e8da6-26fc-475a-a824-9094d2da5333" class="">
</p><p id="de70d6aa-b0ad-45b7-b173-1ef3181cba1d" class="">Tanmateix, decidir com agrupar atributs en cada fragment no √©s un problema f√†cil. <div class="indented"><p id="87c72016-8e9a-4873-8082-4ed9744a662f" class="">Avui en dia, ens podem beneficiar d‚Äôenfocaments coneguts com el cl√∫ster o la divisi√≥ d‚Äôatributs per agrupar atributs susceptibles de ser llegits junts. </p><p id="5639c76b-a559-47ef-ba3a-e00acd76e5f4" class="">En aquest document, ens centrem en l&#x27;<strong>agrupaci√≥ d&#x27;atributs</strong>. </p><p id="61d07ac8-b652-4b56-b238-4925cd5b9cd5" class="">Per tant, comencem per considerar tota la relaci√≥ i les consultes rellevants que s‚Äôhi plantegen (de nou, es pot utilitzar la regla general amb aquest prop√≤sit) i, a partir d‚Äôaquestes dades, calculem l‚Äôafinitat entre cada parell d‚Äôatributs. </p><p id="3c27be0a-0f71-4384-a244-980bdf887ae3" class="">L&#x27;afinitat de dos atributs respecte a un conjunt de consultes es defineix de la seg√ºent manera:</p><figure id="a1eb2c13-dd87-4a33-9d90-a3e3a55fbbf6" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.30.06.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.30.06.png"/></a></figure><p id="5ddf332f-8417-4d4e-8d4f-0dd84be1720d" class="">On <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>s</mi><mi>e</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo separator="true">,</mo><msub><mi>A</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">use(q_k, A_i) = 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">u</span><span class="mord mathdefault">s</span><span class="mord mathdefault">e</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></span><span>Ôªø</span></span> si...</p><ul id="33cb7a68-6c76-43fd-ae6f-7a430462a9a4" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">q_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> utilitza l&#x27;atribut <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">A_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span> i</li></ul><ul id="1ef36830-fb31-4b5f-9b9d-df0ab362f069" class="bulleted-list"><li><style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mi>r</mi><mi>e</mi><mi>q</mi><mo stretchy="false">(</mo><msub><mi>q</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">freq(q_k)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span><span>Ôªø</span></span> √©s la freq√º√®ncia de qk al sistema. </li></ul><p id="d20e2b29-9258-491d-8429-21e73f9b74b7" class="">Intu√Øtivament, aquesta f√≥rmula ens indica el nombre de consultes on aquests dos atributs apareixen junts, ponderats per la seva freq√º√®ncia.</p></div></p><p id="ba277547-f9cd-42ec-889b-f815462d2434" class="">
</p><p id="120329b8-18a8-47a6-bc98-1a415d0e597d" class="">Per exemple, tingueu en compte la relaci√≥ <code>project</code> i les seg√ºents consultes (freq√º√®ncia que es mostra entre par√®ntesis):</p><pre id="d7f94376-3ec9-4c36-885a-05303614bfbc" class="code"><code>Q1: (30%)
	SELECT SUM(budget) 
	FROM projects 
	WHERE category = CATEGORY_NAME

Q2: (20%)
	SELECT pno, name, city, country 
	FROM projects 

Q3: (10%)
	SELECT productivityRatio, income 
	FROM projects 
	WHERE budget &lt; 10000

Q4: (1%)
	SELECT productivityRatio, income 
	FROM projects 
	WHERE budget &gt; 20000 AND city = ‚ÄòGLASGOW‚Äô

Q5: (25%)
	SELECT pno, country 
	FROM projects 
	WHERE city = CITY_NAME 

Q6: (14%)
	SELECT DISTINCT(category) 
	FROM projects 
	WHERE income &gt; 30000 AND budget &lt; 20000 </code></pre><p id="b94fa600-2daf-443a-bb0a-35f2c16a8830" class="">L&#x27;afinitat entre atributs es pot representar en la seg√ºent matriu sim√®trica (tingueu en compte que la diagonal roman buida ja que no t√© sentit):</p><p id="9fc2519d-9540-49be-8eef-853c92750a3e" class="">On </p><ul id="46f2c117-dbfe-46aa-b373-13ee40eb7cae" class="bulleted-list"><li><code>pno</code> ‚Üí <code>p</code>, </li></ul><ul id="0e261333-75e8-4b9d-9aca-3aa2e2241144" class="bulleted-list"><li><code>name</code> ‚Üí <code>n</code>, </li></ul><ul id="ee426a4c-4e4c-4ef8-b782-64ac2e3a918f" class="bulleted-list"><li><code>city</code> ‚Üí <code>c</code>,</li></ul><ul id="9c7e9d13-d138-4d35-98ef-e807acde81ce" class="bulleted-list"><li><code>country</code> ‚Üí <code>co</code>, </li></ul><ul id="4388c1be-fc1c-4194-b50f-06bd232d21a6" class="bulleted-list"><li><code>budget</code> ‚Üí <code>b</code>, </li></ul><ul id="fea1cc0e-bf07-40c8-af2f-dd1d58def530" class="bulleted-list"><li><code>category</code> ‚Üí <code>ca</code>, </li></ul><ul id="6ddeb087-f264-41fe-a641-4097532b2051" class="bulleted-list"><li><code>productivityRatio</code> ‚Üí <code>pr</code>,</li></ul><ul id="24404310-891e-431a-a26b-0ab0e02004f7" class="bulleted-list"><li><code>income</code> ‚Üí <code>i</code>. </li></ul><p id="b5e14e65-200b-4bb6-b888-a42734a41bb9" class="">
</p><figure id="89e3cb46-abe4-49dc-942a-b6c67abe3cbb" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.36.05.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-09-24_at_09.36.05.png"/></a></figure><p id="20e4d4d9-ddd2-4bf1-b010-96ccac8170fc" class="">Tingueu en compte que aquesta matriu mostra grans depend√®ncies entre atributs. De fet, per transitivitat, podem decidir agrupar un conjunt d‚Äôatributs amb alta afinitat en el mateix fragment. <div class="indented"><p id="27d992fa-d02f-4b51-adee-f4e804e53c03" class="">Per exemple, <code>pno-city</code> i <code>pno-country</code> s√≥n les afinitats m√©s altes. </p><p id="5b227463-e420-478d-9a00-ce2db613c665" class="">A m√©s, la parella <code>city-country</code> tamb√© t√© una alta afinitat (20). <div class="indented"><p id="8a41d48d-790b-4a6b-970a-05483958b4d5" class="">Com que cap d&#x27;aquests est√† relacionat amb cap altre atribut (excepte per a la city, per√≤ amb una afinitat molt baixa), √©s clar que aquests 3 atributs s&#x27;han d&#x27;agrupar. </p></div></p><p id="4a7c05b1-0833-4d7a-af3a-93e816c02130" class="">De la mateixa manera, <code>budget</code>, <code>category</code> i <code>income</code> estan estretament relacionats entre si. </p><p id="ae69b29a-cbb3-4be4-9a72-49c6583599fc" class="">En aquest moment, nom√©s el <code>name</code> i la <code>productivityRatio</code>  no s‚Äôhan agrupat. <div class="indented"><p id="e6f03728-4d57-4cc0-a2d7-dbbe8389d8a6" class="">En el primer cas, √©s clar que <code>name</code> s&#x27;hauria d&#x27;ajuntar al primer grup, ja que no t√© cap relaci√≥ amb cap atribut de l&#x27;altre grup. </p><p id="a80ef3ce-d3da-4a2e-b316-d32174fbcd3f" class="">Quant a la <code>productivityRatio</code>, la situaci√≥ √©s exactament la mateixa, per√≤ al rev√©s: alta afinitat amb el segon grup i baixa afinitat amb el primer.</p></div></p></div></p><p id="81c561bf-2c0a-489e-b2ab-fc1d911f92be" class="">
</p><p id="92176d86-8686-4965-abb1-cc10dfd028c0" class="">Igual que amb qualsevol altra fragmentaci√≥, els fragments verticals produ√Øts han de garantir la completeness, la disjointness i la reconstruction. Concretament:</p><ul id="5c0b5724-2f2e-499b-b5a0-163d3c8353c7" class="bulleted-list"><li>Completeness<ul id="f6e7d081-f867-4484-a2c1-4d02b7f36a97" class="bulleted-list"><li>la uni√≥ dels atributs projectats en cada fragment ha de produir la relaci√≥ original.</li></ul></li></ul><ul id="6f98a915-d4de-46f1-b7c1-20c1ccf54365" class="bulleted-list"><li>Disjointness<ul id="7e1931a6-8404-4a16-b2c1-f50cb275d759" class="bulleted-list"><li>un atribut determinat (excepte la clau prim√†ria) es pot utilitzar per produir nom√©s un fragment. </li></ul><ul id="a7e1b5eb-4cab-448f-8173-98277031cf4d" class="bulleted-list"><li>en altres paraules, tots els atributs (excepte la clau principal) apareixen en un sol fragment.</li></ul></li></ul><ul id="7032f2d3-f150-49e3-bf38-12bfd13e21ce" class="bulleted-list"><li>Reconstruction<ul id="c306f7b9-cae1-48cf-b142-1574a7333378" class="bulleted-list"><li>per garantir la reconstrucci√≥, cal reproduir la clau prim√†ria en cada fragment. </li></ul><ul id="e47772ae-32c3-4709-8c0a-70e452c4eb34" class="bulleted-list"><li>intu√Øtivament, aix√≤ √©s necessari per fer un seguiment de la tupla original i poder reconstruir-la mitjan√ßant unions a trav√©s del <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mi>K</mi></mrow><annotation encoding="application/x-tex">PK</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span></span><span>Ôªø</span></span> replicat. </li></ul><ul id="4cb99a2b-eb26-42b0-8583-71ee56cbd719" class="bulleted-list"><li>aix√≠, <style>@import url('https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css')</style><span data-token-index="0" contenteditable="false" class="notion-text-equation-token" style="user-select:all;-webkit-user-select:all;-moz-user-select:all"><span></span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mo>=</mo><msub><mi>R</mi><mn>1</mn></msub><mo>‚ãâ</mo><msub><mi>R</mi><mn>2</mn></msub><mo>‚ãâ</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo>‚ãâ</mo><msub><mi>R</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">R=R_1‚ãâR_2‚ãâ...‚ãâR_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin amsrm">‚ãâ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin amsrm">‚ãâ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.66334em;vertical-align:-0.08167em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin amsrm">‚ãâ</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.00773em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span><span class="vlist-s">‚Äã</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span><span>Ôªø</span></span></li></ul></li></ul><p id="f0a23b27-c0db-407a-8d5d-6b08b3793751" class="">
</p><p id="ca8f8f04-777b-4b21-b85c-c01c978aed65" class="">En el nostre exemple, tenim dos fragments que es poden representar mitjan√ßant el conjunt d‚Äôatributs que projecten. <div class="indented"><p id="7dd02d4e-e2dd-42f1-bde4-b929439810ff" class="">VP1: <code>{pno, name, city, country}</code>, i </p><p id="b77d8029-c0dd-4e6a-9d7e-a41d0e8b65eb" class="">VP2: <code>{pno, budget, category, income, productivityRatio}</code></p></div></p><p id="275f0e43-56f9-41ab-a652-896bb554c3ad" class="">Llavors:</p><ul id="e64e6bbb-180c-4bb7-889c-6d6e7243846a" class="bulleted-list"><li>Aquesta fragmentaci√≥ √©s completa ja que tots dos fragments contenen tots els atributs de la relaci√≥. </li></ul><ul id="1e464c74-ec63-4ed5-a5b3-b7aea83ba07d" class="bulleted-list"><li>Tamb√© s√≥n disjunts ja que no es repeteix cap atribut. </li></ul><ul id="0ef3cdd1-548c-4659-90dd-23a0dd8e4444" class="bulleted-list"><li>Finalment, per garantir la reconstrucci√≥, repliquem la clau prim√†ria (<code>pno</code>) en cada fragment.</li></ul><p id="a371e39e-f7da-49f9-8d8c-24781b48349f" class="">
</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="e743f9be-a52f-4e9a-8174-955ccc81cdac"><div style="font-size:1.5em"><span class="icon">üìù</span></div><div style="width:100%">En resum, 

la fragmentaci√≥ horitzontal reflecteix les dades distribu√Ødes geogr√†ficament i augmenta la localitat de les dades tant per fer consultes com per inserir / actualitzar. 

Per contra, la fragmentaci√≥ vertical admet millor els sistemes basats en consultes, com ara els sistemes de decisi√≥, i millora dr√†sticament la proporci√≥ de dades √∫tils llegides (nom√©s es llegeixen els atributs rellevants de tot el conjunt d‚Äôatributs de la relaci√≥).</div></figure><h1 id="ead1599b-1945-4682-b020-c3b66d2eef39" class="">Tema 3 - Design of Distributed Databases</h1><h2 id="75c4afa1-0729-4be4-aad4-652ff3549404" class="">Challenges</h2><h3 id="f6310ad8-fc01-4417-bdec-edc5ff02f0bf" class="">DDBs Feats Vs. NOSQL Goals</h3><ul id="61d6f36a-f2f0-467b-a04e-a047d85466c3" class="bulleted-list"><li>Reflect organizational structure<ul id="d791714e-c0a2-4201-8194-0909b4011eaf" class="bulleted-list"><li>Centralized systems are not always possible</li></ul><ul id="691b496f-4ade-45e4-be76-b7f8e297c665" class="bulleted-list"><li>Facilitates sites autonomy</li></ul></li></ul><ul id="58ac8894-e6eb-4887-8a8e-b898778675a3" class="bulleted-list"><li>Share data</li></ul><ul id="40e892a1-1c46-4adb-b643-0d2d6f3f3628" class="bulleted-list"><li>Expected to offer better performance<ul id="8b2eb249-4b1c-4d68-bda6-7ac7edec9c14" class="bulleted-list"><li>Data is placed at locations where it is frequently accessed<ul id="76982a2a-bbe5-4e08-87d3-cb7a4993f3c0" class="bulleted-list"><li>Communication over head minimized</li></ul><ul id="d4cb3e33-8e4d-48e7-9561-01ade3de9275" class="bulleted-list"><li>Parallelism can be exploited locally for query processing</li></ul></li></ul></li></ul><ul id="4239e28f-175f-463f-857a-d34bb5cd0f20" class="bulleted-list"><li>Better availability/reliability<ul id="add23fee-2a1a-4053-99de-9bbea9fb496d" class="bulleted-list"><li>Infront of site failure</li></ul></li></ul><ul id="bff52f26-35f4-4744-b8cb-a1265132ffd8" class="bulleted-list"><li>Scalability<ul id="ebdeccbd-1c77-40a8-a778-c316269d7482" class="bulleted-list"><li>The ‚Äú<em>divide and conquer</em>‚Äù strategy to provide elasticity and avoid bottlenecks<ul id="6837e1a8-5f2b-488a-861e-8ac72de451cf" class="bulleted-list"><li>Peaks provisioning</li></ul><ul id="937c7e08-2fc6-421e-b06f-4a25172dbe52" class="bulleted-list"><li>Unexpected growth</li></ul></li></ul></li></ul><figure id="d97285c5-d66d-4152-b24b-ffb63c8316b5" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.30.57.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.30.57.png"/></a></figure><p id="fb1c3079-a009-4cd8-89e5-0185c3f43075" class="">
</p><h3 id="1ba230c8-2348-4c3f-9371-9175f47544e3" class="">NOSQL Goals</h3><div id="19520ea8-60d9-43a3-9d1e-97ff7bd6b368" class="column-list"><div id="16f67b8a-4f13-4d6c-a580-647aa68fd631" style="width:50%" class="column"><ul id="c016cb8b-8656-4867-ae89-25989b13f637" class="bulleted-list"><li><strong>Schemaless: No explicit schema </strong><mark class="highlight-teal">[data structure]</mark></li></ul><ul id="5ef1f43e-d960-444b-a579-f9eabb8ffc0b" class="bulleted-list"><li>Reliability / availability: Keep delivering  components failservice even if its software or hardware <mark class="highlight-teal">[recovery]</mark></li></ul><ul id="4d84faa9-3912-441d-a4bb-71a003fdd45f" class="bulleted-list"><li>Scalability: Continuously evolve to support a growing amount of tasks <mark class="highlight-teal">[distribution]</mark></li></ul><ul id="09704f1e-4864-402a-ba5c-18de79bb42df" class="bulleted-list"><li>Efficiency: How well the system performs, usually measured in terms of response <em>time </em>(latency) and <em>throughput </em>(bandwith) <mark class="highlight-teal">[distribution]</mark></li></ul></div><div id="045c187b-5a32-43f3-a60e-47260968ac26" style="width:50%" class="column"><ul id="331f678c-59ca-46bf-87eb-2461ddfe00fa" class="bulleted-list"><li>Reliability / availability: Keep delivering  components failservice even if its software or hardware <mark class="highlight-teal">[distribution]</mark></li></ul><ul id="4228b2ee-90ca-4e80-8609-8bf60bc0a916" class="bulleted-list"><li>Scalability: Continuously evolve to support a growing amount of tasks <mark class="highlight-teal">[distribution]</mark></li></ul><ul id="8714661b-5e33-47fd-82e1-d1c4f88f6225" class="bulleted-list"><li>Efficiency: How well the system performs, usually measured in terms of response <em>time </em>(latency) and <em>throughput </em>(bandwith) <mark class="highlight-teal">[distribution]</mark></li></ul></div></div><h3 id="ad6e7dfa-98c4-4b49-b80d-6dbec0df176c" class="">Challenges in Data Distribution</h3><ol id="65735695-38a6-4063-858f-dac784bb3332" class="numbered-list" start="1"><li>Distributed DB design<ol id="d4b69366-2c8e-474a-a7d0-944732382394" class="numbered-list" start="1"><li>Node distribution</li></ol><ol id="1ccfd251-fade-4c44-850c-73538caad5a0" class="numbered-list" start="2"><li>Data fragments</li></ol><ol id="08ddf995-29fd-4929-bc2d-ad3b0d22de67" class="numbered-list" start="3"><li>Data allocation (replication)</li></ol></li></ol><ol id="dc302853-67a8-4dfc-8953-e7a18231d8ea" class="numbered-list" start="2"><li>Distributed DB catalog<ol id="2c54e525-22a6-4898-9074-3c9b9d70b77a" class="numbered-list" start="1"><li>Fragmentation trade-off: Where to place the DB catalog<ol id="9c0fff9a-eee7-44d9-a6c2-e00a405ec9a7" class="numbered-list" start="1"><li>Global or local for each node</li></ol><ol id="bf61291b-92a9-4787-a65f-317a3666bc01" class="numbered-list" start="2"><li>Centralized in a single node or distributed</li></ol><ol id="283c76e3-2c2e-4c6e-a6ca-4dcd39ba19dc" class="numbered-list" start="3"><li>Single-copy vs. Multi-copy</li></ol></li></ol></li></ol><ol id="b6ad9179-853d-425a-9562-2a9c191f852d" class="numbered-list" start="3"><li>Distributed query processing<ol id="3added51-7b1b-4473-af8b-300730c6c968" class="numbered-list" start="1"><li>Data distribution / replication</li></ol><ol id="2070eeb0-941a-4b42-bec3-62c053c89915" class="numbered-list" start="2"><li>Communication overhead</li></ol></li></ol><ol id="472e9517-6d65-41f0-8eed-5af6a4f4b680" class="numbered-list" start="4"><li>Distributed transaction management<ol id="4011a379-7aa9-4bd0-948f-f6f17697fa94" class="numbered-list" start="1"><li>How to enforce the ACID properties<ol id="e16a552d-8680-4863-bb5c-c4ba2ed22639" class="numbered-list" start="1"><li>Replication trade-off: Queries vs. Data consistency between replicas (updates)</li></ol><ol id="ae70ef45-2679-4b85-af70-c3911568233d" class="numbered-list" start="2"><li>Distributed recovery system</li></ol><ol id="735ab2f9-966c-42a5-8b36-2844ffb0771e" class="numbered-list" start="3"><li>Distributed concurrency control system</li></ol></li></ol></li></ol><ol id="df200b1b-d416-4f1a-94d6-214b3ca243b1" class="numbered-list" start="5"><li><del>Security issues</del><ol id="adeeefaf-53a1-465e-9846-1f10ba6c81f6" class="numbered-list" start="1"><li><del>Network security</del></li></ol></li></ol><p id="68928517-bf4e-4546-ab0c-4a6c23b6aec2" class="">
</p><h3 id="34ca1ae4-f303-4f27-9c01-07ab11241073" class="">Challenge I: DDB Design</h3><ul id="62e7f7b9-bdc5-47d0-a62a-27bbd9cb852a" class="bulleted-list"><li>Suitable for top-down design<ul id="1802a0c6-dc43-4f5b-9399-f03169f2e466" class="bulleted-list"><li>Given a DB and its workload, how should the DB be split and allocated to sites as to optimize certain objective functions<ul id="cacf5ba2-fd06-4f60-abb8-5573d5bc766b" class="bulleted-list"><li><strong>Minimize resource consumption for query processign</strong></li></ul></li></ul></li></ul><ul id="e65f6b5f-58d9-4215-9c64-4aa5efbe451e" class="bulleted-list"><li>Two main issues:<ul id="fbba3753-557b-4527-8a73-fd91be398ed7" class="bulleted-list"><li>Data fragmentation</li></ul><ul id="41ed7538-431a-4d71-a42e-8f8dd1c80ab1" class="bulleted-list"><li>Data allocation (data replication)</li></ul></li></ul><h2 id="fb514e9c-018b-4095-a1ff-2f308d4f2566" class="">Allocation (and replication)</h2><h3 id="0cb612e0-1753-48cf-826d-56ab5fe75660" class="">Decide Data Allocation</h3><ul id="929d0ffb-64ff-4d28-adf8-f7862ebea1ae" class="bulleted-list"><li>Given a set of fragments, a set of sites on which a number of applications are running, <strong>allocate </strong>each fragment such that some optimization criterion is met (subject to certain constraints)</li></ul><ul id="d8abce1d-1e2b-4c65-9452-2d2f1f81468e" class="bulleted-list"><li>It is known to be a NP-hard problem <ul id="b0bbefd5-8081-4bec-ae6b-ca55e018f2d8" class="bulleted-list"><li>The optimal solution depends on many factors<ul id="5640d3b6-b81b-492b-ba95-da1eb6f6964d" class="bulleted-list"><li>Location in which the query originates</li></ul><ul id="578289e4-727e-46c8-8164-e156d7d94120" class="bulleted-list"><li>The query processing strategies (e.g., join methods)</li></ul></li></ul><ul id="312af8ee-28f3-4282-9556-0da3f787447a" class="bulleted-list"><li>Furthermore, in a dynamic environment the workload and access pattern may change</li></ul></li></ul><ul id="a133ab90-da92-4caf-8fb6-1c149c244e7e" class="bulleted-list"><li>Most advanced approaches build <em>cost models </em>and any optimization algorithm can be adapted to solve it<ul id="462a4cd9-614d-48a8-b132-e4e1227d23b1" class="bulleted-list"><li>Simply the problema with assumptions (e.g., only communication cost considered)</li></ul><ul id="1dbf5eb3-1039-4e12-ae3c-ae3588064a98" class="bulleted-list"><li>Heuristics are also available: (e.g., best-fit for non- replicated fragments)</li></ul><ul id="8f2498a5-3843-40bc-ac78-29d65e8fc661" class="bulleted-list"><li>Sub-optimal solutions (i.e., applied per fragment individually)</li></ul></li></ul><p id="2d064a97-e488-4804-b8b2-cb865e915d10" class="">
</p><figure id="3f19e217-ad01-4d91-9112-a83720c06022" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.44.06.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.44.06.png"/></a></figure><h3 id="f6fc1384-bd27-4faa-86bd-8acb6bb54e73" class="">Manage Data Replication</h3><ul id="85942b6d-832c-4a1c-ae9c-73641c6bf85b" class="bulleted-list"><li>Replicating fragments improves the system throughput but raises some other issues:<ul id="31876d04-f94b-4d79-a800-bcb6f811134a" class="bulleted-list"><li>Consistency</li></ul><ul id="84ecd2f2-d201-48df-8092-a62ff672e9a0" class="bulleted-list"><li>Update performance</li></ul></li></ul><ul id="a3e89722-16aa-4a4f-add6-98dc73fc8075" class="bulleted-list"><li>Most used replication protocols<ul id="b10541a4-5f5c-48eb-8c15-50a9bf5d082a" class="bulleted-list"><li>Primary ‚Äì Secondary versioning</li></ul><ul id="0eae6bd0-4c67-41bc-906f-2c065f241818" class="bulleted-list"><li>Eager ‚Äì Lazy replication</li></ul></li></ul><div id="321b1c63-690d-4720-9491-c0719110ef3c" class="column-list"><div id="8c29095c-f606-4811-be20-e19dda8ff6aa" style="width:50%" class="column"><figure id="b5d1e7c1-d3e0-4368-81d8-55eb17c2faee" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.45.02.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.45.02.png"/></a></figure></div><div id="a67fd3e8-45de-4091-b259-6f8235cfdbaa" style="width:50%" class="column"><figure id="8f6952cc-239c-4da2-beaf-43bcbdb1619f" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.45.36.png"><img style="width:2116px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.45.36.png"/></a></figure></div></div><h2 id="e70bb3cb-8e34-4536-a494-a1484889b3c2" class="">Catalog</h2><h3 id="2a205f0a-9368-4468-afbf-dfef928151dd" class="">Challenge II: Global Catalog</h3><figure id="e14ed573-fe79-4d34-a70e-99c42762e66d" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.48.53.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.48.53.png"/></a></figure><p id="3fce9565-c977-4c46-8ad1-215cb826ff4a" class="">
</p><ul id="d570e4df-1c80-43dc-b5dd-65b175e6a3f6" class="bulleted-list"><li><strong>Centralized version (@master)</strong><ul id="cad52cb9-b3bb-495a-a0fc-cc438cc65720" class="bulleted-list"><li><strong>Accessing it is a bottleneck</strong><ul id="11ddea74-d69f-4649-8304-acc5c0d34199" class="bulleted-list"><li>Single-point failure<ul id="d55e3dbc-ad49-4372-8a6a-579c40b754b7" class="bulleted-list"><li>May add a mirror</li></ul></li></ul><ul id="1aaee022-03f2-427e-b0ab-73e6ad1f17ee" class="bulleted-list"><li>Poorer performance</li></ul></li></ul></li></ul><ul id="04922cf4-734a-4cfc-a3df-14420dadc8b7" class="bulleted-list"><li><strong>Distributed version (several  </strong><em><strong>masters</strong></em><strong>)</strong><ul id="57d6ce62-8769-413b-bd6b-50f6252950be" class="bulleted-list"><li><strong>Replica synchronization</strong><ul id="eae1b6cf-e441-4344-ae39-51ca339751c8" class="bulleted-list"><li>Potential inconsistencies</li></ul></li></ul></li></ul><p id="142cd44b-c12d-40f7-902b-430bcfaaa85a" class="">
</p><figure id="877b0566-3f2b-4ba5-9053-2dfb454d1608" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.49.59.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.49.59.png"/></a></figure><div id="cd51f185-f017-476f-a713-8918565fd95e" class="column-list"><div id="bdda2791-2e7d-431f-8b76-7094e090099a" style="width:50%" class="column"><figure id="f3700401-1ed4-4ade-947d-26557b346648" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.50.17.png"><img style="width:2116px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.50.17.png"/></a></figure></div><div id="86885532-af16-4d18-97a1-da1b2a08c62c" style="width:50%" class="column"><figure id="2297f3b6-4e36-465e-8598-43e7c19b07a8" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.50.26.png"><img style="width:2116px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.50.26.png"/></a></figure></div></div><h3 id="5caac764-a2fb-4dfb-9c84-7b05b5bccb6f" class="">Scalability</h3><p id="4059dd78-3182-4a9e-9b23-c4ee400ced9c" class="">Definition: <strong>How do we define ‚ÄúScalability‚Äù? And ‚ÄúElasticity‚Äù?</strong></p><ul id="de176df8-c8c1-4ce6-a12e-48faf9cf4e37" class="bulleted-list"><li>It is a design issue<ul id="cce94f41-f244-4f04-9d4e-ad44b3db95b5" class="bulleted-list"><li><strong>Current systems do not tell you  </strong><em><strong>how many </strong></em><strong>CPUs or servers you must use</strong></li></ul></li></ul><ul id="31c94b00-680e-484c-bdef-c100056312f9" class="bulleted-list"><li>The Universal Scalability Law (USL) ‚ÄìGunther 1993<ul id="fb66b225-5df4-4fb3-8f72-95333aff3e36" class="bulleted-list"><li><strong>It is a mathematical definition of scalability</strong></li></ul><ul id="3bfa1f74-5e7d-4f28-b4cf-021441f32b9b" class="bulleted-list"><li>Main idea: You cannot model what you cannot formally define</li></ul></li></ul><h3 id="39f7e62a-a14d-44f0-bc01-d4d7c144827f" class="">The Universal Scalability Law (I)</h3><ul id="7d8ff8b2-8fd0-4760-88bd-132c8e237c97" class="bulleted-list"><li><strong>It can model both Sw or Hw scalability</strong></li></ul><ul id="e26d7a53-a9ef-494c-a064-4bd83a1025ac" class="bulleted-list"><li><strong>The USL is defined as follows:</strong><figure id="5706a29e-10ac-42da-a67b-2a5e293a9261" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.53.11.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.53.11.png"/></a></figure><figure id="4b5289b4-024f-49f1-80fa-a81209615045" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.53.29.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.53.29.png"/></a></figure></li></ul><p id="8463430b-f0f6-4c3c-9b68-ce4ec6ef7f64" class="">
</p><h3 id="3b06061e-a23e-4502-9fe0-0325be49e29c" class="">The USL at Work</h3><ul id="ddb68e75-4539-4fe2-9e31-39e40b452d47" class="bulleted-list"><li><strong>Method:</strong><ul id="281d0261-703f-43e9-b6fe-ccdac07ef224" class="bulleted-list"><li>[Step 1] Empirical analysis: Compute C (throughput) for different values of N (concurrency)</li></ul><ul id="1892f9b7-91ae-4ed4-a00f-08b3c1ad7d9e" class="bulleted-list"><li>[Step 2] Perform statistical regression against gathered data (needs some data cooking first)</li></ul><ul id="f7865b23-5641-4dbd-bc93-111cb4c791c3" class="bulleted-list"><li>[Step 3] Reverse the transformation to find the œÉ (contention) and Œ∫ (consistency delay)
parameters</li></ul></li></ul><ul id="6427317c-a858-42bb-adcc-e7d032104cb1" class="bulleted-list"><li><strong>How to apply this method step by step: </strong><a href="http://www.percona.com/files/white-papers/forecasting-mysql-scalability.pdf">http://www.percona.com/files/white-papers/forecasting-mysql-scalability.pdf</a> </li></ul><figure id="e151c6ff-f059-429b-8e68-cb9d45f63e02" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.56.14.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_15.56.14.png"/></a></figure><h3 id="f31b3ae8-3601-4d14-902b-cb5d6efb2109" class="">Measuring Scalability</h3><ul id="a57a89c3-8943-4de5-9b12-1349cc9f30d9" class="bulleted-list"><li>Ideally, scalability should be linear</li></ul><ul id="e719d0d1-c8c1-45b4-8cd2-3e143eed2cb0" class="bulleted-list"><li>Scalability is normally measured in terms of speed-up and scale-up<ul id="39c15bcc-b0ec-48a2-811b-371b7ed0fb0c" class="bulleted-list"><li>Speed-up: Measures performance when adding Hw for a constant problem size<ul id="7ccb3269-6653-4e25-87eb-d936378689ce" class="bulleted-list"><li>Linear speed-up means that N sites solve in T/N time, a problem solved in T time by 1 site</li></ul></li></ul><ul id="56110572-0999-4ab8-a1d2-c4ea9f8c9037" class="bulleted-list"><li>Scale-up: Measures performance when the problem size is altered with resources<ul id="cf874f70-0db7-462f-a915-4485a10342e7" class="bulleted-list"><li>Linear scale-up means that N sites solve a problem N*T times bigger in the same time 1 site solves the same problem in T time</li></ul></li></ul></li></ul><ul id="6d2c1316-d55b-4e90-8f53-6965fa61755d" class="bulleted-list"><li>The USL shows that linear scalability is hardly achievable<ul id="14c37acf-a38c-44be-853d-7f411e3fa51a" class="bulleted-list"><li>œÉ (contention) could be avoided (i.e., œÉ = 0) if our code has no serial chunks (everything parallelizable)</li></ul><ul id="797a0305-218c-4086-97da-46152c67eade" class="bulleted-list"><li>Œ∫ (consistency delay) could be avoided (i.e., Œ∫ = 0) if replicas can be synchronized without sending messages</li></ul></li></ul><p id="1f896d11-c395-4ff9-8cf7-15c230160b30" class="">
</p><p id="20631e8f-81d8-4f34-a324-0d943fd7f72d" class="">
</p><p id="d8720a36-6f17-447d-a577-7088cb85bf81" class="">
</p><p id="eb18a853-1b0a-4b0b-991f-47596cdb2f66" class="">
</p><p id="0a231436-a453-4321-a421-c68b136b8bcb" class="">
</p><p id="63d4e375-1680-4794-9e3e-55e67c9624b0" class="">
</p><p id="a109e679-f249-4c12-a176-47d88a6e5bad" class="">
</p><p id="ecb8a79c-bf1b-43fb-b132-ca01f25b3ca3" class="">
</p><p id="4eefb7c6-7c9f-4c49-afff-07fc676d9965" class="">
</p><h1 id="9837ba62-b9f0-4095-98cf-fffa2ef4d496" class="">Tema 4 - Distributed Query Processing</h1><h2 id="6499eeb0-07ac-4102-a301-fe4e73d16545" class="">Instructions on the Distributed Query Processing Activity</h2><h3 id="48cb850c-53ae-4cbb-9a9c-9a14ae178c15" class=""><strong>OBJECTIVES</strong></h3><p id="b0fda134-2420-4c5f-9d45-8ab61fb752e3" class="">Learn about distributed query processing. Namely:</p><ul id="6c13adef-acd9-416b-b2e9-b244bd08665d" class="bulleted-list"><li>The differences between centralized and distributed query processing,</li></ul><ul id="2dbead1a-f658-47d3-95f7-051d2d36fc36" class="bulleted-list"><li>Phases of the distributed query processing</li></ul><h3 id="215f6b28-ae12-42bf-8351-6a120745a1df" class=""><strong>ACTIVITIES</strong></h3><p id="c43e7cb0-d8f0-4dae-82e9-89b2bf636e46" class="">During the week, read and understand the following parts of the ‚ÄúLab Material: Distributed Query Processing‚Äù document (you will find it in the additional material provided for the ‚ÄúAdvanced Notions on Distributed Databases‚Äù lab):</p><ul id="3e068e5f-55c4-4a50-bc3b-68723e86aa74" class="bulleted-list"><li>If needed, refresh how centralized query processing works (Section 1: ‚ÄúBasics of Query Optimization‚Äù)</li></ul><ul id="efbd3813-03e5-4d36-b0c0-1483071d9ba6" class="bulleted-list"><li>Read the section about distributed query processing (Section 2: from page 19 to page 30).</li></ul><h3 id="982fb74f-dc40-4b63-afbc-aec4f6efbf42" class=""><strong>DELIVERABLES</strong></h3><p id="a218f1d7-125d-4921-8a19-224574d5fcf3" class="">Solve the following exercise (you can do it with one of your classmates), and hand in the solution at the beginning of the lecture on ‚ÄúDistributed Query Processing‚Äù:</p><figure id="35e1dd05-0175-4e1d-94bc-26b9fca51da4" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-10-06_at_07.30.05.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-10-06_at_07.30.05.png"/></a></figure><h3 id="b03b5743-b5f2-4458-b511-2a125f6aec87" class="">Material: Distributed Query Processing</h3><h3 id="4fe640c1-ba98-4846-8c73-99d63b3c8179" class="">Basics of Query Optimization</h3><p id="fab998ea-cb2f-4a15-8bf8-0c2d5de3d5ca" class="">SQL es un lenguaje <strong>declarativo</strong> mediante el cual los usuarios expresan sus necesidades de informaci√≥n. Al ser un lenguaje declarativo, los usuarios declaran los datos que quieren obtener, pero no la forma en que debe recuperarse del sistema de gesti√≥n de bases de datos (DBMS).
</p><p id="d98aecdb-a41c-4dd0-8f39-d7b3c846cf91" class="">Dada una declaraci√≥n SQL, el objetivo del procesamiento de consultas es recuperar los datos necesarios para lograr esa declaraci√≥n. Se llevan a cabo los siguientes pasos:</p><ol id="08eca201-ff58-4a53-9172-51f7b8b3392e" class="numbered-list" start="1"><li><strong>Validaci√≥n</strong>: esto implica la validaci√≥n de sintaxis y esquema, pero tambi√©n responsable para expandir vistas y verificar permisos.</li></ol><ol id="4e2e253b-d7d3-47fe-8808-6d2d55736da1" class="numbered-list" start="2"><li><strong>Optimizaci√≥n</strong>: se aplican ciertas reglas y heur√≠sticas para generar con el plan de acceso m√°s econ√≥mico (a ejecutar en el siguiente paso).</li></ol><ol id="4f57c3c3-cfe3-46bc-a3e3-0697ff53cd78" class="numbered-list" start="3"><li><strong>Ejecuci√≥n</strong>: Es la ejecuci√≥n del plan de acceso que se decidi√≥ en el paso anterior. Se refiere principalmente al acceso al disco y la transformaci√≥n de datos aplicada (por medio de algoritmos, como ordenar o unir) que proporcionan los datos deseados.</li></ol><p id="009f4fb9-5b5b-4d51-bf18-2e7174e56dfc" class="">
</p><p id="d5093179-b7f1-4cee-9131-403d8f923552" class="">Dada una consulta, hay muchas estrategias que un DBMS puede seguir para procesarla y producir su respuesta. Estas estrategias var√≠an seg√∫n los algoritmos disponibles y recursos utilizados (por ejemplo, disco y memoria). Todos ellos son equivalentes en t√©rminos de su producci√≥n final, pero var√≠an en su costo, es decir, la cantidad de tiempo que necesitan correr. Esta diferencia de costo puede ser de varios √≥rdenes de magnitud. As√≠, todos los DBMS tienen un m√≥dulo que examina diferentes alternativas y elige el plan que necesita la menor cantidad de tiempo. Este componente se llama consulta optimizador.</p><p id="08cba76f-a43c-4236-b6f9-5671b7667026" class=""><div class="indented"><p id="7683faa5-2fbc-4662-a1a2-9211159e540d" class=""><em>&quot;Un optimizador de consultas traduce una consulta en una secuencia de operadores f√≠sicos que el motor de ejecuci√≥n de consultas puede llevar a cabo directamente. El resultado del optimizador se denomina plan de </em><em><strong>acceso a consultas</strong></em><em>. 
El objetivo de la optimizaci√≥n de consultas es obtener un plan de ejecuci√≥n eficiente en t√©rminos de medidas de rendimiento relevantes, como el uso de memoria y el tiempo de respuesta a las consultas&quot;.
Evaggelia Pitoura</em></p></div></p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="4776cbe2-1ab5-4eb3-b3e4-375968b2a743"><div style="font-size:1.5em"><span class="icon">üó£</span></div><div style="width:100%">En realidad, el optimizador de consultas no comprueba exhaustivamente todas las alternativas de ejecuci√≥n, pero utiliza ciertas heur√≠sticas para delimitar el espacio de b√∫squeda exponencial.</div></figure><p id="e92e83b0-f4b2-4240-b245-1da9a65c97df" class="">El optimizador, como se representa en la Figura 1, es un m√≥dulo dentro del DBMS; </p><ul id="4efa6941-5f20-4152-886f-d23c1f30b4a8" class="bulleted-list"><li>entrada es una consulta SQL </li></ul><ul id="67899ccb-606f-4729-a420-28a2477769e3" class="bulleted-list"><li>su salida es un plan de acceso expresado en un lenguaje de procedimiento dado</li></ul><figure id="9afee839-b9ea-484d-9f4e-61f5d5994939" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-10-06_at_07.42.20.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2020-10-06_at_07.42.20.png"/></a></figure><p id="aa0a7988-c724-4f1e-9b6d-bf16ff0e2bfc" class="">Su objetivo es obtener el mejor algoritmo de ejecuci√≥n posible.</p><p id="8562c48d-f68d-439f-9700-1be4971dc270" class="">Para hacerlo, el optimizador se basa en la siguiente informaci√≥n del cat√°logo:</p><ul id="c3a30f61-0a4f-4a7f-88d6-4ae873b922d0" class="bulleted-list"><li>Estad√≠sticas de contenido<ul id="94c7214e-9489-4d96-ac00-05a94d1a57e7" class="bulleted-list"><li>como n√∫mero de tuplas, tama√±o de atributos, etc.</li></ul></li></ul><ul id="a41b576f-c691-4232-b521-34258ad77f30" class="bulleted-list"><li>Estructuras de almacenamiento disponibles<ul id="d9aab68b-a371-48ea-bfaa-5f047a7f0520" class="bulleted-list"><li>particiones y vistas materializadas.</li></ul></li></ul><ul id="be754edb-505f-4f7e-8629-88928e937e88" class="bulleted-list"><li>Estructuras de acceso disponibles<ul id="24028b79-5c94-4160-982e-68168528bf7f" class="bulleted-list"><li>√°rbol B e √≠ndices hash</li></ul></li></ul><ul id="adb21241-4a38-4617-85c7-05645d59ca1f" class="bulleted-list"><li>Algoritmos aplicables: principalmente para unir y ordenar.</li></ul><p id="ce7c0745-b12d-4b4b-bc8e-6c415662d099" class="">
</p><p id="19d1964f-a18a-4458-9687-66d1c88fa94a" class="">En general, un DBMS no encuentra el plan de acceso √≥ptimo, pero obtiene una aproximaci√≥n (en un tiempo razonable). Encontrar el √≥ptimo es computacionalmente dif√≠cil (NP-complejo en el n√∫mero de relaciones involucradas), lo que puede resultar en costos m√°s altos que simplemente recuperar los datos. Por tanto, los DBMS utilizan heur√≠sticas para llegar a una aproximaci√≥n, es decir, en ocasiones no obtienen el √≥ptimo, pero suelen estar cerca de √©l. </p><p id="ed274d49-bad2-40f0-bc0a-8a2d54cc58ae" class="">Es importante saber c√≥mo funciona el optimizador para detectar desviaciones y corregirlas, cuando sea posible (por ejemplo, agregar o eliminar ciertos √≠ndices, particiones, etc.). Esta es la base de lo que se conoce como ajuste f√≠sico, la tarea principal de cualquier DBA, que consiste en desplegar el mejor escenario (por ejemplo, crear √≠ndices, vistas, agrupamiento, actualizaci√≥n de estad√≠sticas, etc.) que produzca el mejor plan de acceso. </p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="7835fe31-1c47-4346-9567-4cb94330917c"><div style="font-size:1.5em"><span class="icon">‚úÖ</span></div><div style="width:100%">La funci√≥n de costo del optimizador de consultas generalmente se refiere a recursos de la m√°quina, como espacio en disco, entrada/salida de disco, espacio de b√∫fer, tiempo de CPU y ancho de banda de red. En los sistemas centralizados actuales donde la base de datos reside en el almacenamiento en disco, el √©nfasis est√° en minimizar el n√∫mero de accesos al disco.</div></figure><h3 id="575c80fd-4c84-4e85-8bc6-9cb9f31584f9" class="block-color-purple_background">Centralized Architecture</h3><p id="1e39bf08-0add-4497-8d45-06db131ef4ff" class="">Es crucial comprender completamente la optimizaci√≥n de consultas en entornos centralizados antes de abordar el mismo problema en sistemas distribuidos, ya que los mismos principios (con algunas extensiones) se aplican para la optimizaci√≥n de consultas distribuidas. </p><p id="9a4e6605-dcfb-44ed-bf2e-4b5d5243a535" class="">Por lo tanto, en esta secci√≥n, repasaremos los conceptos b√°sicos de la optimizaci√≥n de consultas. Por ahora ignoraremos la presencia de una red, pero los datos pueden estar en diferentes discos en la misma m√°quina, siempre y cuando no usemos ning√∫n tipo de paralelismo. </p><p id="2dde4b1f-8336-4a7a-9c1f-bdc148dc323d" class="">La optimizaci√≥n de consultas se presenta t√≠picamente como si se ejecutara en tres pasos secuenciales (es decir, optimizaci√≥n sem√°ntica, sint√°ctica y f√≠sica).</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="183ab15b-8cfb-488a-8716-036809132b96"><div style="font-size:1.5em"><span class="icon">‚úÖ</span></div><div style="width:100%">Aunque la optimizaci√≥n de consultas se discute en tres m√≥dulos secuenciales (optimizaci√≥n sem√°ntica, sint√°ctica y f√≠sica) con fines did√°cticos, los l√≠mites de estos m√≥dulos no son tan claros en la implementaci√≥n, que tiende a no ser tan modular.</div></figure><h3 id="717cd84e-e64d-4d63-a471-40b5d2cb21d6" class="">‚Üí Semantic Optimization</h3><p id="51831aa2-4d8b-4859-9adb-fae9c213f395" class="">Este es el primer paso que debemos dar y consiste en transformar (es decir, reescribir) la sentencia SQL en una equivalente de menor costo, considerando:</p><ul id="27fb318c-c54f-480c-b333-59d4640e1639" class="bulleted-list"><li>Restricciones de integridad: definidas en el esquema (por ejemplo, comprobaciones, unicidad, etc.)</li></ul><ul id="8276193a-a14b-40cd-ae0c-2d40e6493eca" class="bulleted-list"><li>Propiedades l√≥gicas: algunas caracter√≠sticas l√≥gicas b√°sicas se pueden utilizar en este paso para explotar a√∫n m√°s las restricciones de integridad del esquema (por ejemplo, transitividad, subsunci√≥n, etc.)</li></ul><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="6ef5790e-3a09-4fcc-841f-c04433a55b2b"><div style="font-size:1.5em"><span class="icon">‚úÖ</span></div><div style="width:100%"><strong>Forma normal conjuntiva
</strong>Este es un predicado de la forma: (x OR y) AND (z OR t OR u) AND ...</div></figure><p id="599e1728-7b22-4887-a419-4c96b2a2107e" class="">
</p><p id="14c73912-1c5b-4aa7-ac07-909e73285300" class="">En esta fase, el DBMS aplica transformaciones a una consulta determinada y produce una consulta SQL equivalente destinada a ser m√°s eficiente. Por ejemplo, el predicado se puede estandarizar en la forma normal conjuntiva (CNF) (con servicios de razonamiento bien conocidos aplicados), las consultas anidadas se pueden aplanar en algunos casos, y similares. El objetivo principal es encontrar consultas tautol√≥gicas, consultas con forma incorrecta o consultas contradictorias (siempre desde el punto de vista de las restricciones de integridad). Tener una forma incorrecta significa que hay una mejor manera de escribirlos desde el punto de vista del desempe√±o, mientras que contradictorio significa que su resultado ser√° el conjunto vac√≠o. Es importante tener en cuenta que las transformaciones realizadas en esta fase solo dependen de las caracter√≠sticas declarativas (es decir, est√°ticas) de las consultas y no tienen en cuenta los costos de consulta reales para el DBMS espec√≠fico y la base de datos en cuesti√≥n. En otras palabras, la entrada de este m√≥dulo es una consulta SQL y un esquema (con un conjunto de restricciones de integridad) y produce una consulta SQL optimizada equivalente sobre el mismo esquema.<div class="indented"><p id="9e6e72c0-7a5c-445f-adc7-2741ae0553d7" class=""><em>La aplicaci√≥n de la transitividad y la replicaci√≥n de cl√°usulas sobre las equivalencias es un ejemplo t√≠pico de una transformaci√≥n realizada en esta fase de la optimizaci√≥n para hacer frente a consultas incorrectas.
Esto puede parecer un poco ingenuo, pero permite usar √≠ndices sobre ambos atributos. Por ejemplo, si el optimizador encuentra &quot;a-b AND a=5&quot;, lo transformar√° en &quot;a-b AND a=5 AND b=5&quot;, de modo que si hay un √≠ndice sobre &quot;b&quot;, tambi√©n se puede tomar en consideraci√≥n en fases posteriores
Otro ejemplo de optimizaci√≥n sem√°ntica para consultas incorrectas es la eliminaci√≥n de disyunciones. Por ejemplo, podemos transformar la disyunci√≥n de dos igualdades sobre el mismo atributo en un &quot;IN&quot; (por ejemplo, &quot;a ‚Äî I OR a = 2&quot; tambi√©n se puede expresar como &quot;un IN (1,2)&quot;). Reducir el n√∫mero de cl√°usulas en el predicado de selecci√≥n de esta manera tambi√©n podr√≠a reducir su costo de evaluaci√≥n. Sin embargo, tal transformaci√≥n no se detecta f√°cilmente en predicados complejos y solo se puede realizar en los casos m√°s simples.Ahora, considere la siguiente relaci√≥n:</em></p><pre id="f6accf23-f55c-447a-9280-b62169c77c7f" class="code"><code>CREATE TABLE people 
(
	id INT PRIMARY KEY, 
	age INT CHECK (age&gt;18 AND age&lt;65), 
	weight FLOAT
);</code></pre><p id="680072db-6152-43e2-90cd-408cf719c264" class=""><em>Cualquier consulta (parcial o completamente) que viole una restricci√≥n de integridad (ya sea del modelo o del esquema) debe identificarse como una consulta contradictoria. Por ejemplo:</em></p><pre id="7f289583-3daa-4660-8596-cb74b26da6f5" class="code"><code>Q1 = SELECT * FROM people WHERE id IS NULL
Q2 = SELECT * FROM people WHERE age = 66
Q3 = SELECT * FROM people WHERE weight&gt;50 AND weight&lt;45</code></pre><p id="e157b998-fb38-41fa-aae2-5371bf848802" class="">Todas estas consultas recuperar√≠an el conjunto vac√≠o por diferentes razones. Por ejemplo, QI est√° solicitando valores NULL en un atributo definido como clave principal (es decir, violando una restricci√≥n de modelo que dice que las claves primarias no pueden ser NULL); Q2 viola una restricci√≥n de integridad de esquema (definida con un CHECK), mientras que Q3 viola las reglas l√≥gicas con respecto a los n√∫meros: un flotante no puede ser mayor que 50 y menor que 45 al mismo tiempo.</p><figure class="block-color-teal_background callout" style="white-space:pre-wrap;display:flex" id="6a104cf0-37eb-4d0d-b8bb-bb041bc8d8db"><div style="font-size:1.5em"><span class="icon">‚úÖ</span></div><div style="width:100%">En general, la optimizaci√≥n sem√°ntica es realmente deficiente en la mayor√≠a (si no en todos) los DBMS, y solo es √∫til en consultas simples. Por lo tanto, aunque SQL se considera un lenguaje declarativo, la forma en que escribimos la declaraci√≥n puede ocultar algunas optimizaciones y afectar su rendimiento. Por lo tanto, una forma sencilla de optimizar una consulta (sin ning√∫n cambio en el esquema f√≠sico de la base de datos) puede ser simplemente reescribirla de una manera diferente.</div></figure></div></p><p id="8b8996f6-d414-4e50-ac10-9660ff6fd863" class="">
</p><h3 id="d2d467b1-8a0b-4104-ac06-498c95f7abe2" class="">‚Üí Syntactic Optimization√ß</h3><p id="a8196824-7009-41b3-a646-685fb6aed34d" class="">Consiste en traducir la consulta de SQL a una secuencia de operaciones algebraicas. Puede haber muchas secuencias de operaciones algebraicas correspondientes a la misma consulta SQL. Si es as√≠, el optimizador elegir√≠a el que tenga un costo m√≠nimo, mediante heur√≠stica. Estas secuencias generalmente se representan en √°lgebra relacional como f√≥rmulas o en forma de √°rbol (com√∫nmente conocido como √°rbol sint√°ctico). La interpretaci√≥n del √°rbol es la siguiente:</p><ul id="16b85d11-11d6-442a-8044-f89eaa7618b5" class="bulleted-list"><li>Nodos, de los que distinguimos tres tipos:<ul id="12727163-da0c-4f3f-a51c-a7dad099b5f8" class="bulleted-list"><li>Ra√≠z: representa el resultado final de la consulta y, por lo tanto, es √∫nico.</li></ul><ul id="1088ad0a-ca75-4bd4-a6f2-f2e8a1b47fc9" class="bulleted-list"><li>Interno: Representa operaciones algebraicas (por ejemplo, uniones, proyecciones, uniones, etc.).</li></ul><ul id="286f87bf-45a4-4a02-9839-aedd596ac372" class="bulleted-list"><li>Hojas: Representan accesos a mesa (o relaci√≥n).</li></ul></li></ul><ul id="e061dfbc-e508-47b7-9884-825f10468927" class="bulleted-list"><li>Bordes: Representan flujos de datos. El nodo al que apunta la flecha requiere los datos producidos por el nodo ubicado en la cola de la flecha.</li></ul><p id="5eb395c1-b08b-449a-8165-90fd310115e2" class="">El objetivo de esta fase es reducir, tanto como sea posible, la cantidad de datos que fluyen desde las hojas hasta la ra√≠z determinando el orden entre operadores. Deja los datos le√≠dos de las tablas y los nodos internos transforman los datos le√≠dos.
</p><p id="43dbde94-b07a-4f19-bd07-a19327012675" class="">Por lo tanto, esto se puede lograr principalmente de dos maneras: (i) reduciendo el n√∫mero de atributos lo antes posible y (ii) reduciendo el n√∫mero de tuplas lo antes posible. Desde el punto de vista del √°lgebra relacional, (i) implica proyectar lo antes posible y (ii) significa seleccionar lo antes posible.
</p><p id="1a34a2f8-1fce-496d-adaf-a95b77cc0c82" class="">Proyectar y seleccionar lo antes posible es claramente deseable si queremos reducir la cantidad de datos que fluyen a trav√©s de las operaciones algebraicas tanto como sea posible. Sin embargo, tenga en cuenta que menos datos no siempre implica un plan de acceso m√°s eficiente. </p><p id="e916983b-272d-441b-94ba-5eba48c33fd7" class="">Los √≠ndices, cl√∫steres y otras estructuras de acceso solo son accesibles a nivel de tabla (es decir, nivel de hoja) y nodos internos (es decir, operaci√≥n interna
atores) no se benefician de ellos. Sin embargo, las estructuras de acceso y los algoritmos de uni√≥n / clasificaci√≥n no se consideran en esta etapa sino durante la optimizaci√≥n f√≠sica.</p><p id="71a508ad-0eca-47b9-ad97-6ec9e668e809" class="">Empujar selecciones y proyecciones en el √°rbol sint√°ctico es una heur√≠stica que normalmente conduce al √≥ptimo, pero no siempre.</p><p id="1944f87d-8aeb-4a82-b141-21388dc52002" class="">El optimizador comienza a crear todos los √°rboles sint√°cticos alternativos aplicando estas dos reglas:</p><ol id="d3ce266c-9064-4c3e-9dc3-3dcf9c7fd0b5" class="numbered-list" start="1"><li>Propiedad conmutativa de las combinaciones: es decir, cambiar el orden de las entradas de una combinaci√≥n determinada.</li></ol><ol id="48e6dcd1-6449-4a6e-b3d2-4b6ea7304e8f" class="numbered-list" start="2"><li>Propiedad asociativa de las combinaciones: es decir, cuando se unen m√°s de dos relaciones, conmutar las ramas de combinaci√≥n de dos en dos.</li></ol><p id="bd54882e-2f7a-45ca-96fe-ffe3adc2d72f" class="">Como ya sabe, las uniones son el operador relacional m√°s caro y, por lo tanto, el orden de uni√≥n puede tener un gran impacto en el rendimiento. Por ejemplo, considere las dos combinaciones siguientes: A B X C y el siguiente escenario:</p><ul id="f7539161-6462-4bfa-872d-ea2af78ef0fe" class="bulleted-list"><li>El 90% de las tuplas en B coinciden con al menos una tupla de A,</li></ul><ul id="a541e821-baa5-43e4-a4f9-dd1db6534dad" class="bulleted-list"><li>B y A se unen a trav√©s de una relaci√≥n FK-PK (de A a B) y estad√≠sticamente, sabemos que esta relaci√≥n relaciona cada tupla en B con 10 tuplas en A, en promedio,</li></ul><ul id="d86b3766-3a04-4ebb-bd6b-3a5f89ad46d3" class="bulleted-list"><li>Solo una tupla de B coincide con cualquier tupla de C (y sabemos que coincide exactamente con una),</li></ul><ul id="0c4d110f-6e3e-4a4d-8353-4f35fb6cc5ac" class="bulleted-list"><li>A tiene millones de tuplas, B tiene miles de ellas y C solo contiene algunos cientos.</li></ul><p id="70cbcdfa-0e44-4fca-8648-cebf6d3086cb" class="">
</p><p id="59011ad6-26e5-47ad-a743-198621eab8ac" class="">‚Üí Physical Optimization</p><p id="3e816fb5-c105-4c00-ba02-0c965b3dfeaa" class="">
</p><p id="0fafab5c-bddc-4865-b78e-40a5a109e759" class="">Distributed Query Optimization</p><p id="13b3c0a5-0996-427b-9b8c-51a09f0cf77a" class="">‚Üí Syntactic Optimization<div class="indented"><p id="e6c596cd-d99e-4434-b220-dcae44c016b0" class="">‚Üí Data Localization</p><p id="67303024-acdd-42b2-b2c1-108fda399c18" class="">‚Üí Reduction</p><p id="c3d1868f-3181-4805-9b78-c35c10787f4b" class="">‚Üí Generating Alternative Trees</p></div></p><p id="d288bd27-8096-4e05-8696-ad3cf4d3d6bd" class="">‚Üí Physical Optimization<div class="indented"><p id="de1fa99b-ec97-4132-a68e-b50813839c6a" class="">‚Üí Generalization of Execution Alternatives</p><p id="47de27d0-5531-429b-a64f-d553f5e72e95" class="">‚Üí Parallelism</p><p id="b1f572e2-adf3-400f-91b8-18890081cd38" class="">‚Üí Access Plan Evaluation</p></div></p><h1 id="5856e2e9-dab4-4e04-8ffb-e22579463dee" class="">Tema 5 - Concurrency and Recovery</h1><h2 id="eaae822f-111e-4391-a39e-ffce89add1b5" class="">Reminder: Challenges in Data Distribution</h2><ol id="63fdf8c5-aacf-4a2c-b19d-704afe488960" class="numbered-list" start="1"><li>Distributed DB design<ol id="059ec13e-05a5-46cc-a326-1508ae9ecdfa" class="numbered-list" start="1"><li>Node distribution</li></ol><ol id="341ba25a-adee-4085-a27f-a3205a917fc2" class="numbered-list" start="2"><li>Data fragments</li></ol><ol id="0f535d55-df34-4bfc-970f-9b460c0c7871" class="numbered-list" start="3"><li>Data allocation (replication)</li></ol></li></ol><ol id="a8bb3708-a05f-473a-82c5-a3dbef3991bd" class="numbered-list" start="2"><li>Distributed DB catalog<ol id="f62638fa-75d2-425a-89cd-a1652734367c" class="numbered-list" start="1"><li>Fragmentation trade-off: Where to place the DB catalog</li></ol><ol id="8d5a2576-63ea-4c07-93ad-ab9c10adbadd" class="numbered-list" start="2"><li>Global or local for each node</li></ol><ol id="39c9f491-251e-433b-9c26-0de4c9ebb9ad" class="numbered-list" start="3"><li>Centralized in a single node or distributed</li></ol><ol id="c6c668d2-7748-481c-9ebf-032ece1a3364" class="numbered-list" start="4"><li>Single-copy vs. Multi-copy</li></ol></li></ol><ol id="1d447403-8ce1-44da-b03b-a57e280ffb07" class="numbered-list" start="3"><li>Distributed query processing<ol id="3f4345c1-27ec-4f21-8730-ec860ca36bac" class="numbered-list" start="1"><li>Data distribution / replication</li></ol><ol id="5ab9486f-698e-4444-b705-9ac7d68aac56" class="numbered-list" start="2"><li>Communication overhead</li></ol></li></ol><ol id="f4d400b8-7a10-4bd5-a7c7-0469f4c55ca2" class="block-color-red numbered-list" start="4"><li>Distributed transaction management<ol id="3720f180-df3d-4354-b9e1-19960c22727b" class="numbered-list" start="1"><li>How to enforce the ACID properties<ol id="cfc010e7-0e71-4b8b-8eec-3fcd00b44fa9" class="numbered-list" start="1"><li>Replication trade-off: Queries vs. Data consistency between replicas (updates)</li></ol><ol id="51e9616f-6589-44dc-9356-af6a718c3291" class="numbered-list" start="2"><li>Distributed recovery system</li></ol><ol id="036cbe9a-241b-42cd-9b5e-638b99617af7" class="numbered-list" start="3"><li>Distributed concurrency control system</li></ol></li></ol></li></ol><p id="903f51ab-dcf2-48bc-a467-e4d587921787" class="">
</p><h2 id="0466f6a3-9086-4372-bf0a-f4a1b7ade986" class="">Basics on concurrency</h2><div id="ed7db468-80f2-4873-933e-740115fedcc0" class="column-list"><div id="19ff2181-d47d-424a-9d0f-4042f8d8409d" style="width:31.25%" class="column"><h3 id="2bb01579-1388-49a0-bcae-14ff31f7fb18" class="">ACID properties</h3><ul id="95ffd6ce-7fa2-4252-9330-88c7233d686e" class="bulleted-list"><li><em><strong>A tomicity</strong></em></li></ul><ul id="26019a81-7044-4a79-8537-9c8decdf79c7" class="bulleted-list"><li><em><strong>C onsistency</strong></em></li></ul><ul id="3eaea44d-a9c0-4ce6-8822-ad64fc1feafd" class="bulleted-list"><li><em><strong>I solation</strong></em></li></ul><ul id="1936abe5-0003-4f1e-b839-44bc42029f10" class="bulleted-list"><li><em><strong>D urability</strong></em></li></ul></div><div id="b283a207-6f98-41f1-ae3b-57e467b815e9" style="width:68.75%" class="column"><figure class="block-color-gray_background callout" style="white-space:pre-wrap;display:flex" id="f0d4975f-e3d8-47a2-8194-6c342be19333"><div style="font-size:1.5em"><span class="icon">üóíÔ∏è</span></div><div style="width:100%"><em>Enforcing these properties is not only responsibility of the DBMS, but also of DBA, users, and application programmers</em></div></figure></div></div><h3 id="676fb169-ff51-4bec-928f-8ef624cd6d06" class="">Trade-Off: Performance Vs. Consistency</h3><figure id="6eb14615-762d-4939-bae3-58016c62e7b6" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.05.59.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.05.59.png"/></a></figure><p id="7297cddb-f0a4-440d-a489-b5d2454b4263" class="">
</p><h3 id="202ab83f-8033-49fb-b9a4-29aabd75132b" class="">Challenge IV: Distributed Tx management</h3><ul id="e6cf32d0-2cd4-4234-bac2-9f8daeb2b630" class="bulleted-list"><li><strong>ACID properties are not always necessary</strong><ul id="388fbcc4-c5f3-44ec-83a7-46e5512eaf3c" class="bulleted-list"><li><strong>All can be relaxed</strong></li></ul></li></ul><ul id="39a29023-53c3-41ba-b74c-d164d975b195" class="bulleted-list"><li><strong>Relaxing Consistency and Durability</strong><ul id="c703e50d-6d8b-4b59-91a2-a165fe1cc080" class="bulleted-list"><li><strong>Entails data loss</strong></li></ul><ul id="b106a635-1a3b-440c-a7fb-4be150e1dfb1" class="bulleted-list"><li><strong>Save synchronization time</strong></li></ul></li></ul><ul id="644a3bc1-9f7a-4d84-881b-c61892bd1088" class="bulleted-list"><li><strong>Relaxing Atomicity and Isolation</strong><ul id="a60e35e6-f9f6-428a-add8-83654cdbc559" class="bulleted-list"><li><strong>Generate interferences</strong></li></ul><ul id="767755a0-fad3-4171-81e1-ae3bb78bca0e" class="bulleted-list"><li><strong>Save locks and contention</strong></li></ul></li></ul><h2 id="ddacc0e9-b6e6-4229-b1a5-d8e5d951c7df" class="">Time-stamping</h2><p id="29a0a1d5-2e82-4242-8111-9ba96a173321" class="">Time-Stamping Concurrency Control</p><ul id="03f5e8dc-3334-4667-b9d7-d93cb96686b8" class="bulleted-list"><li>Pessimistic technique<ul id="550994a8-b961-42d2-b789-631a30ef55d3" class="bulleted-list"><li>Not as much as locking</li></ul></li></ul><ul id="2c36b839-c9ec-447c-b06f-e83bae3010d8" class="bulleted-list"><li>Imposes a total order among transactions<ul id="2f7bfddf-38d6-4ac1-b6b0-eec49ab8e5e3" class="bulleted-list"><li>Guarantees a history equivalent to the serial one following the order of BoTs</li></ul></li></ul><ul id="566f6374-ae50-40b1-b11a-8eb947c2c444" class="bulleted-list"><li>When a potential conflict arrives, the order between transactions conflicting is
checked<ul id="b3fefa37-d831-42e7-a030-9d5e60d78007" class="bulleted-list"><li><strong>If the order is violated, the current transaction is canceled</strong></li></ul></li></ul><h3 id="373ba309-efcf-4f6c-ba0b-573fce994f59" class="">Structures for Time-Stamping</h3><ul id="5475434e-b05f-4bb4-bb23-c401bee8596f" class="bulleted-list"><li><strong>For each transaction</strong><ul id="34898f21-13f8-4fa9-9ed2-6357dbcccd29" class="bulleted-list"><li><strong>Timestamp of the BoT</strong></li></ul></li></ul><ul id="e218013c-c8e6-4a71-b307-5b3e24880104" class="bulleted-list"><li><strong>For each granule</strong><ul id="3b317d1e-b632-420e-b247-60251a868f17" class="bulleted-list"><li><strong>Timestamp of the youngest transaction reading it</strong><ul id="a23d4553-f909-4062-8e42-f05a679fa3f4" class="bulleted-list"><li>TSR(G)</li></ul></li></ul><ul id="4e424f07-bebb-4ba5-91bf-3f900b62a555" class="bulleted-list"><li><strong>Timestamp of the youngest transaction writing it</strong><ul id="caeae5bc-483d-46de-abab-2af5246cf098" class="bulleted-list"><li>TSW(G)</li></ul></li></ul></li></ul><h3 id="695c11d4-c8db-48b2-b9f9-10c9972a330e" class="">Time-Stamping Algorithms</h3><figure id="1ff1097e-0ae1-43cb-a42f-8150686e98ec" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.14.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.14.png"/></a></figure><p id="c8a54e7b-0a10-444a-8033-c9394b1024a3" class="">
</p><figure id="d4b0055d-35f5-4d3e-a446-ec762c5fbb2f" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.53.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.53.png"/></a></figure><figure id="7959aa00-f5da-4a61-8763-ba8ceadfb7c1" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.35.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.09.35.png"/></a></figure><figure id="f27fb188-d59f-49b7-889d-7447d7048248" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.10.29.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.10.29.png"/></a></figure><p id="a52a01cf-d231-41d0-8915-18c20fd2f9d2" class="">
</p><h3 id="f0cf3c2b-55a5-495b-b518-54c3817ee9c9" class="">Enforcing Recoverability</h3><figure id="c8159c6e-e8db-484b-aaf7-a66e3f3d74f3" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.11.06.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.11.06.png"/></a></figure><figure id="7590b861-05ad-43da-8684-c070e50ad96d" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.11.50.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.11.50.png"/></a></figure><h3 id="bdea2412-f254-4cf9-ace4-fd7a67ab3c8d" class="">Dynamic Time-Stamping</h3><figure id="11e5f731-bb30-4308-8a7b-d8205a40bd72" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.12.19.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.12.19.png"/></a></figure><figure id="c724c06a-5bf8-460c-81ef-5517119e92c1" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.12.37.png"><img style="width:528px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.12.37.png"/></a></figure><h2 id="59e75253-f0af-42a2-8137-2fac6c1b9d54" class="">Concurrency control in distributed databases</h2><h3 id="67f652cd-488e-45b6-86ad-1cb78aba3de0" class="">Concurrency Control in DDBs</h3><figure id="c5edaf30-9f35-4aa9-b277-0c1b460bbe1e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.14.34.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.14.34.png"/></a></figure><h3 id="595ef0ec-7a99-4021-b95c-693140b6e8e6" class="">Motivation: Global Serializability</h3><figure id="89f9967d-e4b5-4970-813a-70dcb9bcd03c" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.15.06.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.15.06.png"/></a></figure><h3 id="c577d692-d784-445a-995d-ed5043320f1f" class="">Problems in Distributed Transactions</h3><ul id="223f8b42-f964-420e-9415-96fed89966e1" class="bulleted-list"><li><strong>What needs to be solved</strong><ul id="ca0c1874-5593-4db9-afb8-83bad6aabb90" class="bulleted-list"><li><strong>Guarantee global  serializability</strong><ul id="b7db9a0e-2c3f-4643-bd06-272af9a5b015" class="bulleted-list"><li>Detect <strong>global </strong>deadlocks<ul id="da2861bc-b6a7-4e07-8866-70151cd26908" class="bulleted-list"><li>If using locking concurrency control</li></ul></li></ul></li></ul><ul id="1761c148-7079-4111-804c-098b8a7ed36c" class="bulleted-list"><li><strong>Guarantee  global atomicity and recoverability</strong></li></ul></li></ul><ul id="135861eb-601a-44ee-81b2-de7a84be4f25" class="bulleted-list"><li><strong>As shown, it cannot be solved locally</strong><ul id="a5593447-7df2-45ae-8199-32a1dbde8d70" class="bulleted-list"><li><strong>A global protocol must be set</strong></li></ul></li></ul><h3 id="9d659f99-345a-4696-8b75-184fb437fd15" class="">Distributed Time-Stamping</h3><figure id="85e91ce3-255c-4b4f-aead-b9c7e8b88ae8" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.17.09.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.17.09.png"/></a></figure><figure id="7dbb461d-5201-4c0a-a4ec-49d8c4d313f7" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.17.24.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.17.24.png"/></a></figure><h2 id="0106e960-cfbd-4dbc-80b0-fa9235414c7c" class="">Basics on recovery</h2><h3 id="892bfeb4-48e7-4acf-aa1b-128a3588ff9f" class="">Motivation</h3><ul id="45035c4d-a38f-41e3-a615-e08b5e5049b2" class="bulleted-list"><li>Failures must be masked to the users of transaction- based systems<ul id="9041e669-7a25-477d-bdb4-dd4af85ecf19" class="bulleted-list"><li>Transaction failure<ul id="b8b6e9c5-e9e8-4d6e-b78e-2499a982a7a6" class="bulleted-list"><li>Voluntary rollbacks</li></ul><ul id="35ef9e1f-5ea8-4d1f-a5f9-33def3d6e9d1" class="bulleted-list"><li>Aborted by the DBMS<ul id="cff19804-25b8-4f90-97cd-3cc8f3580dc9" class="bulleted-list"><li>Deadlocks, interferences...</li></ul></li></ul><ul id="90688780-b305-4c3a-8738-ad57dfbd22ec" class="bulleted-list"><li>System and media failures (crash recovery)<ul id="ea449c3a-d2f6-4cd1-afbf-af0be0918548" class="bulleted-list"><li>E.g., hard disks or network failures</li></ul></li></ul><ul id="cb3135d9-0a12-48b6-abd2-ad86b88de2b2" class="bulleted-list"><li>Disasters (archive recovery)</li></ul></li></ul></li></ul><ul id="65661bf3-82cd-4c35-adf1-049777fede90" class="bulleted-list"><li>Guarantee the atomicity (A) and durability (D) properties of ACID<ul id="c35fbe6b-2e9f-4768-adc8-b86ef62cb8fa" class="bulleted-list"><li>Redo recovery for committed transactions (D)</li></ul><ul id="104b2e12-a806-492a-ab58-1f4c31ee5bd9" class="bulleted-list"><li>Undo recovery for failed transactions (A)</li></ul></li></ul><ul id="c68a5df6-dccc-4fee-9048-5e9b1af9d987" class="bulleted-list"><li>Logging is the task of collecting redundant data needed for recovery<ul id="b5a8df59-4d5c-42df-9665-562a15d3e257" class="bulleted-list"><li>Protocol data recording transactions executed and which changes have been performed by them</li></ul><ul id="55975eeb-484b-420a-aa26-8242f06d603d" class="bulleted-list"><li>Checkpoints</li></ul></li></ul><h3 id="900aac89-7bbc-45b3-b1f7-dc5942f6ad14" class="">DBMS Components</h3><figure id="8eef540e-3849-4feb-bf4a-ce1fa2766742" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.22.15.png"><img style="width:576px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-10_at_16.22.15.png"/></a></figure><h3 id="1c72f49e-e097-451d-91c1-fcb38eb0ceac" class="">The Log: Rules</h3><ul id="240fa383-87e8-4339-8e5d-0a43ceb5e4a2" class="bulleted-list"><li><strong>To force sufficient log information reaches the stable log</strong><ul id="3026de04-ee78-4653-9572-e30adee6264a" class="bulleted-list"><li>Redo rule (<em>commit rule</em>): Redo log information must be written, at the latest, in phase 1 of commit</li></ul><ul id="cb80b103-ca0e-40a8-9980-116759e3065b" class="bulleted-list"><li>Undo rule (<em>write ahead logging</em>): Undo log information must be written to log before <em>flushing </em>the pages to disk</li></ul><ul id="50e3ad5a-0c09-462c-8235-3ededfee7244" class="bulleted-list"><li>Log information must not be discarded from the temporary log file, unless it is guaranteed that it is not longer necessary for recovery<ul id="c715efc0-78a4-475c-8c59-1d43e6e1bf3a" class="bulleted-list"><li>The corresponding page has reached the permanent DB</li></ul></li></ul></li></ul><h2 id="4c77e898-8ba4-4239-938c-74a057ab2b64" class="">Distributed recovery</h2><h3 id="6eaa439b-f1dd-41d7-8609-8cc85af5a29c" class="">Distributed Recovery</h3><ul id="b272418d-ded8-486e-abbe-c47b4a50f535" class="bulleted-list"><li>New types of failure must be considered<ul id="d1f91a25-a976-4be0-a344-92432d36dbe9" class="bulleted-list"><li>Communication link failure, network partitioning, delayed / lost messages, remote site failure</li></ul></li></ul><ul id="86d7d20d-bbd4-43db-8378-3191af083e72" class="bulleted-list"><li>Distributed commit protocols<ul id="08007191-6ed2-49ff-b540-fd0cc63b3ba7" class="bulleted-list"><li>Two-phase commit (2PC)</li></ul><ul id="dfed32fc-4414-4560-b321-b5f76a87b69a" class="bulleted-list"><li>Three-phase commit (3PC)</li></ul><ul id="184d2ae9-b6bc-4f2c-839d-c92317eb1784" class="bulleted-list"><li><strong>But they are typically not implemented in NOSQL since 2PC and 3PC compromise the availability of the system</strong></li></ul></li></ul><ul id="d96e19bd-bdea-417d-a406-5d55034c3e4f" class="bulleted-list"><li>Logs, however, are still used in distributed systems<ul id="80abd658-a75a-469f-ab08-60a4e3ae125d" class="bulleted-list"><li>Typically:<ul id="7f5a7c13-14de-49e3-a70d-e711f8d21c19" class="bulleted-list"><li>In the primary servers storing the catalog</li></ul><ul id="26fc531c-8358-4de6-aa7c-add941647263" class="bulleted-list"><li>In the secondary servers storing the primary replica when primary versioning is activated</li></ul></li></ul><ul id="5e8de6f9-1628-460f-a067-0feffb43c226" class="bulleted-list"><li>In such cases, it is a regular log acting locally (not globally):<ul id="75cbf5d9-cc82-47fb-b29c-769c8ffacbcf" class="bulleted-list"><li>Before- and after-images</li></ul><ul id="a7472a8f-e212-4bb5-86ee-e2e8608b051c" class="bulleted-list"><li>High-level actions</li></ul><ul id="2fb3f91f-05d1-4036-8a15-2bbf0aec208a" class="bulleted-list"><li>Actions of the distributed commit protocols are also logged</li></ul><ul id="9351e872-2ba8-4b0d-8b17-b50e6db43bb3" class="bulleted-list"><li>Force-written</li></ul></li></ul></li></ul><h2 id="3cd6c812-2350-4806-97e8-11efcf45c245" class="">CAP Theorem</h2><h3 id="44d94dc2-6095-45ee-874e-94a8b6da9ab4" class="">On the Need of a New Architecture</h3><ul id="fcbcf395-8119-461f-83c7-4f6de8328341" class="bulleted-list"><li><strong>Distribution is needed to overcome the 3 challenges presented</strong><ul id="82ad801d-a0d4-41b4-908d-e4c19165d639" class="bulleted-list"><li><strong>To provide scalability, efficiency (by means of parallelism), reliability / availability</strong><ul id="8d984812-054a-4dcd-b28c-efa102a39d89" class="bulleted-list"><li>But RDDBMS do not meet them (RDDBMS bottlenecks)</li></ul></li></ul></li></ul><ul id="74bedfbe-6e3f-44ee-973d-41d319353879" class="bulleted-list"><li><strong><strong>CAP theorem formulation: There is a trade-off in distributed systems; either availability or consistency can be always guaranteed (not both)</strong></strong><ul id="c98a90ec-3c0a-435c-8d60-cc9744c6a1b4" class="bulleted-list"><li><strong><strong>RDDBMS choose consistency</strong></strong></li></ul><ul id="da4ffd33-52b8-4cf2-89bb-95dfe5bd6024" class="bulleted-list"><li><strong><strong>NOSQL systems, most of the times, choose availability</strong></strong></li></ul></li></ul><ul id="705483b0-28b8-4545-a3a7-dbd5e27bd694" class="bulleted-list"><li>Eric Brewer. CAP Theorem: <em>any networked shared-data system can have at most two of three desirable properties</em>:<ul id="b7009be4-2426-4e58-99a8-4ed5e19530de" class="bulleted-list"><li>consistency (C) equivalent to having a single up-to-date copy of the data;</li></ul><ul id="b94d2fc3-875d-4fff-a6a7-a68c76f5072b" class="bulleted-list"><li>high availability (A) of that data (for updates); and</li></ul><ul id="26a79bf5-13ff-4003-9627-8f730fed795d" class="bulleted-list"><li>tolerance to network partitions (P).</li></ul></li></ul><ul id="388eff86-f19f-437a-a743-3af853f10d5f" class="bulleted-list"><li>With eager replication<figure id="8caef988-7d09-400c-b2e1-e6079589b344" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.55.34.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.55.34.png"/></a></figure></li></ul><p id="cb4d5ee0-4188-4621-8a77-61191c0c8ee5" class="">
</p><h2 id="114ea283-35ad-47e1-aaf9-e155ff0bdb88" class="">Strong Consistency</h2><figure id="05b09991-ad14-4b91-86f3-79d0897cdfd6" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.57.23.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.57.23.png"/></a></figure><ul id="ad3527cb-f8d6-4f82-8af4-878adc5ac75f" class="bulleted-list"><li>With lazy replication<figure id="c4df1db2-176a-49dc-bc50-f41758213d7d" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.58.33.png"><img style="width:1250px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.58.33.png"/></a></figure></li></ul><p id="47702123-ad63-4ea8-8751-33b1cdd46131" class="">
</p><figure id="94aa94f9-ea49-48bb-97ad-c11bf9f7badd" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.59.16.png"><img style="width:1250px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_16.59.16.png"/></a></figure><p id="d087d0c4-15cb-4a3d-8110-b66926141271" class="">
</p><h3 id="3ee7f8c7-99e0-495d-bd28-081437c2d7d0" class="">CAP Theorem Revisited</h3><ul id="174ef8ae-8cf7-483d-9651-b844f6e8c08d" class="bulleted-list"><li>The CAP theorem is not about choosing two out of the three <strong>forever and ever</strong><ul id="7a0a656d-20af-4c96-8dda-93f8b627edec" class="bulleted-list"><li>Distributed systems are not always partitioned</li></ul></li></ul><ul id="2932ef95-ea45-491e-9d77-8b4732bc6415" class="bulleted-list"><li>Without partitions: CA</li></ul><ul id="09a7d13f-7798-4c7a-822a-4a385009ddb4" class="bulleted-list"><li>Otherwise...<ul id="c6e31f1c-d10b-400d-bbcf-c8de5595ad43" class="bulleted-list"><li>Detect a partition<ul id="0e0436ae-486e-439d-93fb-5181c4292131" class="bulleted-list"><li>Normally by means of latency (time-bound connection)</li></ul></li></ul><ul id="9b5ce014-1e7f-473f-ae7e-b54d96c9b0ae" class="bulleted-list"><li>Enter an explicit partition mode limiting some operations choosing either:<ul id="3f51b64f-c959-485a-b260-e3e12aa55c66" class="bulleted-list"><li>CP (i.e., ACID by means of e.g., 2PCP or PAXOS) or,<ul id="a34fec1b-4f9c-439e-8f1d-3e9aab6e7adc" class="bulleted-list"><li>If a partition is detected, the operation is aborted</li></ul></li></ul><ul id="7cbbd097-a898-4aff-b940-f59d2b7bef3d" class="bulleted-list"><li>AP (i.e., BASE)<ul id="aca0a61b-bb8a-47ca-bf5d-7bc7be47c44d" class="bulleted-list"><li>The operation goes on and we will tackle this next</li></ul></li></ul></li></ul></li></ul><ul id="a2e35216-9654-43d3-9ec6-7320a6cabef8" class="bulleted-list"><li>If AP was chosen, enter a recovery process commonly known as <em>partition recovery </em>(e.g., compensate mistakes and get rid of inconsistencies introduced)<ul id="141c7e63-a10e-4910-947f-7539ebda9a47" class="bulleted-list"><li>Achieve consistency: Roll-back to consistent state and apply ops in a deterministic way (e.g., using time-stamps)<ul id="8e80eac7-b8e6-4ad7-bf7b-1d87f05abb17" class="bulleted-list"><li>Reduce complexity by only allowing certain operations (e.g., Google Docs)</li></ul><ul id="6bd04e82-6a69-43c5-a69a-9910eeca9240" class="bulleted-list"><li>Commutative operations (concatenate logs, sort and execute them)</li></ul></li></ul><ul id="d5910157-a6e8-4b28-8538-9e0a1e1b180d" class="bulleted-list"><li>Repair mistakes: Restore invariants violated<ul id="2c03ae5c-f046-4429-8279-eb3964b030f2" class="bulleted-list"><li>Last writer wins</li></ul></li></ul></li></ul><h3 id="1b372aa0-add8-4725-b467-3970e72c6082" class="">AP Theorem: Examples (~DIY!)</h3><ul id="62e95104-febe-412e-8fc2-2c15b236f11d" class="bulleted-list"><li>Yahoo‚Äôs PNUTS (AP): Assumes data is partitioned according to where the user is<ul id="b35a3103-9866-4a67-aaf6-e6384a9548a0" class="bulleted-list"><li>Remote copies are maintained asynchronously</li></ul><ul id="4fb2c66f-3a84-4f63-99a1-4f0f1f6c4f33" class="bulleted-list"><li>The primary copy is local (to decrease latency)</li></ul></li></ul><ul id="2f231513-23a6-4989-900e-ae1c799158e7" class="bulleted-list"><li>Facebook (AP): Unique primary copy<ul id="e5e18bb7-a8c7-4567-962a-021f48dd5885" class="bulleted-list"><li>Primary copy in always in one location (higher latency)</li></ul><ul id="9074d7b2-eed6-41f8-9cd4-a333f432f075" class="bulleted-list"><li>After 20‚Äô‚Äô the user‚Äôs traffic reverts to a closer copy (which hopefully, by that time, should reflect the change)</li></ul></li></ul><ul id="7fc3a79d-6f13-45f3-9faa-26295a09d1de" class="bulleted-list"><li>HTML5 (AP): Full Availability<ul id="13ab69de-1199-4bf9-88bb-5a94eb8d457c" class="bulleted-list"><li>On-client persistent storage (primary copy)</li></ul><ul id="3439d4f3-2698-40bf-9219-39ffcab926bb" class="bulleted-list"><li>Allows to go offline <strong>&gt; </strong>massive recovery process</li></ul></li></ul><ul id="baa69edd-2a8f-4e29-a60e-accf83c3cbe1" class="bulleted-list"><li>Google (CP): Considers primary partitions (data centers in USA, Germany, Sweden, etc.)<ul id="aa7546c2-8a79-4dee-9bc7-5d539b3c22a7" class="bulleted-list"><li>CA within partitions</li></ul><ul id="0c1042ed-09c1-4472-8510-65ce06723493" class="bulleted-list"><li>CP between partitions using PAXOS (e.g., Megastore)</li></ul></li></ul><h1 id="a1a12b57-0dbc-46cf-91e7-1d6a8ca9dcc3" class="">Tema 6 - Column-Oriented Databases</h1><h2 id="87e370b4-ccc1-472a-978d-c0702f768d41" class="">Column-Oriented Databases</h2><ul id="4675f30d-86d3-4e79-8d7e-a76e56aa769e" class="bulleted-list"><li><strong>Main features</strong><ul id="38905300-559f-45c4-84c7-5f764f1719d8" class="bulleted-list"><li>Use, to the extreme, of vertical partitioning</li></ul><ul id="cd21d658-b61d-445b-a023-bfb114eb830c" class="bulleted-list"><li>Do not allow variable record sizes and apply efficient compression techniques</li></ul><ul id="79d0329a-f61e-45d7-abf1-380f5bfa1202" class="bulleted-list"><li>Specific query processing techniques assuming the items above<ul id="dfbd32c6-85f4-45d9-9de1-28ed0c8a09f8" class="bulleted-list"><li>In-memory query processing</li></ul></li></ul></li></ul><ul id="03332657-dfd8-4672-bb08-c050c67abe7c" class="bulleted-list"><li><strong>Recall the main limitations of vertical partitioning. On top of that, these DBs use compression as first-class citizen</strong><ul id="082c0d55-b2e1-4ffe-bb1d-b6daca93bfca" class="bulleted-list"><li>As such, these DBs are meant for <strong>read-only databases</strong></li></ul><ul id="dda60c4d-4d8f-4967-a3b5-4c117ae9c1ee" class="bulleted-list"><li>Extremely inefficient in front of write-intensive database workloads</li></ul></li></ul><ul id="01cf5eed-9fbb-48ce-ac85-0fa8092176db" class="bulleted-list"><li>Column-oriented DBs are inherently aligned with decisional systems<ul id="ebbccd0a-b14f-400e-918e-5c800376a37f" class="bulleted-list"><li>A <strong>must </strong>for Data Warehousing! ~ Terabytes</li></ul><ul id="1840a872-a563-4b6d-9105-ffb5d427beba" class="bulleted-list"><li>A <strong>must </strong>for read-only Big Data systems ~ Petabytes</li></ul></li></ul><ul id="073f3af9-49c5-4d20-aa20-8fdf684ff6e5" class="bulleted-list"><li>Two main types:<ul id="0f8bfe49-364c-4345-b7ca-988a08898ad4" class="bulleted-list"><li>Relational Column-Oriented DBs (aka NewSQL)<ul id="2da84a28-1191-4e9e-bcaa-4427faaf9fd3" class="bulleted-list"><li>First system: C-Store</li></ul><ul id="3191b4a8-1c8c-4e51-8472-1c56f645af0d" class="bulleted-list"><li>Industrial examples: MonetDB, HP Vertica, SAP Hana, Oracle in-memory column store, MariaDB ColumnStore PostgreSQL Zedstore... in general, ANY relational database provides, in one way or another, a columnar engine</li></ul></li></ul><ul id="782ebf73-f7ec-4bd3-b6be-53cd3f2fdf4b" class="bulleted-list"><li>Column-Oriented NOSQL databases<ul id="573974e6-d00e-4a84-991d-2293c5e92ffd" class="bulleted-list"><li>Apache Druid (first OLAP-like NOSQL engine) - first NOSQL</li></ul><ul id="70e446ed-209c-4b56-833c-10286e2e33a2" class="bulleted-list"><li>Hadoop Ecosystem</li></ul><ul id="f3cc4f70-9c15-49d8-bce9-d2e938a9e46d" class="bulleted-list"><li>Apache Parquet and Apache Arrow file-formats for HDFS</li></ul><ul id="21e0e637-c035-4dfc-9b4b-109806976993" class="bulleted-list"><li>Apache Kudu</li></ul><ul id="7aa4507f-216f-4123-bd62-753453d9d8f0" class="bulleted-list"><li>Google BigQuery (former Dremel) and Amazon Redshift (former DynamoDB). In general, most Cloud Providers provide a column-oriented PaaS</li></ul></li></ul><p id="bc4f60e8-dfa8-4a64-9ccd-d85c92462974" class=""><em>NOTE</em>: Many classify Apache HBase as a column-oriented DB. <strong>IT IS NOT</strong>. HBase applies a hybrid partitioning strategy with horizontal partiotining as its primary partitioning strategy. Therefore, it cannot apply to its whole the optimizations for query processing.</p></li></ul><p id="b0374666-e23b-47e9-ba31-6708a0b28984" class="">
</p><ul id="87036604-b559-4cb7-b3fd-d29d6635c28a" class="bulleted-list"><li><strong>Column-Oriented Specific Features:</strong><ul id="6f943606-4ccc-41d8-92f1-b627c4f1baa1" class="bulleted-list"><li>Data model<ul id="c336245c-1383-4e13-bdfc-cdfa40065d74" class="bulleted-list"><li>Pure Vertical Partitioning</li></ul><ul id="f3ae3b2e-9a58-4d39-b21e-37e8274cfdc4" class="bulleted-list"><li>Tuples are identified by their position (no PK needed to be replicated in each fragment)<ul id="564598bb-120d-4458-83af-9318dbb88b4f" class="bulleted-list"><li>Multiple sorting of data (if needed, different in each replica)</li></ul></li></ul><ul id="18d042f1-016a-4419-b203-a77efc80fb67" class="bulleted-list"><li>Remove variable size records and work with fix-sized records (dictionaries or bitmaps needed)</li></ul><ul id="028cba45-b7d0-42b8-9b9b-86216b968594" class="bulleted-list"><li>Column-specific compression techniques</li></ul></li></ul><ul id="482580fe-7876-42d6-97f0-13023362f61a" class="bulleted-list"><li>Specific query processing<ul id="37e1f586-c893-4582-99ca-c51fc5e50b76" class="bulleted-list"><li>Late materialization: apply as many processing operators to the vertical fragments before joining them</li></ul><ul id="ba229e4c-4d0d-413a-9538-99cf0b72407d" class="bulleted-list"><li>Block iteration: exploit the fix-sized records to process data per blocks</li></ul><ul id="9e5febf7-01ac-40d2-8fb3-b02c06904273" class="bulleted-list"><li><em>Vectorized query processing: </em>when late materialization and block iteration are combined</li></ul><ul id="ddadfa2b-cbeb-4492-a5a1-c06365586839" class="bulleted-list"><li>Specific join algorithms (e.g., invisible join) exploiting the previous items</li></ul></li></ul><h2 id="624fce8a-0c3f-4186-b53c-c5bf64d8a9e7" class="">Data Model: Vertical Partitioning</h2><ul id="bdcc527a-fae9-4c8d-bb83-2aea71bf2f09" class="bulleted-list"><li>Most column-oriented DBs create a fragment per column<figure id="67a79893-f376-4f6f-b0da-69c1e46012d5" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.15.36.png"><img style="width:288px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.15.36.png"/></a></figure></li></ul><ul id="0de6c485-e5e9-47e4-8ca2-9cf45df85420" class="bulleted-list"><li>Most column-oriented DBs create a fragment PER column<figure id="e5b41476-009f-4f9e-a615-b1e7e977bbb2" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.16.57.png"><img style="width:336px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.16.57.png"/></a></figure></li></ul><ul id="98a05d25-fccc-4ba7-a11c-c4052224d461" class="bulleted-list"><li>Relevantly, some DBs allow to define groups of columns</li></ul></li></ul><p id="0daab03f-42c4-4622-aa3b-1bce29f5e644" class="">
</p><h3 id="e5ab9d0a-354f-4a24-9959-4ce406871285" class="">Data Model: Compression</h3><ul id="1c251415-1ff7-40e6-b230-0f622fd38813" class="bulleted-list"><li>Each column is not store as a regular file, but as a compressed file</li></ul><ul id="3cc98320-1602-4b68-a546-da716e747f80" class="bulleted-list"><li>In these DBs, the compression main objective is not reducing data space but reducing I/Os<ul id="5d90f77a-422a-4ec3-9f57-2e1d0d22372d" class="bulleted-list"><li>Yet, data in columnar format is more compressible than
data stored in rows<ul id="69a5a676-d13c-40d1-a8d1-f77bf5b9f7dd" class="bulleted-list"><li>High data value locality (less value entropy)</li></ul><ul id="740a5ab7-7849-4489-91da-3eed7b1792f6" class="bulleted-list"><li>Benefits from sorting</li></ul></li></ul></li></ul><ul id="28d9a46f-be90-4387-ac47-ceecc150be7b" class="bulleted-list"><li>Two main trends<ul id="8490041e-f86b-4840-a87b-6c51a5e8d6d8" class="bulleted-list"><li>Heavy weight compression algorithms (e.g., Lempel-Ziv)<ul id="0f060665-2ee2-4752-8cba-36ec73cc68f8" class="bulleted-list"><li>In general, not that useful but it might be if there is a (huge) gap between memory bandwidth and CPU performance</li></ul></li></ul><ul id="9219e1f3-c96e-4d7a-a0b3-dd5435bf22af" class="bulleted-list"><li>Lightweight compression (e.g., Run-Length Encoding) may allow the query optimizer work directly on compressed data<ul id="ca5da7a5-b0c0-4a3d-806c-44c613aa45e4" class="bulleted-list"><li>Improves performance by reducing CPU cost</li></ul><ul id="77fcee3b-674b-4d48-b5fe-19ce0cece544" class="bulleted-list"><li>Decompression is needed in front of bitwise AND / OR</li></ul></li></ul></li></ul><h3 id="a2b854ba-b0c1-40bf-b8ce-41c0cd3e3fb9" class="">Data Model: Lightweight Compression</h3><ul id="f77ae0fe-d7e5-46cd-903d-e2ae38d289be" class="bulleted-list"><li><strong>Mainly based on dictionaries or bitmaps</strong></li></ul><ul id="61e2ba1e-5dd0-4032-b63f-0dae114e2f4d" class="bulleted-list"><li><strong>Example of Run-length Encoding (with dictionary)</strong><figure id="4c355f8f-973e-4a60-910f-dd5294b37233" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.19.48.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.19.48.png"/></a></figure><figure id="ad798207-9bec-49b8-8520-3353e6f4839a" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.20.02.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.20.02.png"/></a></figure></li></ul><p id="f2b92e60-892f-4eef-9159-26bffe727c7c" class=""><mark class="highlight-red_background">Realise that the ERI and Dictionary positions are always fixed-size</mark></p><h3 id="484f6af6-44d7-4735-886a-3234738c15c8" class="">Data Model: Reconstructing Records</h3><ul id="4ecc0722-4749-4f78-8502-de2d1b02b539" class="bulleted-list"><li><strong>From each table, 3*N vectors are generated (N=#attributes)</strong></li></ul><ul id="a2ead6eb-e354-44e0-95ea-299ba809caa5" class="bulleted-list"><li><strong>To reconstruct the original tuple, the original vertical fragmentation used the PK</strong></li></ul><ul id="0bd7d0c0-bf5b-48b6-a6ca-9ac224875c31" class="bulleted-list"><li><strong>Alternatively, in column-oriented DBs each record has the same position in all the columns (vectors) created from that table</strong><ul id="d3eb0e4a-5b67-4eb2-8704-ef9723b3d706" class="bulleted-list"><li>Thus, column-oriented DBs do not join fragments to reconstruct the record</li></ul></li></ul><ul id="166a457b-bb7f-42e4-9d36-cad9d27f8db0" class="bulleted-list"><li><strong>Relevantly, a certain order might benefit a column and harm another</strong><ul id="fbebaf40-0539-4ef8-84d6-644c536facc4" class="bulleted-list"><li>If necessary, in the presence of replicas, each replica might use a different order (however, the order must be the same for all fragments of a table in a given replica)</li></ul></li></ul><h3 id="aad0c9ca-ea10-4e3c-a476-8b2fbef71ae4" class="">Data Model: Create Vertical Partitioning</h3><ul id="fb7ffb91-8bd1-4bcb-80d6-3e60d068a004" class="bulleted-list"><li>Creating a fragment per column, in general, is suboptimal. Thus, most advanced DBs allow the user to define partitions (each, potentially, as a set of columns)</li></ul><ul id="17550539-cad9-48a4-907e-b1d36857c463" class="bulleted-list"><li>In these cases, finding the optimal vertical partitioning is a problem that must take into account the query workload<ul id="564ef410-8747-4507-9e42-5ebe1f21bbab" class="bulleted-list"><li>Identify correlations in the query workload and group those columns with high <em>affinity </em>(i.e., frequently queried together)</li></ul><ul id="5b00b63d-cc63-4b8b-acda-7d1ee3314a8e" class="bulleted-list"><li>For m non-key attributes the search space is B(m), i.e., the <em>mth </em>Bell number, which counts the possible partitions of a set of m elements</li></ul><ul id="f68120d8-7df8-4947-88e1-34f3a04c3f50" class="bulleted-list"><li>For large numbers, <em>B(m) </em>‚âà <em>m^m</em></li></ul></li></ul><ul id="527269ea-4d95-4cf6-9bde-49ad049d98b3" class="bulleted-list"><li>Two main approaches to compute the optimal partitioning<ul id="18aecc36-c860-407e-b00e-0b100ecce125" class="bulleted-list"><li>Grouping<ul id="9fb02b8d-2cb6-4633-8379-f2bb78dc286b" class="bulleted-list"><li>Attribute affinity matrix</li></ul><ul id="ceb6657f-14bc-4102-bb66-33be81f76d5b" class="bulleted-list"><li>Clustering algorithms</li></ul><ul id="9422109a-a95d-4dfe-9021-5037adc2aa5d" class="bulleted-list"><li>...</li></ul></li></ul><ul id="86babc8d-d671-4957-b5eb-7584d20ac003" class="bulleted-list"><li>Splitting</li></ul></li></ul><ul id="7ae499d2-ce5b-4b98-ad27-b65c6287a101" class="bulleted-list"><li>[RECAP] Partitioning must guarantee<ul id="20731838-f910-482d-95dc-f8f52bc1f379" class="bulleted-list"><li>Completeness</li></ul><ul id="0b4212a7-4544-4bd8-a399-fbc47c2e8e0f" class="bulleted-list"><li><strong>Disjointness (for the sake of performance, it might be sacrificed)</strong></li></ul><ul id="6abdbe76-92d7-41ba-92a3-fb302a65d2f4" class="bulleted-list"><li>Reconstruction</li></ul></li></ul><h3 id="b99beaca-4b1a-49a6-965a-6c62c1319801" class="">Example</h3><ul id="ef6cff68-ca1c-4f77-a21f-65b512572d6e" class="bulleted-list"><li>Schema:</li></ul><pre id="ce627a59-794d-4a1c-850a-8fbb5613f97c" class="code"><code><em>Compres(llibreIdFK, date, preu, numUnitats)
Llibre(llibreId, autor, any, editorial, ISBN)</em></code></pre><p id="669fcf03-1193-47d5-a938-1d361ac6eaaa" class="">Queries:</p><pre id="e43d315c-1924-469a-ba23-26a8256d44cd" class="code"><code>SELECT llibreId, SUM(numUnitats) FROM compres c, llibre l
WHERE c.llibreId = l.llibreId AND editorial = ‚ÄòRBA‚Äô
GROUP BY llibreId</code></pre><pre id="1c4024b5-ca84-48f6-b909-4b0d71abb830" class="code"><code>SELECT editorial, AVG(preu) FROM compres c, llibres l
WHERE c.llibreId = l.llibreId
GROUP BY editorial</code></pre><pre id="b57df111-a62f-4258-926c-6a12ff24a343" class="code"><code>SELECT AVG(numUnitats) FROM compres c
WHERE date BETWEEN ‚Äô01/01/xxxx‚Äô AND ‚Äò31/12/XXXX‚Äô
GROUP BY llibreID</code></pre><pre id="061d4258-6ac9-4c79-9b46-1711f69cf6e2" class="code"><code>SELECT autor, any, COUNT(*) FROM llibre l
GROUP BY autor, any</code></pre><h3 id="a88ced4f-8223-4fcd-bbb6-2cb722547793" class="">Attribute Affinity Matrix</h3><ul id="3416344a-ae1f-413f-8c8d-4fc83cc138f6" class="bulleted-list"><li><strong>Algorithm:</strong><ol id="12c6146e-5fa9-4f62-b741-135e4658ce0e" class="numbered-list" start="1"><li><strong>For each relation, generate the attribute usage matrix</strong><figure id="61ad0cae-14a3-4fe8-8280-b2cb5698519e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.29.55.png"><img style="width:384px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.29.55.png"/></a></figure><p id="9ae6eaf8-6791-404a-8f5e-a0492e3ab62d" class="">Now, create the attribute usage matrix for Llibre</p></li></ol><ol id="49b1865a-bb29-42b6-9b65-cd6d0bb85e41" class="numbered-list" start="2"><li>For each relation, generate the attribute affinity matrix<figure id="ba52e0c3-221f-4884-a02f-875b9932d235" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.31.07.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.31.07.png"/></a></figure></li></ol><ol id="3d01736d-c304-4635-b2df-f67063db3aaf" class="numbered-list" start="3"><li>For each matrix, reorganize the attribute orders to form clusters where the attributes in each cluster show high affinity to one another<figure id="4ce389e9-51f5-47fc-a1a3-f2475da241bc" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.32.23.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.32.23.png"/></a></figure></li></ol></li></ul><p id="734ad2c8-6f33-4b25-b6c5-451b792219d8" class="">
</p><ul id="7a685385-1ce9-4bf9-b3a4-82612d550d9d" class="bulleted-list"><li><strong>Output:</strong><ul id="1f5a5f12-81c9-45d7-832b-a56b5648aff5" class="bulleted-list"><li>P1: LlibreID, numUnitats</li></ul><ul id="c829cde3-4933-4a24-b42d-2044ccbef68b" class="bulleted-list"><li>P2: Preu</li></ul><ul id="6d73b735-b0b1-461c-8849-0efb039774c2" class="bulleted-list"><li>P3: Date</li></ul></li></ul><ul id="e7db0a37-5986-4b5b-b74f-c3a5ff6e2488" class="bulleted-list"><li><strong>Assess the result. Compute the  effective read ratio for each query and partition</strong><ul id="e4627e77-ac7a-4f43-8593-20df4e4c29f4" class="bulleted-list"><li>For each query, for each partition it must read, compute the following ratio:<ul id="9698302c-02f0-495b-93ed-fd005c89677a" class="bulleted-list"><li>#Atr(Qj, Pi)/#Atr(Pi)</li></ul><ul id="29f0761c-cf2d-4d6c-b352-df62d43fd3fd" class="bulleted-list"><li>Where #Atr(Qj, Pi) means the number of attributes Qj must read from Pi and #Atr(Pi) is the total number of attributes in Pi</li></ul><ul id="3216a2fb-a54e-4c63-9245-eefbc4820afb" class="bulleted-list"><li>Example: RR(Q1, P1): 2/2 = 1</li></ul></li></ul></li></ul><h3 id="e50a71f5-3716-43f6-85fc-4593d7faab40" class="">Data Processing: Late Materialization</h3><figure id="9bcef120-3e39-4120-85ac-55ba3ebeb616" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.37.43.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.37.43.png"/></a></figure><h3 id="51be534c-c0cb-409b-89c2-154eea8a3ab2" class="">Data Processing: Block Iteration</h3><figure id="983ead08-944d-4c99-ba4e-785c576e9627" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.38.52.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_17.38.52.png"/></a></figure><h1 id="35b36335-acfd-4b06-aa83-21bf28790b9d" class="">Tema 7 - Key-Value Store</h1><h2 id="6f14441f-bd9f-49ef-aa4e-675c12987d91" class="">Hadoop, bigtable and mapreduce</h2><h3 id="4103ae7a-7e5f-427f-a157-f3c8a8461ab6" class="">Key-Values: A Piece of History</h3><ul id="a94c85b2-c48d-4568-9ebb-06ff2805c3d7" class="bulleted-list"><li><strong>Key-values were born as a desperate answer to the RDBMS limitations</strong></li></ul><ul id="6eb555cb-bfd5-4e13-a0ad-309009a0c6df" class="bulleted-list"><li><strong>It is widely assumed that Google is the father of Key-value stores</strong><ul id="d8f610dd-1472-4e72-966c-2573215093dc" class="bulleted-list"><li><strong>Hadoop File System</strong><ul id="78e4c6c3-c0ab-4117-8b75-6f3586844285" class="bulleted-list"><li><em>The Google File System </em>(2003)</li></ul></li></ul><ul id="cb1bf095-f73c-4689-b69b-d496c3d1e563" class="bulleted-list"><li><strong>MapReduce</strong><ul id="bca778df-ae1a-41cb-b7b4-5bbbc2a03ab8" class="bulleted-list"><li><em>Simplified Data Processing on Large Clusters </em>(2004)</li></ul></li></ul><ul id="50e4170d-956e-4e82-9d1f-3c843ce79799" class="bulleted-list"><li><strong>HBase</strong><ul id="143bbc81-a674-436c-ae2d-209737490846" class="bulleted-list"><li><em>A Distributed Storage System for Structured Data </em>(2006)</li></ul></li></ul></li></ul><h3 id="06d2eb34-2132-4ed0-8118-a71ddadad12b" class="">Google Ecosystem</h3><ul id="9c13b12a-7773-4ddf-a290-46dbe1bfc0ae" class="bulleted-list"><li><strong>High-performance is mainly achieved by means of parallelism</strong><ul id="6f4ef962-ed26-4cdd-8472-141e9bc85265" class="bulleted-list"><li><strong>Divide-and-conquer principle</strong></li></ul></li></ul><ul id="9efabf3f-d2a4-4e4f-becd-b00e1fd4da98" class="bulleted-list"><li><strong>MapReduce</strong><ul id="bdff1143-e21f-4d19-b657-9f048e098cf6" class="bulleted-list"><li><strong>It is a query language that provides parallelism in a transparent manner</strong></li></ul></li></ul><div id="d8b65c41-0170-4480-babf-d1cdb4227fd4" class="column-list"><div id="ec5f7e54-2e42-4079-949f-3c757900e61d" style="width:50%" class="column"><figure id="2b4dca14-196d-4071-b128-001311e73b1c" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_18.59.51.png"><img style="width:288px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_18.59.51.png"/></a></figure></div><div id="02cc4400-2225-4fc1-b3a5-aa1482880b51" style="width:50%" class="column"><figure id="04f240c1-482a-4f2f-9db8-3bfc46bcb64e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.00.20.png"><img style="width:1064px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.00.20.png"/></a></figure></div></div><h2 id="c15f493b-5a94-49d5-9681-ae2ed9014d01" class="">The file system: hadoop</h2><h3 id="320b3ad2-a820-40e9-9489-029674b9655d" class="">Hadoop File System (HDFS)</h3><ul id="968a158b-bc6c-4683-b2a0-30dccbfa2606" class="bulleted-list"><li><strong>Apache Hadoop (http://hadoop.apache.org)</strong><ul id="7a74be7e-8942-4f13-bb2f-639ac4fe130c" class="bulleted-list"><li>Based on Google File System (GFS)</li></ul></li></ul><ul id="45f7b4b0-a985-4694-a293-0beae70d1630" class="bulleted-list"><li><strong>Designed to meet the following requirements</strong><ul id="bedcbe19-30e2-4a10-b695-42585276804e" class="bulleted-list"><li>Handle very large collections of unstructured to semi-structured data</li></ul><ul id="6d9cac16-c5a8-44d3-8a60-4fdd8c91c1f7" class="bulleted-list"><li>Data collections are written once and read many times</li></ul><ul id="b448eb6f-c6bb-4ddd-893d-e1df46edea9c" class="bulleted-list"><li>The infrastructure underlying consists of thousands of connected machines with high failure probability</li></ul></li></ul><ul id="823c5e40-8f67-4beb-a8f4-50e5d42868dd" class="bulleted-list"><li><strong>Traditional network file systems do partially fulfil these requirements</strong><ul id="7bb77a96-9ce0-45eb-9878-9fefd3cca597" class="bulleted-list"><li>Operating Systems Vs. Database Management System<ul id="7ab6a932-59c4-4a2d-b85f-7403d0e5dd5a" class="bulleted-list"><li>Balancing <em>query </em>load (e.g., by means of <em>fragmentation and replication</em>) boosts availability and reliability<ul id="7b2d9c39-6eb2-47af-98c4-fb877ab9b832" class="bulleted-list"><li>HDFS: Equal-sized file chunks evenly distributed</li></ul></li></ul></li></ul></li></ul><h3 id="67824a30-0db3-42df-9543-ddc07ce8218b" class="">HDFS in a Nutshell</h3><ul id="50d8cf86-0ec2-465f-a7e0-e6c1c88951be" class="bulleted-list"><li><strong>A single master (coordinator)</strong><ul id="d25406cc-5441-493e-911a-7fefe0461132" class="bulleted-list"><li>Receives client connections</li></ul><ul id="6ea68243-c86b-4037-8582-ab1bf8a8a6c5" class="bulleted-list"><li>Maintains the description of the global file system namespace</li></ul><ul id="f4390525-2504-4868-96a6-1c2bce18b576" class="bulleted-list"><li>Keeps track of file chunks (default: 128Mb)</li></ul></li></ul><ul id="fe565122-f318-4b38-a683-b122559c8418" class="bulleted-list"><li><strong>Many servers</strong><ul id="ebde7bd6-1feb-4851-b3c5-82f57b9c4f0a" class="bulleted-list"><li>Receive file chunks and store them</li></ul></li></ul><ul id="491de231-d128-4600-acf6-b97523d82bc1" class="bulleted-list"><li><strong>A single master design forfeits availability and scalability</strong><ul id="c86c040d-8aa0-4ac8-800e-d8b7d1e8dba2" class="bulleted-list"><li>Availability and reliability: Recovery system<ul id="b982c04d-a6ec-4869-aa21-8a66f6ade331" class="bulleted-list"><li>Replication (a chunk always in 3 servers, by default)</li></ul><ul id="fb8bf165-86ab-4d41-95e3-1448ecc44495" class="bulleted-list"><li>Monitors the system with heartbeat messages to detect failures as soon as possible</li></ul><ul id="ee99b52e-1a67-4387-829f-f4c1cc33a97c" class="bulleted-list"><li>Specific recovery system to protect the master</li></ul></li></ul><ul id="643c1cf4-6b48-4bcc-91b5-c575fd6cfa09" class="bulleted-list"><li>Scalability: Client cache</li></ul></li></ul><figure id="5236d796-c7cc-4b36-b90f-c299d534cbfb" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.05.19.png"><img style="width:480px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.05.19.png"/></a></figure><h3 id="c336211b-1e0a-4ffe-af95-6a91de9c8e0b" class="">HDFS File Formats</h3><ul id="900c3ecc-da10-4957-a8da-72c22123cae2" class="bulleted-list"><li><strong>Parquet</strong><ul id="ca6987df-f1b2-40c9-8ef4-4b9dfc19f29d" class="bulleted-list"><li>Native columnar storage</li></ul><ul id="5c44aae2-5be9-483e-b45e-01902f2e89f6" class="bulleted-list"><li>Rich header metadata (including schema information)</li></ul><ul id="42c8c1c1-043d-45a3-b13b-0d2a32385fc4" class="bulleted-list"><li>Supports advanced block compression techniques</li></ul><ul id="2ec01bef-070d-41d5-8af6-c563e42a6bdd" class="bulleted-list"><li>Recognised by most popular processing engines, such as Spark<ul id="87d218b2-f7c5-4e08-82fd-5e8fca8324cb" class="bulleted-list"><li>It allows SQL-like querying (e.g., Spark SQL)</li></ul><ul id="490bd046-233d-4616-a56a-eca22729b4ef" class="bulleted-list"><li>Selections and Projections can be pushed down to disk</li></ul><ul id="683c51f3-4d1d-42a7-8314-2cbe8df4a19e" class="bulleted-list"><li>Statistics used to skip whole fragments</li></ul></li></ul></li></ul><ul id="2d051aee-af3c-48d0-ae2d-ca2eef271fe6" class="bulleted-list"><li><strong>Avro</strong><ul id="8a675eb6-9026-4a8a-a9c8-8996e1a60eb0" class="bulleted-list"><li>Native row-oriented storage</li></ul><ul id="01928460-cb9c-4680-907e-80c194e1cc20" class="bulleted-list"><li>Rich header metadata (including schema information)</li></ul><ul id="d0eb19d9-3ab3-496a-afd6-5dae8a6e37a4" class="bulleted-list"><li>Supports advanced block compression techniques</li></ul><ul id="823a870c-d2fe-469e-9b71-3e33ab4cfa3a" class="bulleted-list"><li>Recognised by most popular processing engines, such as Spark<ul id="129764e9-5e5d-42ae-8f13-07346d055781" class="bulleted-list"><li>It allows SQL-like querying (e.g., Spark SQL)</li></ul></li></ul></li></ul><ul id="2e5bca48-c1fb-49b8-bc77-6b010efe434b" class="bulleted-list"><li>Text / CSV / JSON formats<ul id="0ee7f12b-f9f1-4604-971e-321c3878fa34" class="bulleted-list"><li>Do not support block compression</li></ul><ul id="3784059f-7876-49c4-8e89-123c3024f5f1" class="bulleted-list"><li>Fix-sized splitting with no metadata</li></ul><ul id="fc256641-2b65-4c5b-a1b4-e646272c99ca" class="bulleted-list"><li>Not advisable for in-Hadoop processing</li></ul><ul id="ee791c4a-99a1-451d-91fb-65f15d7e71b0" class="bulleted-list"><li>Typically used to store <em>raw </em>data</li></ul></li></ul><ul id="eb2b7d92-0316-4466-90c8-4c8fdebfa1a8" class="bulleted-list"><li>... and many others: Arrow, ORC Files, Sequence Files, etc.</li></ul><h2 id="f8a0e79f-591a-40c2-821e-4af0468f32a4" class="">The database: hbase</h2><h3 id="3368ba28-a742-497c-9b50-c7c67ca84479" class="">HBase</h3><ul id="28fb6193-01b6-4f07-a49d-b911f26a3edc" class="bulleted-list"><li>Apache HBase (http://hbase.apache.org)<ul id="e042eba3-fc26-41d9-a9d0-1828f331bbc0" class="bulleted-list"><li>Based on Google‚Äôs BigTable</li></ul></li></ul><ul id="c269f58c-f9e9-4c70-9279-ebad27b996c3" class="bulleted-list"><li>Designed to meet the following requirements<ul id="01e7b23a-ec3c-478f-ac5f-7050105cdb66" class="bulleted-list"><li>Access specific data out of petabytes</li></ul><ul id="8e2d70d5-2fa0-4c55-bab6-42f7634c4243" class="bulleted-list"><li>It must support key search, range search and high throughput for file scans</li></ul><ul id="168b8cf2-62cf-48c5-964c-b28a2325942d" class="bulleted-list"><li>It must support single row transactions</li></ul></li></ul><ul id="361b6482-0c28-4d99-86ac-8be4c2cf7e04" class="bulleted-list"><li><em>Do it yourself </em>database... own decisions regarding:<ul id="d42eb618-cffb-40e6-9b6b-4b71a36b1dda" class="bulleted-list"><li>Data structure</li></ul><ul id="b9ed4e2a-4016-4084-a0ba-154a9f972c00" class="bulleted-list"><li>Concurrency</li></ul><ul id="27967ae8-9d94-4057-8d79-8b72c5628b9f" class="bulleted-list"><li>Recovery</li></ul><ul id="74cd778e-a38e-4823-995c-47151481404d" class="bulleted-list"><li>CAP trade-off</li></ul><ul id="01621c94-1c67-4455-8dc8-e89d25c9dd8d" class="bulleted-list"><li>Etc.</li></ul></li></ul><ul id="c5160c8e-5884-48e2-b115-cdeeeb741bda" class="bulleted-list"><li>In short, it is a <strong>distributed index cluster </strong>on top of HDFS<ul id="4bfad13f-cf7c-4125-a756-ec254751e4a8" class="bulleted-list"><li>Distributed B+</li></ul><ul id="fd16b223-db62-4529-85e8-2f5bb3385fb4" class="bulleted-list"><li>Tuples are lexicographically sorted according to the key</li></ul></li></ul><h2 id="b418fabd-4b7c-48db-a9a7-f0e6a8cf26cc" class="">Schema Elements</h2><ul id="b46004e8-3112-4520-adb3-3d519d12f502" class="bulleted-list"><li>Stores tables (collections) and rows (instances)<ul id="481741b4-6ce8-4b52-a6ea-6b96f5022fc4" class="bulleted-list"><li>Data is indexed using row and column names (arbitrary strings)</li></ul></li></ul><ul id="4072c67b-a471-401c-881e-da1e7fd2f86b" class="bulleted-list"><li>Treats data as <strong>uninterpreted </strong>strings (without data types)</li></ul><ul id="1f2b8e68-6ab7-4fa7-9bb1-ff2b727d7744" class="bulleted-list"><li>Each cell of a BigTable can contain multiple versions of the same data<ul id="0ec596f7-616b-4547-b90b-a35e707a6b15" class="bulleted-list"><li>Stores different versions of the same values in the rows</li></ul><ul id="b1500b58-d9b4-43c0-be04-d8e12e3c78f6" class="bulleted-list"><li>Each version is identified by a timestamp<ul id="a80c1012-b3b1-4e4c-8600-d6a90cf4a92f" class="bulleted-list"><li>Timestamps can be explicitly or automatically assigned</li></ul></li></ul></li></ul><p id="cda2a1c5-1b7d-4dce-93ac-185c7dacd162" class="">
</p><figure id="2d97848e-dcb5-46e5-86c6-c967c5ee7037" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.13.26.png"><img style="width:1192px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.13.26.png"/></a></figure><p id="29649a52-5875-4650-aa75-c9dddcdab07f" class="">
</p><h3 id="b576c0c9-f7a8-403f-8806-aa9be3b969f7" class="">Just Another Point of View</h3><figure id="f4035236-1180-4130-9627-50a91e94db9d" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.14.55.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.14.55.png"/></a></figure><figure id="f1599597-4f1f-465d-a49d-998664239a25" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.15.15.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.15.15.png"/></a></figure><figure id="2730ab65-0859-4f9a-afcd-da00c1e9ec54" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.15.30.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.15.30.png"/></a></figure><h3 id="a3c5095c-23bc-467a-ad8c-f61ad5531186" class="">HBase Shell</h3><figure id="327276c2-26cb-4c26-b72c-944e455465a7" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.16.01.png"><img style="width:432px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.16.01.png"/></a></figure><h3 id="fe2380a4-cfa8-4f82-8011-0ba2704183fe" class="">Physical Implementation</h3><figure id="807ad62d-37fd-4bdd-ad5f-893d3899db51" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.16.44.png"><img style="width:1308px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.16.44.png"/></a></figure><ul id="c10c3c03-2038-4101-bc7b-e97ad34844fb" class="bulleted-list"><li>Each table is horizontally fragmented into <em>Regions (tablets in BigTable)</em><ul id="56d05a19-6e71-49c2-bdd2-6dda0e7c6337" class="bulleted-list"><li>Dynamic fragmentation<ul id="271ec1f0-d70a-4e5d-a57e-47109ff10849" class="bulleted-list"><li>By default into few hundreds of Mbs</li></ul></li></ul><ul id="517bc928-74e0-42ad-9963-997d1159e371" class="bulleted-list"><li>Distributed on a cluster of machines or cloud</li></ul><ul id="5b5dcbbf-00ef-4245-aa5c-f77d5b32745c" class="bulleted-list"><li>Uses the distributed B+ to decide in what region a tuple is stored</li></ul></li></ul><ul id="4c3d76d3-02b5-4052-bc15-653b4fe35e4d" class="bulleted-list"><li>At each Region rows are stored column-wise according to families (hybrid fragmentation)<ul id="a7a56285-1579-4676-b182-f97aa73f279d" class="bulleted-list"><li>In disk, as many files as families were defined</li></ul><ul id="f59aec60-2b56-4015-a73f-75a66510894d" class="bulleted-list"><li>Static fragmentation (determined by the famiÃÅlies; also determine data locality)</li></ul><ul id="3601f8ca-ad5d-432b-bb51-4cc48aaf94a8" class="bulleted-list"><li>Block compression can be enabled (i.e., column families are compressed together)</li></ul></li></ul><ul id="36df3afc-e4b3-4f0e-acff-9f55a71f20bd" class="bulleted-list"><li>Massive usage of in-memory storage<ul id="8be37780-369e-464e-a424-e4200b694441" class="bulleted-list"><li>Files in disk have an in-memory counterpart</li></ul><ul id="7c2b99bf-d55b-4a6d-890c-e6ae57b28c21" class="bulleted-list"><li>Changes happen in main memory and are not flushed to disk until a compactation happens<ul id="bc0a4393-1e4a-44c3-bef2-8375b3eb3bf5" class="bulleted-list"><li>A compactation merges the in-memory and disk files</li></ul></li></ul></li></ul><ul id="3a97cde1-9691-4822-99f3-2910b532d6aa" class="bulleted-list"><li>Metadata table (~ catalog)<ul id="2d265b46-134b-48ee-b095-0e7afb0ce0e1" class="bulleted-list"><li>It is the physical implementation of the catalog</li></ul><ul id="2b7eb0ce-0b0b-42c8-9f96-8ad0c94b2f37" class="bulleted-list"><li>Tuples are lexicographically sorted according to the key<ul id="fff52e3c-172f-420b-a38e-8ad6028f54e5" class="bulleted-list"><li>Each row (entry) consists of &lt;key, loc&gt;<ul id="c1dfd578-a2c2-48b6-8ebd-a230c5a16f54" class="bulleted-list"><li>Key: it is the last key value in <em>that </em>Region</li></ul><ul id="67cb8cd3-6c6b-4cc5-8969-a6f67a640475" class="bulleted-list"><li>Loc: it is the physical address of a Region</li></ul></li></ul></li></ul><ul id="5eaf0098-0204-4082-8af1-a534ed8da76e" class="bulleted-list"><li>This is a <strong>distributed index cluster </strong>(LSM-tree) on top of HDFS</li></ul></li></ul><h3 id="e6752b9e-ebe2-4a4f-84a6-7de5f0e25dfd" class="">Functional Components</h3><div id="4eeae917-e961-4f3e-96b9-9c6aac1aa56c" class="column-list"><div id="50756b26-b6d7-42eb-acd6-9941cb932946" style="width:50%" class="column"><figure id="2527a66d-f025-4c60-ac52-ad3d92bb30df" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.20.56.png"><img style="width:336px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.20.56.png"/></a></figure></div><div id="c4bbdb30-edeb-4f3b-a410-74affb8cb374" style="width:50%" class="column"><figure id="ce3a109d-7ab8-4af7-a2f7-b4bce302fc34" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.21.11.png"><img style="width:1234px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.21.11.png"/></a></figure></div></div><h3 id="20a0b22a-4f12-4d2a-8232-b788942d1212" class="">HBase: A Distributed Index Cluster</h3><figure id="095951f9-46dd-4603-ba1d-ef45a69fdf0e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.22.09.png"><img style="width:1234px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.22.09.png"/></a></figure><h3 id="2d150046-9b23-433a-b762-d98cbb868d7a" class="">HBase Design Decisions</h3><ul id="2e20fb84-3c17-4211-9e70-3e3d756f02bb" class="bulleted-list"><li><strong>One master server</strong><ul id="a1503ab1-f575-4796-a04a-0ec87d53c8d1" class="bulleted-list"><li>Maintenance of the table schemas<ul id="353b2b1c-a492-49c7-9dd7-280078fa3c64" class="bulleted-list"><li>Root region</li></ul></li></ul><ul id="7b1ba2d9-6f47-4a13-9f18-4468f1e3bfa9" class="bulleted-list"><li>Monitoring of services (heartbeating)</li></ul><ul id="6f3723ad-9710-419e-8543-602c7829d1c7" class="bulleted-list"><li>Assignment of regions to servers</li></ul></li></ul><ul id="67512603-3f5d-4e41-b4df-eddee8bad98d" class="bulleted-list"><li><strong>Many region servers</strong><ul id="67f38800-6eb3-4596-b28c-e8137bb609ba" class="bulleted-list"><li>Each handling around 100-1000 regions (i.e., horizontal fragments)</li></ul><ul id="921624da-07c5-4d39-999d-db272c92303f" class="bulleted-list"><li>Apply concurrency and recovery techniques</li></ul><ul id="966942e9-dcc0-4aec-980f-85e59f03f300" class="bulleted-list"><li><mark class="highlight-red">Managing split of regions</mark><ul id="ac5f3d32-1ba2-4e9a-a4b7-3642bdb31dcf" class="bulleted-list"><li>A region server decides to split (e.g., &gt;128MB)</li></ul><ul id="dc923cbe-0735-4802-b0cf-3fb57eb736b5" class="bulleted-list"><li>Half of its regions are sent to another server</li></ul></li></ul><ul id="1a2dd86d-da72-4cf6-a190-428394cd7ed6" class="bulleted-list"><li><mark class="highlight-red">Managing merge of regions</mark></li></ul></li></ul><ul id="2c2874fe-4085-4d2a-9310-41e78883eb4c" class="bulleted-list"><li><strong>Client nodes</strong></li></ul><ul id="b6a313d8-c924-40b5-88b5-beaaa69ad191" class="bulleted-list"><li><strong>Split and merge affects the distributed tree, which must be updates</strong><ul id="82d921e1-f677-4f85-81d0-0b3e5cd9c67c" class="bulleted-list"><li><em><strong>Gossiping</strong></em></li></ul><ul id="612d389e-13d5-4680-bf10-42b4e93a9189" class="bulleted-list"><li><strong>Lazy updates: discrepancies may cause out-of-range errors, which triggers a stabilization (mistake compensation) protocol</strong></li></ul></li></ul><ul id="57f39224-aac4-43e9-8893-5add6690341b" class="bulleted-list"><li><strong>Mistake compensation</strong><ul id="baf33e5d-1dcd-4a46-b01e-6fae4fb0e14d" class="bulleted-list"><li><strong>The client keeps in cache the tree sent by the </strong>master and uses it to access data</li></ul><ul id="63a38877-293b-4225-9840-e8b723ea4031" class="bulleted-list"><li><strong>If an out-of-range error is triggered, it is forwarded to the parent</strong><ul id="f5fe772e-f572-4f4c-b610-9400fd598244" class="bulleted-list"><li>In the worst case, 6 network round trips</li></ul><figure id="ff323a88-7c2a-403f-944c-4a1803c7b02e" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.28.00.png"><img style="width:672px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_19.28.00.png"/></a></figure></li></ul></li></ul><h3 id="1b802772-b48b-4099-bb8a-7ab5a492c409" class="">HBase in a Nutshell</h3><ul id="1e7874d8-85ef-43b9-b687-04ad162f381f" class="bulleted-list"><li><strong>HBase was thought to provide a specific answer for a specific problem</strong><ul id="134bd6ba-38b1-412b-a267-79dfc4f2d3c7" class="bulleted-list"><li>Architecture: Distributed index cluster<ul id="883121d9-952d-45c8-bf40-a15f4b18a348" class="bulleted-list"><li>In-memory sorted map for new rows</li></ul><ul id="7dd65615-400d-4736-962a-51c8243f372a" class="bulleted-list"><li>Merge-sort for merging it with <em>old </em>data</li></ul></li></ul><ul id="b361e44b-a838-4c1d-ac2a-15330e434509" class="bulleted-list"><li>Data structure: Table / row / families<ul id="b0b3f927-bee9-4d54-976c-49180a54cf88" class="bulleted-list"><li>Hybrid fragmentation (first horizontal, then vertical)</li></ul><ul id="4a6cc5e3-5379-4de0-93c6-7bbbae6ce660" class="bulleted-list"><li>Thus, it cannot fully benefit from columnar processin</li></ul></li></ul><ul id="44602af4-3e0b-4c11-8d58-e1b8e19a5c7e" class="bulleted-list"><li>Concurrency: Timestamping MVCC (Multiversion)<ul id="6dbf0238-55a2-4224-9e31-1f2c78066070" class="bulleted-list"><li>Supports single-row transactions per file</li></ul></li></ul><ul id="f3162f59-6bc9-4883-8e76-81a9b1816a6f" class="bulleted-list"><li>Logging (RegionServers)<ul id="19408290-2aec-4f19-b2b3-6b69eaa77c26" class="bulleted-list"><li>WAL (write-ahead protocol)</li></ul><ul id="afe98aba-3f93-42c4-b4f9-a552f7516e5e" class="bulleted-list"><li>REDO login (No Force / No Steal)</li></ul></li></ul><ul id="9a9b584d-a858-4299-873a-3884798c9c3d" class="bulleted-list"><li>CAP Theorem: CP</li></ul></li></ul><h3 id="13e2e8d0-6f58-4400-8de1-41c820355ef4" class="">HBase Architecture</h3><figure id="958c256e-593c-46c4-8b61-beaf2e58f4c1" class="image"><a href="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_20.35.24.png"><img style="width:1304px" src="CBDE%20c43fc4012f23408f8b55ac3a53e796b5/Screenshot_2021-01-11_at_20.35.24.png"/></a></figure><ul id="93aa6a48-b8e8-47f0-a6c6-fdc32344b2e6" class="bulleted-list"><li>NOSQL Goals<ul id="043d6f61-98c9-4d1c-88fd-2fef60b45299" class="bulleted-list"><li><strong>Schemaless: No explicit schema </strong><mark class="highlight-teal"><strong>[column-family key-value]</strong></mark></li></ul><ul id="4ad2f914-1b09-4683-9132-cb279f643b28" class="bulleted-list"><li>Reliability / availability: Keep delivering service even if its software or hardware components fail <strong><mark class="highlight-teal">[recovery] / [distribution]</mark></strong></li></ul><ul id="11639c3c-0def-4028-af39-65c48906760e" class="bulleted-list"><li>Scalability: Continuously evolve to support a growing amount of tasks <mark class="highlight-teal">[distribution]</mark></li></ul><ul id="a3eecaf8-be0c-485d-bc97-73d1830cf4af" class="bulleted-list"><li>Efficiency: How well the system performs, usually measured in terms of response <em>time </em>(latency) and <em>throughput </em>(bandwith <strong><mark class="highlight-teal">[distribution: CP]</mark></strong></li></ul><p id="3a7b53fa-7831-4896-b92c-7bb248fb7077" class="">
</p></li></ul><p id="61a9b60b-2eff-4d11-ab68-1d476396c748" class="">
</p><p id="6bf04c50-c21b-4c5a-a89b-fc11778f80ca" class="">
</p><p id="47b38c81-ca20-4ae2-aea1-eb8155934bf7" class="">
</p><p id="015de1f0-5ca3-4189-acbd-4de1b1bffe61" class="">
</p><h1 id="55b0a9e5-32f7-4517-8095-37680b65fe99" class="">Tema 8 - MapReduce</h1><h1 id="6a7032ea-ae84-415c-8067-25eccf142b91" class="">Tema 9 - Document-Stores</h1><h1 id="93d3b341-60fb-40b0-96af-d42696af4f76" class="">Tema 10 - Graph Databases</h1><p id="79d0e137-b65e-4172-9828-6f455470a059" class="">
</p><p id="06bf0bef-eda3-49d9-af34-55a0924ce446" class="">Tablet / apunts</p><p id="f178adcc-9394-4384-86f5-9a9659bd9b32" class="">
</p></div></article></body></html>